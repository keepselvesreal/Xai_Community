# ê´€ë¦¬ì ê³„ì • ìƒì„± ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

XAI ì»¤ë®¤ë‹ˆí‹° ì‹œìŠ¤í…œì˜ ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

## ğŸ¯ ê´€ë¦¬ì ê¶Œí•œ

ê´€ë¦¬ì ê³„ì •ì€ ë‹¤ìŒê³¼ ê°™ì€ ê¶Œí•œì„ ê°€ì§‘ë‹ˆë‹¤:

- **ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§**: ì‹¤ì‹œê°„ API ì„±ëŠ¥ ë° ì—ëŸ¬ ì¶”ì 
- **ì§€ëŠ¥í˜• ì•Œë¦¼ ê´€ë¦¬**: ì•Œë¦¼ ê·œì¹™ ì„¤ì • ë° ê´€ë¦¬
- **ì‚¬ìš©ì ê´€ë¦¬**: ì‚¬ìš©ì ê³„ì • ê´€ë¦¬ (í–¥í›„ êµ¬í˜„ ì˜ˆì •)
- **ì‹œìŠ¤í…œ ì„¤ì •**: ì‹œìŠ¤í…œ ì „ë°˜ ì„¤ì • ê´€ë¦¬ (í–¥í›„ êµ¬í˜„ ì˜ˆì •)

## ğŸ”§ ë°©ë²• 1: ìë™ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© (ê¶Œì¥)

### 1-1. ì¸í„°ë™í‹°ë¸Œ ë°©ì‹

```bash
# ë°±ì—”ë“œ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd backend

# ê´€ë¦¬ì ê³„ì • ìƒì„± ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
python scripts/create_admin.py
```

**ì‹¤í–‰ ê³¼ì •:**
1. ê´€ë¦¬ì ì´ë©”ì¼ ì…ë ¥
2. ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ (8ì ì´ìƒ, ëŒ€ì†Œë¬¸ì+ìˆ«ì í¬í•¨)
3. ë¹„ë°€ë²ˆí˜¸ í™•ì¸
4. ì‚¬ìš©ì í•¸ë“¤ ì…ë ¥ (ì„ íƒì )
5. ì´ë¦„ ì…ë ¥ (ì„ íƒì )
6. í‘œì‹œ ì´ë¦„ ì…ë ¥ (ì„ íƒì )
7. ìƒì„± í™•ì¸

### 1-2. í™˜ê²½ë³€ìˆ˜ ë°©ì‹

```bash
# í™˜ê²½ë³€ìˆ˜ ì„¤ì •
export ADMIN_EMAIL="admin@example.com"
export ADMIN_PASSWORD="AdminPass123!"
export ADMIN_HANDLE="admin"
export ADMIN_NAME="ê´€ë¦¬ì"
export ADMIN_DISPLAY_NAME="ì‹œìŠ¤í…œ ê´€ë¦¬ì"

# ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
python scripts/create_admin.py
```

## ğŸ”§ ë°©ë²• 2: ê´€ë¦¬ì ê´€ë¦¬ ë„êµ¬ ì‚¬ìš©

### 2-1. ëª¨ë“  ê´€ë¦¬ì ëª©ë¡ ì¡°íšŒ

```bash
python scripts/manage_admin.py list
```

### 2-2. ìƒˆ ê´€ë¦¬ì ê³„ì • ìƒì„±

```bash
python scripts/manage_admin.py create
```

### 2-3. ê¸°ì¡´ ì‚¬ìš©ìë¥¼ ê´€ë¦¬ìë¡œ ìŠ¹ê²©

```bash
python scripts/manage_admin.py promote user@example.com
```

### 2-4. ê´€ë¦¬ì ê¶Œí•œ í•´ì œ

```bash
python scripts/manage_admin.py demote admin@example.com
```

### 2-5. ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •

```bash
python scripts/manage_admin.py reset admin@example.com
```

## ğŸ”§ ë°©ë²• 3: ìˆ˜ë™ ë°ì´í„°ë² ì´ìŠ¤ ìˆ˜ì •

### 3-1. MongoDB ì§ì ‘ ìˆ˜ì •

```javascript
// MongoDB ì¿¼ë¦¬ (mongosh ì‚¬ìš©)
use xai_community_db

// ê¸°ì¡´ ì‚¬ìš©ìë¥¼ ê´€ë¦¬ìë¡œ ìŠ¹ê²©
db.users.updateOne(
  { email: "user@example.com" },
  { 
    $set: { 
      is_admin: true,
      email_verified: true 
    } 
  }
)

// ìƒˆ ê´€ë¦¬ì ê³„ì • ìƒì„± (ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ í•„ìš”)
db.users.insertOne({
  email: "admin@example.com",
  user_handle: "admin",
  name: "ê´€ë¦¬ì",
  display_name: "ì‹œìŠ¤í…œ ê´€ë¦¬ì",
  password_hash: "$2b$12$...", // bcrypt í•´ì‹œ
  is_admin: true,
  email_verified: true,
  status: "active",
  created_at: new Date(),
  updated_at: new Date()
})
```

## ğŸ” ê´€ë¦¬ì ê³„ì • ì ‘ê·¼ ë°©ë²•

### 1. ì›¹ ì¸í„°í˜ì´ìŠ¤ ë¡œê·¸ì¸

```
1. í”„ë¡ íŠ¸ì—”ë“œ URL ì ‘ê·¼: http://localhost:3000
2. ë¡œê·¸ì¸ í˜ì´ì§€: /auth/login
3. ê´€ë¦¬ì ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ ì…ë ¥
4. ë¡œê·¸ì¸ í›„ ëŒ€ì‹œë³´ë“œ ì ‘ê·¼: /dashboard
5. ê´€ë¦¬ì ë„êµ¬ ì„¹ì…˜ì—ì„œ "ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ" í´ë¦­
6. ë˜ëŠ” ì§ì ‘ ì ‘ê·¼: /admin/monitoring
```

### 2. API í† í° íšë“

```bash
# ë¡œê·¸ì¸ API í˜¸ì¶œ
curl -X POST "http://localhost:8000/api/auth/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=admin@example.com&password=AdminPass123!"

# ì‘ë‹µì—ì„œ access_token ì¶”ì¶œ
{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
  "refresh_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
  "token_type": "bearer",
  "user": {
    "email": "admin@example.com",
    "is_admin": true,
    ...
  }
}
```

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### ë¹„ë°€ë²ˆí˜¸ ìš”êµ¬ì‚¬í•­
- **ìµœì†Œ 8ì ì´ìƒ**
- **ëŒ€ë¬¸ì í¬í•¨**
- **ì†Œë¬¸ì í¬í•¨**
- **ìˆ«ì í¬í•¨**
- **íŠ¹ìˆ˜ë¬¸ì ê¶Œì¥**

### ê¶Œì¥ ì‚¬í•­
- **ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ ì‚¬ìš©**
- **ì •ê¸°ì ì¸ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½**
- **2FA ì„¤ì •** (í–¥í›„ êµ¬í˜„ ì˜ˆì •)
- **ë¡œê·¸ì¸ ì´ë ¥ ëª¨ë‹ˆí„°ë§**

## ğŸš¨ ë¬¸ì œ í•´ê²°

### 1. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì˜¤ë¥˜

```bash
# Python ê²½ë¡œ í™•ì¸
python --version

# ì˜ì¡´ì„± ì„¤ì¹˜
cd backend
uv sync

# í™˜ê²½ë³€ìˆ˜ í™•ì¸
echo $MONGODB_URL
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜

```bash
# MongoDB ì—°ê²° í™•ì¸
mongosh $MONGODB_URL

# í™˜ê²½ë³€ìˆ˜ ì„¤ì • í™•ì¸
cat backend/.env
```

### 3. ê¶Œí•œ ë¬¸ì œ

```bash
# ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê¶Œí•œ í™•ì¸
ls -la backend/scripts/

# ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x backend/scripts/create_admin.py
chmod +x backend/scripts/manage_admin.py
```

## ğŸ“š ì¶”ê°€ ì •ë³´

### ê´€ë¦¬ì ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

```python
# User ëª¨ë¸ (ê´€ë¦¬ì ê´€ë ¨ í•„ë“œ)
class User(Document):
    email: EmailStr
    user_handle: str
    name: Optional[str]
    display_name: Optional[str]
    password_hash: str
    is_admin: bool = False          # ê´€ë¦¬ì ì—¬ë¶€
    email_verified: bool = False    # ì´ë©”ì¼ ì¸ì¦ ì—¬ë¶€
    status: UserStatus = "active"   # ê³„ì • ìƒíƒœ
    created_at: datetime
    updated_at: datetime
```

### ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ ë°©ë²•

```python
# ë°±ì—”ë“œ ì½”ë“œì—ì„œ ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
from nadle_backend.dependencies.auth import AdminUser

@router.get("/admin/monitoring")
async def get_monitoring_dashboard(
    admin_user: User = Depends(AdminUser)  # ê´€ë¦¬ì ê¶Œí•œ í•„ìš”
):
    # ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
    pass
```

```typescript
// í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
const isAdmin = user?.is_admin || user?.email === "admin@example.com";

if (!isAdmin) {
  return <div>ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤</div>;
}
```

## ğŸ¯ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ê´€ë¦¬ì ê³„ì • ìƒì„± ì™„ë£Œ
- [ ] ì›¹ ì¸í„°í˜ì´ìŠ¤ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
- [ ] ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ ì ‘ê·¼ í™•ì¸
- [ ] ì§€ëŠ¥í˜• ì•Œë¦¼ ì‹œìŠ¤í…œ ì ‘ê·¼ í™•ì¸
- [ ] ê´€ë¦¬ì ê¶Œí•œ ë™ì‘ í™•ì¸