# 테스트 코드 작성 안내

## 📋 문서 목차

1. [목적](#목적)
2. [점검 목록](#점검-목록)
   - 2.1 [Classic TDD 원칙 준수](#21-classic-tdd-원칙-준수)
   - 2.2 [기능 간 선후 관계와 의존성 고려](#22-기능-간-선후-관계와-의존성-고려)
   - 2.3 [구현 후 즉시 사용자 플로우 검증](#23-구현-후-즉시-사용자-플로우-검증)
   - 2.4 [테스트 함수 우선순위 분류](#24-테스트-함수-우선순위-분류)
   - 2.5 [테스트 함수 난이도 표시](#25-테스트-함수-난이도-표시)
   - 2.6 [통합 및 E2E 테스트 연계성 제시](#26-통합-및-e2e-테스트-연계성-제시)
   - 2.7 [테스트 전후 상태 명시](#27-테스트-전후-상태-명시)
   - 2.8 [병렬 실행 가능 여부 명시](#28-병렬-실행-가능-여부-명시)
   - 2.9 [API 계약 테스트 포함 (MVP 수준)](#29-api-계약-테스트-포함-mvp-수준)
3. [실제 각 테스트 모듈과 함수](#실제-각-테스트-모듈과-함수)
   - 3.1 [모듈 목차](#31-모듈-목차)
   - 3.2 [테스트 코드 구조 예시](#32-테스트-코드-구조-예시)

---

## 1. 목적

테스트 코드 제안 가이드라인을 준수하여 체계적이고 실용적인 테스트 코드 문서를 작성할 수 있도록 점검 목록과 구체적인 작성 방법을 제공합니다.

---

## 2. 점검 목록

**테스트 코드 작성 시 아래 가이드라인 준수 여부를 점검하세요:**

### 2.1 Classic TDD 원칙 준수

#### Mock 사용 정책 점검
- [ ] Mock 사용 시 구체적인 이유를 테스트 코드에 기재했는가?
- [ ] Mock 대상이 이미 구현 완료된 기능인가?
- [ ] Mock 사용 조건이 "호출 비용이 높은 경우"에 해당하는가?
- [ ] Mock 사용 대안을 검토하고 문서화했는가?
- [ ] Mock 없이 진행 시의 문제점(테스트 불안정성, 실행 시간)을 명시했는가?

#### TDD 사이클 점검
- [ ] Red → Green → Refactor 순서를 준수하고 있는가?
- [ ] 테스트가 먼저 작성되고 실패하는 것을 확인했는가?
- [ ] 최소한의 코드로 테스트를 통과시켰는가?
- [ ] 리팩터링 시 테스트가 계속 통과하는지 확인했는가?

---

### 2.2 구현 후 즉시 사용자 플로우 검증

#### 프런트엔드 통합 테스트 점검
- [ ] API 응답 형식이 프런트엔드 기대 구조와 일치하는가?
- [ ] 오류 상황 시 적절한 사용자 메시지가 표시되는가?
- [ ] 로딩 상태 및 진행률 표시가 정상 동작하는가?
- [ ] 성공/실패 시나리오별 UI 상태 변화가 올바른가?

#### 사용자 워크플로우 점검
- [ ] 실제 사용자 행동 패턴을 반영한 테스트 시나리오를 작성했는가?
- [ ] 로그인 → 데이터 입력 → 처리 요청 → 결과 확인 플로우를 검증했는가?
- [ ] 각 단계별 사용자 경험이 적절한가?
- [ ] 오류 발생 시 사용자 가이드가 적절한가?

#### 우선순위 재설정 점검
- [ ] 통합 테스트 결과를 바탕으로 우선순위를 조정했는가?
- [ ] 발견된 이슈에 대한 테스트를 추가했는가?
- [ ] 누락된 오류 처리 테스트를 식별했는가?
- [ ] API 계약 테스트를 업데이트했는가?

---

### 2.3 기능 간 선후 관계와 의존성 고려

#### 계층적 누적 테스트 설계 점검
- [ ] 기능 간 의존성을 파악하고 문서화했는가?
- [ ] 기반 기능(의존성 없음)을 먼저 테스트했는가?
- [ ] 상위 계층 기능이 하위 계층 기능에 올바르게 의존하는가?
- [ ] 각 계층의 구현 완료 시점에서 사용자 플로우 검증을 수행했는가?

#### 의존성 격리 점검
- [ ] 하위 계층 실패가 상위 계층에 미치는 영향을 최소화했는가?
- [ ] 각 계층의 테스트가 독립적으로 실행 가능한가?
- [ ] 의존성 주입이나 인터페이스를 통한 격리가 이루어졌는가?

---

### 2.4 테스트 함수 우선순위 분류

#### 우선순위 표시 점검
- [ ] 모든 테스트 함수에 우선순위(🟦 필수, 🟡 권장, 🟢 선택)를 표시했는가?
- [ ] 필수(MVP) 테스트가 시스템 안정성과 직결되는가?
- [ ] 권장(안정화) 테스트가 사용자 경험 개선에 기여하는가?
- [ ] 선택(최적화) 테스트가 고급 기능에 해당하는가?

#### 시나리오별 분류 점검
- [ ] 정상 시나리오(Happy Path) 테스트를 작성했는가?
- [ ] 실패 시나리오(Failure Cases) 테스트를 작성했는가?
- [ ] 예외 케이스(Edge Cases) 테스트를 작성했는가?
- [ ] 각 시나리오별로 적절한 우선순위가 부여되었는가?

---

### 2.5 테스트 함수 난이도 표시

#### 난이도 분류 점검
- [ ] 모든 테스트 함수에 난이도(🟢 초급, 🟡 중급, 🔴 고급)를 표시했는가?
- [ ] 초급 테스트는 단순 입출력, 기본 검증 수준인가?
- [ ] 중급 테스트는 상태 관리, 조건부 로직 수준인가?
- [ ] 고급 테스트는 복잡한 로직, 멀티스레드, 성능 최적화 수준인가?

#### 구현 복잡도 점검
- [ ] 예상 구현 시간을 고려하여 난이도를 설정했는가?
- [ ] Mock 사용 복잡도가 난이도에 반영되었는가?
- [ ] 외부 의존성의 수가 난이도에 반영되었는가?
- [ ] 테스트 환경 설정의 복잡도가 고려되었는가?

---

### 2.6 통합 및 E2E 테스트 연계성 제시

#### 연계성 문서화 점검
- [ ] 단위 테스트와 통합 테스트의 연결점을 명시했는가?
- [ ] 실제 통합 시나리오에서의 사용 사례를 기술했는가?
- [ ] 관련 통합 테스트와 E2E 테스트를 명시했는가?
- [ ] 단위 테스트에서 검증하는 내용이 상위 테스트에서도 확인되는지 언급했는가?

#### 테스트 간 일관성 점검
- [ ] 단위 테스트의 검증 항목이 통합 테스트와 일치하는가?
- [ ] API 응답 필드가 E2E 테스트에서도 활용되는가?
- [ ] 오류 처리 시나리오가 모든 테스트 레벨에서 일관성 있게 처리되는가?

---

### 2.7 테스트 전후 상태 명시

#### 사전 조건 점검
- [ ] 테스트 실행 전 필요한 데이터나 상태를 명시했는가?
- [ ] 테스트 환경 설정 요구사항을 문서화했는가?
- [ ] 의존성 서비스의 상태를 명시했는가?

#### 사후 조건 점검
- [ ] 테스트 실행 후 예상되는 상태 변화를 명시했는가?
- [ ] 부작용(side effect)이 있다면 문서화했는가?
- [ ] 정리(cleanup)가 필요한 리소스를 식별했는가?

---

### 2.8 병렬 실행 가능 여부 명시

#### 병렬 실행 점검
- [ ] 각 테스트의 병렬 실행 가능 여부를 명시했는가?
- [ ] 공유 리소스 사용으로 인한 충돌 가능성을 검토했는가?
- [ ] 순차 실행이 필요한 테스트를 식별했는가?
- [ ] 테스트 간 데이터 격리가 보장되는가?

#### 성능 고려사항 점검
- [ ] 병렬 실행 시 성능 향상을 기대할 수 있는가?
- [ ] 리소스 경합으로 인한 성능 저하 위험을 평가했는가?
- [ ] 테스트 실행 시간 최적화 방안을 고려했는가?

---

### 2.9 API 계약 테스트 포함 (MVP 수준)

#### MVP 계약 검증 점검
- [ ] 상태 코드 검증을 포함했는가?
- [ ] 응답 형식(JSON) 검증을 포함했는가?
- [ ] 필수 필드 존재 여부를 확인했는가?
- [ ] 데이터 타입 검증을 포함했는가?

#### 향후 확장성 점검
- [ ] 전체 응답 구조를 기록하고 있는가?
- [ ] 오류 응답 형식을 문서화했는가?
- [ ] 향후 본격적인 계약 테스트를 위한 기반을 마련했는가?
- [ ] API 버전 관리를 고려한 설계인가?

---

## 3. 테스트 모듈과 함수 작성

### 3.1 모듈 목차

**테스트 모듈 제시 시 다음 목차를 각 모듈 위에 작성합니다:**

#### 📝 모듈 목차: test_core_validator.py

**주요 컴포넌트들**
- `InputValidator`: 사용자 입력 데이터 검증
- `BusinessRuleValidator`: 비즈니스 규칙 적용 검증  
- `ConstraintValidator`: 시스템 제약 조건 검증

**구성 함수와 핵심 내용**
- `test_validate_input_format()`: 데이터 형식 검증 (타입, 길이, 패턴)
- `test_validate_business_rules()`: 비즈니스 로직 규칙 적용 (권한, 정책)
- `test_validate_constraints()`: 시스템 제약 검증 (용량, 한도, 중복)

### 3.2 테스트 코드 구조 예시

**실제 코드 작성 시 테스트 코드 제안 가이드라인을 준수하며, 구현 내용은 포함하지 않고 함수명과 입출력, 문서화만 제시합니다:**

```python
class TestCoreValidator:
    """🔵 기반 계층 - 독립적 핵심 검증 로직"""
    
    def test_validate_input_format(self):
        """
        입력 데이터 형식 검증
        
        테스트 전: 다양한 형식의 입력 데이터 (유효/무효)
        실행 작업: 데이터 형식 검증 함수 호출
        테스트 후: 유효 데이터는 통과, 무효 데이터는 명확한 오류 메시지
        
        🔗 통합 시나리오: API 요청 시 첫 번째 검증 단계
        우선순위: 🟦 필수 (MVP)
        난이도: 🟢 초급 (단순 형식 체크, 조건문)
        실행 그룹: ⚡ 병렬 (순수 함수)
        
        입력: dict (user_input_data)
        출력: tuple (is_valid: bool, error_message: str)
        """
        pass
    
    def test_validate_business_rules(self):
        """
        비즈니스 규칙 검증
        
        테스트 전: 형식은 올바르지만 비즈니스 규칙 위반 데이터
        실행 작업: 비즈니스 규칙 검증 함수 호출
        테스트 후: 규칙 위반 시 적절한 오류 코드와 메시지
        
        🔗 통합 시나리오: 권한 체크, 정책 적용 단계
        우선순위: 🟡 권장 (안정화)
        난이도: 🟡 중급 (복합 조건, 규칙 엔진)
        실행 그룹: ⚡ 병렬 (순수 함수)
        
        입력: dict (business_context), dict (user_data)
        출력: ValidationResult (status, violations, suggestions)
        """
        pass

class TestDataProcessor:
    """🟡 조합 계층 - 검증된 데이터 처리"""
    
    def test_process_valid_data(self):
        """
        검증된 데이터 핵심 처리
        
        테스트 전: 검증 통과한 유효 데이터, 초기 상태 DB
        실행 작업: 데이터 처리 파이프라인 실행
        테스트 후: 처리된 결과 데이터, DB 상태 변경
        
        🚨 Mock: ExternalAPIService (네트워크 의존성)
        🔗 통합 시나리오: 전체 데이터 처리 워크플로우 핵심
        우선순위: 🟦 필수 (MVP)
        난이도: 🟡 중급 (상태 관리, 외부 API 연동)
        실행 그룹: 🔄 순차 (상태 변경)
        
        입력: ValidatedData
        출력: ProcessedResult (data, metadata, status)
        """
        pass

class TestServiceAPI:
    """🔴 통합 계층 - 전체 시스템 통합"""
    
    def test_full_request_flow(self):
        """
        전체 요청 처리 플로우
        
        테스트 전: 클린 시스템 상태, 테스트 사용자 인증
        실행 작업: HTTP 요청 → 검증 → 처리 → 응답
        테스트 후: 성공 응답, 모든 하위 시스템 적절히 동작
        
        🚨 Mock: NotificationService, ExternalAPIService
        🔗 E2E 시나리오: 사용자 전체 워크플로우
        우선순위: 🟦 필수 (MVP)
        난이도: 🔴 고급 (다중 시스템 통합, 트랜잭션)
        실행 그룹: 🔄 순차 (DB, 파일시스템 사용)
        
        입력: HTTPRequest
        출력: HTTPResponse (status_code, body, headers)
        """
        pass
```

---

이 점검 목록을 통해 개발자가 체계적이고 실용적인 TDD 테스트 코드를 구상할 수 있도록 지원하는 완성도 높은 문서를 작성하세요.