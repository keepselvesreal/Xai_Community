<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastAPI ÏôÑÏ†Ñ UI ÏãúÏä§ÌÖú</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* ÏÇ¨Ïù¥ÎìúÎ∞î */
        .sidebar {
            width: 250px;
            background: white;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
        }
        
        .sidebar-title {
            font-size: 1.2em;
            font-weight: 600;
        }
        
        .sidebar-nav {
            flex: 1;
            padding: 20px 0;
        }
        
        .nav-section {
            margin-bottom: 30px;
        }
        
        .nav-section-title {
            padding: 0 20px 10px;
            font-size: 0.8em;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #374151;
            text-decoration: none;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .nav-item:hover {
            background: #f3f4f6;
        }
        
        .nav-item.active {
            background: #eff6ff;
            color: #2563eb;
            border-right: 3px solid #2563eb;
        }
        
        .nav-icon {
            margin-right: 12px;
            font-size: 1.1em;
        }
        
        /* Î©îÏù∏ ÏΩòÌÖêÏ∏† */
        .main-content {
            flex: 1;
            overflow-y: auto;
        }
        
        .content-header {
            background: white;
            padding: 20px 30px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: between;
            align-items: center;
        }
        
        .page-title {
            font-size: 1.8em;
            font-weight: 600;
            color: #1f2937;
        }
        
        .page-subtitle {
            color: #6b7280;
            margin-top: 5px;
        }
        
        .auth-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-left: auto;
        }
        
        .auth-user {
            padding: 8px 16px;
            background: #f0f9ff;
            color: #0369a1;
            border-radius: 6px;
            font-size: 0.9em;
        }
        
        .btn-logout {
            padding: 8px 16px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
        }
        
        .content-body {
            padding: 30px;
        }
        
        /* ÌéòÏù¥ÏßÄÎ≥Ñ Ïä§ÌÉÄÏùº */
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        /* ÎåÄÏãúÎ≥¥Îìú */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            border: 1px solid #e5e7eb;
        }
        
        .stat-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .stat-title {
            font-size: 0.9em;
            color: #6b7280;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: 700;
            color: #1f2937;
        }
        
        /* Ïù∏Ï¶ù Ìèº */
        .auth-container {
            max-width: 400px;
            margin: 0 auto;
        }
        
        .auth-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            border: 1px solid #e5e7eb;
        }
        
        .auth-title {
            text-align: center;
            font-size: 1.5em;
            font-weight: 600;
            margin-bottom: 20px;
            color: #1f2937;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-size: 0.9em;
            font-weight: 600;
            color: #374151;
            margin-bottom: 5px;
        }
        
        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 1em;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .btn-primary {
            width: 100%;
            padding: 12px;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .btn-primary:hover {
            background: #1d4ed8;
        }
        
        .btn-primary:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        
        .auth-switch {
            text-align: center;
            margin-top: 20px;
            color: #6b7280;
        }
        
        .auth-switch a {
            color: #2563eb;
            text-decoration: none;
        }
        
        /* Í≤åÏãúÍ∏Ä */
        .posts-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .btn-new-post {
            padding: 10px 20px;
            background: #059669;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .posts-filters {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #e5e7eb;
        }
        
        .filters-row {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .filter-label {
            font-size: 0.8em;
            font-weight: 600;
            color: #6b7280;
        }
        
        .filter-select {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.9em;
        }
        
        .posts-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .post-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .post-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .post-meta {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-size: 0.8em;
            color: #6b7280;
        }
        
        .post-type {
            background: #eff6ff;
            color: #1d4ed8;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .post-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 10px;
        }
        
        .post-stats {
            display: flex;
            gap: 15px;
            font-size: 0.9em;
            color: #6b7280;
        }
        
        /* Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏ */
        .post-detail {
            background: white;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            overflow: hidden;
        }
        
        .post-detail-header {
            padding: 25px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .post-detail-title {
            font-size: 1.8em;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 15px;
        }
        
        .post-detail-meta {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 0.9em;
            color: #6b7280;
            margin-bottom: 20px;
        }
        
        .post-reactions {
            display: flex;
            gap: 10px;
        }
        
        .reaction-btn {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .reaction-btn:hover {
            background: #f3f4f6;
        }
        
        .reaction-btn.active {
            background: #eff6ff;
            border-color: #2563eb;
            color: #2563eb;
        }
        
        .post-content {
            padding: 25px;
            line-height: 1.7;
            color: #374151;
        }
        
        /* ÎåìÍ∏Ä */
        .comments-section {
            background: white;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            margin-top: 20px;
        }
        
        .comments-header {
            padding: 20px 25px;
            border-bottom: 1px solid #e5e7eb;
            font-size: 1.2em;
            font-weight: 600;
        }
        
        .comment-form {
            padding: 20px 25px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .comment-textarea {
            width: 100%;
            min-height: 80px;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            resize: vertical;
            font-family: inherit;
        }
        
        .comment-actions {
            display: flex;
            justify-content: end;
            margin-top: 10px;
        }
        
        .btn-comment {
            padding: 8px 16px;
            background: #059669;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .comments-list {
            padding: 20px 25px;
        }
        
        .no-comments {
            text-align: center;
            color: #6b7280;
            font-style: italic;
            padding: 40px 20px;
        }
        
        .comment-item {
            padding: 15px 0;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .comment-item:last-child {
            border-bottom: none;
        }
        
        .comment-author {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 5px;
        }
        
        .comment-content {
            color: #374151;
            margin-bottom: 10px;
        }
        
        .comment-meta {
            display: flex;
            gap: 15px;
            font-size: 0.8em;
            color: #6b7280;
        }
        
        /* ÎãµÍ∏Ä Ìèº Ïä§ÌÉÄÏùº */
        .reply-form {
            margin-top: 15px;
            padding: 15px;
            background: #f9fafb;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .reply-textarea {
            width: 100%;
            min-height: 60px;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            resize: vertical;
            font-family: inherit;
            font-size: 0.9em;
        }
        
        .reply-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 10px;
        }
        
        .btn-reply-submit {
            padding: 6px 12px;
            background: #059669;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
        }
        
        .btn-reply-submit:hover {
            background: #047857;
        }
        
        .btn-reply-cancel {
            padding: 6px 12px;
            background: #6b7280;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }
        
        .btn-reply-cancel:hover {
            background: #4b5563;
        }
        
        /* ÎãµÍ∏Ä ÌëúÏãú Ïä§ÌÉÄÏùº */
        .replies-container {
            margin-top: 15px;
            margin-left: 20px;
            padding-left: 15px;
            border-left: 2px solid #e5e7eb;
        }
        
        .reply-item {
            padding: 10px 0;
            border-bottom: 1px solid #f9fafb;
        }
        
        .reply-item:last-child {
            border-bottom: none;
        }
        
        .reply-author {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 5px;
            font-size: 0.9em;
        }
        
        .reply-content {
            color: #374151;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        
        /* ÌååÏùº ÏóÖÎ°úÎìú ÏòÅÏó≠ Ïä§ÌÉÄÏùº */
        .file-upload-area {
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background: #f8fafc;
        }
        
        .file-upload-area:hover {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        
        .file-upload-area.dragover {
            border-color: #3b82f6;
            background: #dbeafe;
            transform: scale(1.02);
        }
        
        .file-upload-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .file-upload-icon {
            font-size: 2em;
            opacity: 0.6;
        }
        
        .file-upload-text p {
            margin: 0;
            font-size: 0.95em;
        }
        
        .file-upload-hint {
            color: #6b7280;
            font-size: 0.85em !important;
        }
        
        .uploaded-files {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
        }
        
        .file-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            background: #f8fafc;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
        }
        
        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .file-preview {
            width: 40px;
            height: 40px;
            border-radius: 4px;
            object-fit: cover;
            border: 1px solid #e5e7eb;
        }
        
        .file-details {
            display: flex;
            flex-direction: column;
        }
        
        .file-name {
            font-weight: 500;
            font-size: 0.9em;
        }
        
        .file-size {
            color: #6b7280;
            font-size: 0.8em;
        }
        
        .file-remove {
            background: #ef4444;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
        }
        
        .file-remove:hover {
            background: #dc2626;
        }
        
        /* Í≤åÏãúÍ∏Ä Ï≤®Î∂Ä ÌååÏùº ÌëúÏãú Ïä§ÌÉÄÏùº */
        .post-attachments {
            margin-top: 20px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .attachments-header {
            margin-bottom: 15px;
        }
        
        .attachments-header h4 {
            margin: 0;
            color: #374151;
            font-size: 1.1em;
            font-weight: 600;
        }
        
        .attachments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .attachment-item {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #e5e7eb;
            transition: transform 0.2s ease;
            cursor: pointer;
        }
        
        .attachment-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .attachment-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .attachment-info {
            padding: 10px;
        }
        
        .attachment-name {
            font-size: 0.9em;
            font-weight: 500;
            color: #374151;
            margin-bottom: 4px;
            word-break: break-word;
        }
        
        .attachment-size {
            font-size: 0.8em;
            color: #6b7280;
        }
        
        /* Ïù¥ÎØ∏ÏßÄ Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .image-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }
        
        .image-modal.active {
            display: flex;
        }
        
        .modal-image {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 8px;
        }
        
        .modal-close {
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 2em;
            color: white;
            cursor: pointer;
            background: none;
            border: none;
        }
        
        .modal-close:hover {
            opacity: 0.7;
        }

        .reply-meta {
            display: flex;
            gap: 12px;
            font-size: 0.75em;
            color: #6b7280;
        }
        
        /* Î™®Îã¨ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            visibility: hidden;
            opacity: 0;
            transition: all 0.3s;
        }
        
        .modal-overlay.active {
            visibility: visible;
            opacity: 1;
        }
        
        .modal {
            background: white;
            border-radius: 12px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 20px 25px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #6b7280;
        }
        
        .modal-body {
            padding: 25px;
        }
        
        /* ÏïåÎ¶º */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            z-index: 1001;
            transform: translateX(100%);
            transition: transform 0.3s;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: #059669;
        }
        
        .notification.error {
            background: #dc2626;
        }
        
        /* Í≤åÏãúÍ∏Ä Ïï°ÏÖò Î≤ÑÌäº Ïä§ÌÉÄÏùº */
        .post-actions {
            display: flex;
            align-items: center;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        /* ÏÇ≠Ï†ú ÌôïÏù∏ Îã§Ïù¥ÏñºÎ°úÍ∑∏ */
        .confirm-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .confirm-dialog.active {
            display: flex;
        }
        
        .confirm-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        .confirm-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 10px;
            color: #1f2937;
        }
        
        .confirm-message {
            color: #6b7280;
            margin-bottom: 25px;
            line-height: 1.5;
        }
        
        .confirm-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .btn-confirm {
            background: #dc2626;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .btn-cancel {
            background: #f3f4f6;
            color: #374151;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        
        /* Î°úÎî© */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-radius: 50%;
            border-top-color: #2563eb;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* API ÌÖåÏä§Ìä∏ Ïä§ÌÉÄÏùº */
        .api-test-section {
            background: white;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .api-section-title {
            background: #f8fafc;
            padding: 15px 20px;
            margin: 0;
            font-size: 1.1em;
            font-weight: 600;
            color: #1f2937;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .api-endpoint-item {
            border-bottom: 1px solid #f3f4f6;
        }
        
        .api-endpoint-item:last-child {
            border-bottom: none;
        }
        
        .endpoint-header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 20px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .endpoint-header:hover {
            background: #f9fafb;
        }
        
        .endpoint-toggle {
            margin-left: auto;
            transition: transform 0.2s;
            font-size: 0.8em;
        }
        
        .endpoint-toggle.expanded {
            transform: rotate(90deg);
        }
        
        .api-test-panel {
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
            overflow: hidden;
            max-height: 0;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .api-test-panel.expanded {
            max-height: none;
            opacity: 1;
            overflow: visible;
        }
        
        .test-panel-content {
            padding: 20px;
        }
        
        .test-form {
            display: grid;
            gap: 15px;
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 80px;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.9em;
            font-family: 'Monaco', 'Consolas', monospace;
        }
        
        .test-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .btn-test {
            background: #059669;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 0.85em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-test:hover {
            background: #047857;
        }
        
        .btn-test:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        
        .btn-clear {
            background: #f3f4f6;
            color: #374151;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 0.85em;
            cursor: pointer;
        }
        
        .api-response-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
            min-height: 250px;
        }
        
        .response-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
        }
        
        .response-tab {
            padding: 6px 12px;
            background: #e5e7eb;
            border: none;
            border-radius: 6px 6px 0 0;
            font-size: 0.8em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .response-tab.active {
            background: #3b82f6;
            color: white;
        }
        
        .response-content {
            background: #1f2937;
            color: #e5e7eb;
            padding: 15px;
            border-radius: 0 6px 6px 6px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.8em;
            min-height: 200px;
            max-height: 500px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .method-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.75em;
            font-weight: 600;
            min-width: 45px;
            text-align: center;
        }
        
        .method-get { background: #dbeafe; color: #1e40af; }
        .method-post { background: #dcfce7; color: #166534; }
        .method-put { background: #fef3c7; color: #92400e; }
        .method-delete { background: #fee2e2; color: #991b1b; }
        
        .endpoint-path {
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9em;
            color: #374151;
            flex: 1;
        }
        
        .endpoint-status {
            font-size: 1.2em;
        }
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -250px;
                top: 0;
                height: 100vh;
                z-index: 100;
                transition: left 0.3s;
            }
            
            .sidebar.open {
                left: 0;
            }
            
            .main-content {
                width: 100%;
            }
            
            .content-header {
                padding: 15px 20px;
            }
            
            .content-body {
                padding: 20px;
            }
            
            .api-test-panel.expanded {
                max-height: none;
                overflow: visible;
            }
            
            .response-content {
                font-size: 0.7em;
                max-height: 400px;
            }
            
            .test-panel-content {
                padding: 15px;
            }
            
            .endpoint-header {
                padding: 12px 15px;
            }
        }
        
        /* Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞ Ïä§ÌÉÄÏùº */
        .editor-toolbar {
            border: 1px solid #d1d5db;
            border-bottom: none;
            border-radius: 8px 8px 0 0;
            padding: 15px;
            background: #f9fafb;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .toolbar-group {
            display: flex;
            gap: 4px;
            align-items: center;
        }
        
        .toolbar-btn {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9em;
        }
        
        .toolbar-btn:hover {
            background: #f3f4f6;
            border-color: #9ca3af;
        }
        
        .toolbar-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .toolbar-select {
            padding: 6px 10px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            font-size: 0.9em;
            min-width: 80px;
        }
        
        .toolbar-color {
            width: 40px;
            height: 35px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            cursor: pointer;
            background: white;
        }
        
        .toolbar-divider {
            width: 1px;
            height: 30px;
            background: #d1d5db;
            margin: 0 8px;
        }
        
        .rich-text-editor {
            border: 1px solid #d1d5db;
            border-radius: 0 0 8px 8px;
            min-height: 400px;
            padding: 20px;
            background: white;
            outline: none;
            font-family: inherit;
            line-height: 1.6;
            overflow-y: auto;
        }
        
        .rich-text-editor:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .rich-text-editor blockquote {
            border-left: 4px solid #e5e7eb;
            margin: 16px 0;
            padding-left: 16px;
            color: #6b7280;
            font-style: italic;
        }
        
        .rich-text-editor ul, .rich-text-editor ol {
            margin: 16px 0;
            padding-left: 24px;
        }
        
        .rich-text-editor li {
            margin: 4px 0;
        }
        
        .rich-text-editor img {
            max-width: 100%;
            height: auto;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .rich-text-editor h1, .rich-text-editor h2, .rich-text-editor h3 {
            margin: 20px 0 10px 0;
            color: #1f2937;
        }
        
        .rich-text-editor h1 {
            font-size: 2em;
            font-weight: 700;
        }
        
        .rich-text-editor h2 {
            font-size: 1.5em;
            font-weight: 600;
        }
        
        .rich-text-editor h3 {
            font-size: 1.25em;
            font-weight: 600;
        }
        
        .rich-text-editor p {
            margin: 8px 0;
        }
        
        @media (max-width: 768px) {
            .editor-toolbar {
                padding: 10px;
                gap: 6px;
            }
            
            .toolbar-btn {
                padding: 6px 10px;
                font-size: 0.8em;
            }
            
            .toolbar-select {
                min-width: 60px;
                font-size: 0.8em;
            }
            
            .rich-text-editor {
                min-height: 300px;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">üöÄ FastAPI UI</div>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Î©îÏù∏</div>
                    <a class="nav-item active" onclick="showPage('dashboard', this)">
                        <span class="nav-icon">üìä</span>
                        ÎåÄÏãúÎ≥¥Îìú
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Ïù∏Ï¶ù</div>
                    <a class="nav-item" onclick="showPage('login', this)">
                        <span class="nav-icon">üîê</span>
                        Î°úÍ∑∏Ïù∏
                    </a>
                    <a class="nav-item" onclick="showPage('register', this)">
                        <span class="nav-icon">üìù</span>
                        ÌöåÏõêÍ∞ÄÏûÖ
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">ÏΩòÌÖêÏ∏†</div>
                    <a class="nav-item" onclick="showPage('posts', this)">
                        <span class="nav-icon">üìÑ</span>
                        Í≤åÏãúÍ∏Ä Î™©Î°ù
                    </a>
                    <a class="nav-item" onclick="showPage('post-detail', this)">
                        <span class="nav-icon">üìñ</span>
                        Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏
                    </a>
                    <a class="nav-item" onclick="showPage('post-create', this)">
                        <span class="nav-icon">‚úçÔ∏è</span>
                        Í≤åÏãúÍ∏Ä ÏûëÏÑ±
                    </a>
                    <a class="nav-item" onclick="showPage('post-editor', this)">
                        <span class="nav-icon">üñãÔ∏è</span>
                        ÏóêÎîîÌÑ∞Î°ú ÏûëÏÑ±
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">ÌååÏùº Í¥ÄÎ¶¨</div>
                    <a class="nav-item" onclick="showPage('file-upload', this)">
                        <span class="nav-icon">üìé</span>
                        ÌååÏùº ÏóÖÎ°úÎìú ÌÖåÏä§Ìä∏
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">ÏóêÎîîÌÑ∞ ÌÖåÏä§Ìä∏</div>
                    <a class="nav-item" onclick="showPage('editor-tiptap', this)">
                        <span class="nav-icon">‚úèÔ∏è</span>
                        Tiptap ÏóêÎîîÌÑ∞
                    </a>
                    <a class="nav-item" onclick="showPage('editor-novel', this)">
                        <span class="nav-icon">üìù</span>
                        Novel ÏóêÎîîÌÑ∞
                    </a>
                    <a class="nav-item" onclick="showPage('editor-quill', this)">
                        <span class="nav-icon">üñäÔ∏è</span>
                        ReactQuill ÏóêÎîîÌÑ∞
                    </a>
                </div>
            </nav>
        </aside>
        
        <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† -->
        <main class="main-content">
            <!-- Ìó§Îçî -->
            <header class="content-header">
                <div>
                    <h1 class="page-title" id="pageTitle">ÎåÄÏãúÎ≥¥Îìú</h1>
                    <p class="page-subtitle" id="pageSubtitle">API Í∞úÎ∞ú ÌòÑÌô© Î∞è ÌÖåÏä§Ìä∏</p>
                </div>
                
                <div class="auth-status">
                    <div class="auth-user" id="authUser" style="display: none;">
                        üë§ ÏÇ¨Ïö©Ïûê
                    </div>
                    <button class="btn-logout" onclick="logout()" style="display: none;">
                        Î°úÍ∑∏ÏïÑÏõÉ
                    </button>
                </div>
            </header>
            
            <!-- ÏΩòÌÖêÏ∏† ÏòÅÏó≠ -->
            <div class="content-body">
                <!-- ÎåÄÏãúÎ≥¥Îìú ÌéòÏù¥ÏßÄ -->
                <div class="page active" id="dashboard">
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-icon">‚úÖ</div>
                            <div class="stat-title">ÏôÑÎ£åÎêú API</div>
                            <div class="stat-value">14</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚è≥</div>
                            <div class="stat-title">ÏßÑÌñâÏ§ë API</div>
                            <div class="stat-value">3</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìä</div>
                            <div class="stat-title">Ï†ÑÏ≤¥ ÏßÑÌñâÎ•†</div>
                            <div class="stat-value">85%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üß™</div>
                            <div class="stat-title">ÌÖåÏä§Ìä∏ ÏºÄÏù¥Ïä§</div>
                            <div class="stat-value">42</div>
                        </div>
                    </div>
                    
                    <!-- API ÌÖåÏä§Ìä∏ ÏÑπÏÖò -->
                    <div style="margin-top: 30px;">
                        <h2 style="margin-bottom: 20px; font-size: 1.4em; color: #1f2937;">üß™ API ÌÖåÏä§Ìä∏</h2>
                        
                        <!-- Ïù∏Ï¶ù API -->
                        <div class="api-test-section">
                            <h3 class="api-section-title">üîê Ïù∏Ï¶ù API</h3>
                            
                            <div class="api-endpoint-item">
                                <div class="endpoint-header" onclick="toggleApiTest(this)">
                                    <span class="method-badge method-post">POST</span>
                                    <span class="endpoint-path">/auth/login</span>
                                    <span class="endpoint-status">‚úÖ</span>
                                    <span class="endpoint-toggle">‚ñ∂</span>
                                </div>
                                <div class="api-test-panel">
                                    <div class="test-panel-content">
                                        <div class="test-form">
                                            <div class="form-group">
                                                <label class="form-label">Ïù¥Î©îÏùº</label>
                                                <input type="email" class="form-input" placeholder="user@example.com" value="test@test.com">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">ÎπÑÎ∞ÄÎ≤àÌò∏</label>
                                                <input type="password" class="form-input" placeholder="password" value="password123">
                                            </div>
                                            <div class="test-buttons">
                                                <button class="btn-test" id="loginApiButton" data-method="POST" data-endpoint="/auth/login">
                                                    üöÄ API Ìò∏Ï∂ú
                                                </button>
                                                <button class="btn-clear" onclick="clearApiForm(this)">ÏßÄÏö∞Í∏∞</button>
                                            </div>
                                        </div>
                                        <div class="api-response-section" style="display:none;">
                                            <div class="response-tabs">
                                                <button class="response-tab active">ÏùëÎãµ</button>
                                                <button class="response-tab">Ìó§Îçî</button>
                                                <button class="response-tab">ÏöîÏ≤≠</button>
                                            </div>
                                            <div class="response-content">
                                                <pre>ÏùëÎãµ ÎåÄÍ∏∞Ï§ë...</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="api-endpoint-item">
                                <div class="endpoint-header" onclick="toggleApiTest(this)">
                                    <span class="method-badge method-post">POST</span>
                                    <span class="endpoint-path">/auth/register</span>
                                    <span class="endpoint-status">‚úÖ</span>
                                    <span class="endpoint-toggle">‚ñ∂</span>
                                </div>
                                <div class="api-test-panel">
                                    <div class="test-panel-content">
                                        <div class="test-form">
                                            <div class="form-group">
                                                <label class="form-label">Ïù¥Î©îÏùº</label>
                                                <input type="email" class="form-input" placeholder="user@example.com">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">ÏÇ¨Ïö©Ïûê Ìï∏Îì§</label>
                                                <input type="text" class="form-input" placeholder="user_handle">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">ÌëúÏãú Ïù¥Î¶Ñ (ÏÑ†ÌÉù)</label>
                                                <input type="text" class="form-input" placeholder="Display Name">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">ÎπÑÎ∞ÄÎ≤àÌò∏</label>
                                                <input type="password" class="form-input" placeholder="password">
                                            </div>
                                            <div class="test-buttons">
                                                <button class="btn-test" onclick="testApiCall(this, 'POST', '/auth/register')">
                                                    üöÄ API Ìò∏Ï∂ú
                                                </button>
                                                <button class="btn-clear" onclick="clearApiForm(this)">ÏßÄÏö∞Í∏∞</button>
                                            </div>
                                        </div>
                                        <div class="api-response-section" style="display:none;">
                                            <div class="response-tabs">
                                                <button class="response-tab active">ÏùëÎãµ</button>
                                                <button class="response-tab">Ìó§Îçî</button>
                                                <button class="response-tab">ÏöîÏ≤≠</button>
                                            </div>
                                            <div class="response-content">
                                                <pre>ÏùëÎãµ ÎåÄÍ∏∞Ï§ë...</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Í≤åÏãúÍ∏Ä API -->
                        <div class="api-test-section">
                            <h3 class="api-section-title">üìù Í≤åÏãúÍ∏Ä API</h3>
                            
                            <div class="api-endpoint-item">
                                <div class="endpoint-header" onclick="toggleApiTest(this)">
                                    <span class="method-badge method-get">GET</span>
                                    <span class="endpoint-path">/posts</span>
                                    <span class="endpoint-status">‚úÖ</span>
                                    <span class="endpoint-toggle">‚ñ∂</span>
                                </div>
                                <div class="api-test-panel">
                                    <div class="test-panel-content">
                                        <div class="test-form">
                                            <div class="form-group">
                                                <label class="form-label">ÌéòÏù¥ÏßÄ</label>
                                                <input type="number" class="form-input" placeholder="1" value="1">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Í∞úÏàò</label>
                                                <input type="number" class="form-input" placeholder="10" value="10">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">ÌÉÄÏûÖ (ÏÑ†ÌÉù)</label>
                                                <input type="text" class="form-input" placeholder="ÏûêÏú†Í≤åÏãúÌåê">
                                            </div>
                                            <div class="test-buttons">
                                                <button class="btn-test" onclick="testApiCall(this, 'GET', '/posts')">
                                                    üöÄ API Ìò∏Ï∂ú
                                                </button>
                                                <button class="btn-clear" onclick="clearApiForm(this)">ÏßÄÏö∞Í∏∞</button>
                                            </div>
                                        </div>
                                        <div class="api-response-section" style="display:none;">
                                            <div class="response-tabs">
                                                <button class="response-tab active">ÏùëÎãµ</button>
                                                <button class="response-tab">Ìó§Îçî</button>
                                                <button class="response-tab">ÏöîÏ≤≠</button>
                                            </div>
                                            <div class="response-content">
                                                <pre>ÏùëÎãµ ÎåÄÍ∏∞Ï§ë...</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="api-endpoint-item">
                                <div class="endpoint-header" onclick="toggleApiTest(this)">
                                    <span class="method-badge method-post">POST</span>
                                    <span class="endpoint-path">/posts</span>
                                    <span class="endpoint-status">‚úÖ</span>
                                    <span class="endpoint-toggle">‚ñ∂</span>
                                </div>
                                <div class="api-test-panel">
                                    <div class="test-panel-content">
                                        <div class="test-form">
                                            <div class="form-group">
                                                <label class="form-label">Ï†úÎ™©</label>
                                                <input type="text" class="form-input" placeholder="Í≤åÏãúÍ∏Ä Ï†úÎ™©">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">ÎÇ¥Ïö©</label>
                                                <textarea class="form-textarea" placeholder="Í≤åÏãúÍ∏Ä ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."></textarea>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">ÏÑúÎπÑÏä§</label>
                                                <select class="form-input">
                                                    <option value="community">community</option>
                                                    <option value="shopping">shopping</option>
                                                    <option value="apartment">apartment</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Authorization Header</label>
                                                <input type="text" class="form-input" placeholder="Bearer your_token_here">
                                            </div>
                                            <div class="test-buttons">
                                                <button class="btn-test" onclick="testApiCall(this, 'POST', '/posts')">
                                                    üöÄ API Ìò∏Ï∂ú
                                                </button>
                                                <button class="btn-clear" onclick="clearApiForm(this)">ÏßÄÏö∞Í∏∞</button>
                                            </div>
                                        </div>
                                        <div class="api-response-section" style="display:none;">
                                            <div class="response-tabs">
                                                <button class="response-tab active">ÏùëÎãµ</button>
                                                <button class="response-tab">Ìó§Îçî</button>
                                                <button class="response-tab">ÏöîÏ≤≠</button>
                                            </div>
                                            <div class="response-content">
                                                <pre>ÏùëÎãµ ÎåÄÍ∏∞Ï§ë...</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ÎåìÍ∏Ä API -->
                        <div class="api-test-section">
                            <h3 class="api-section-title">üí¨ ÎåìÍ∏Ä API</h3>
                            
                            <div class="api-endpoint-item">
                                <div class="endpoint-header" onclick="toggleApiTest(this)">
                                    <span class="method-badge method-get">GET</span>
                                    <span class="endpoint-path">/posts/{slug}/comments</span>
                                    <span class="endpoint-status">‚úÖ</span>
                                    <span class="endpoint-toggle">‚ñ∂</span>
                                </div>
                                <div class="api-test-panel">
                                    <div class="test-panel-content">
                                        <div class="test-form">
                                            <div class="form-group">
                                                <label class="form-label">Í≤åÏãúÍ∏Ä Slug</label>
                                                <input type="text" class="form-input" placeholder="post-slug-here">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">ÌéòÏù¥ÏßÄ</label>
                                                <input type="number" class="form-input" placeholder="1" value="1">
                                            </div>
                                            <div class="test-buttons">
                                                <button class="btn-test" onclick="testApiCall(this, 'GET', '/posts/{slug}/comments')">
                                                    üöÄ API Ìò∏Ï∂ú
                                                </button>
                                                <button class="btn-clear" onclick="clearApiForm(this)">ÏßÄÏö∞Í∏∞</button>
                                            </div>
                                        </div>
                                        <div class="api-response-section" style="display:none;">
                                            <div class="response-tabs">
                                                <button class="response-tab active">ÏùëÎãµ</button>
                                                <button class="response-tab">Ìó§Îçî</button>
                                                <button class="response-tab">ÏöîÏ≤≠</button>
                                            </div>
                                            <div class="response-content">
                                                <pre>ÏùëÎãµ ÎåÄÍ∏∞Ï§ë...</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄ -->
                <div class="page" id="login">
                    <div class="auth-container">
                        <div class="auth-card">
                            <h2 class="auth-title">Î°úÍ∑∏Ïù∏</h2>
                            <form onsubmit="handleLogin(event)">
                                <div class="form-group">
                                    <label class="form-label">Ïù¥Î©îÏùº</label>
                                    <input type="email" class="form-input" name="email" required 
                                           placeholder="example@email.com" value="test@test.com">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÎπÑÎ∞ÄÎ≤àÌò∏</label>
                                    <input type="password" class="form-input" name="password" required 
                                           placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏" value="password123">
                                </div>
                                <button type="submit" class="btn-primary" id="loginBtn">
                                    Î°úÍ∑∏Ïù∏
                                </button>
                            </form>
                            <div class="auth-switch">
                                Í≥ÑÏ†ïÏù¥ ÏóÜÏúºÏã†Í∞ÄÏöî? <a href="#" onclick="showPage('register')">ÌöåÏõêÍ∞ÄÏûÖ</a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ÌöåÏõêÍ∞ÄÏûÖ ÌéòÏù¥ÏßÄ -->
                <div class="page" id="register">
                    <div class="auth-container">
                        <div class="auth-card">
                            <h2 class="auth-title">ÌöåÏõêÍ∞ÄÏûÖ</h2>
                            <form onsubmit="handleRegister(event)">
                                <div class="form-group">
                                    <label class="form-label">Ïù¥Î©îÏùº</label>
                                    <input type="email" class="form-input" name="email" required 
                                           placeholder="example@email.com">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÏÇ¨Ïö©Ïûê Ìï∏Îì§</label>
                                    <input type="text" class="form-input" name="user_handle" required 
                                           placeholder="user_handle">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÌëúÏãú Ïù¥Î¶Ñ</label>
                                    <input type="text" class="form-input" name="display_name" 
                                           placeholder="ÌëúÏãú Ïù¥Î¶Ñ (ÏÑ†ÌÉùÏÇ¨Ìï≠)">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÎπÑÎ∞ÄÎ≤àÌò∏</label>
                                    <input type="password" class="form-input" name="password" required 
                                           placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏</label>
                                    <input type="password" class="form-input" name="confirm_password" required 
                                           placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏">
                                </div>
                                <button type="submit" class="btn-primary" id="registerBtn">
                                    ÌöåÏõêÍ∞ÄÏûÖ
                                </button>
                            </form>
                            <div class="auth-switch">
                                Ïù¥ÎØ∏ Í≥ÑÏ†ïÏù¥ ÏûàÏúºÏã†Í∞ÄÏöî? <a href="#" onclick="showPage('login')">Î°úÍ∑∏Ïù∏</a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Í≤åÏãúÍ∏Ä Î™©Î°ù ÌéòÏù¥ÏßÄ -->
                <div class="page" id="posts">
                    <div class="posts-header">
                        <h2>Í≤åÏãúÍ∏Ä Î™©Î°ù</h2>
                        <button class="btn-new-post" onclick="showPage('post-create')">
                            ‚úçÔ∏è ÏÉà Í≤åÏãúÍ∏Ä
                        </button>
                    </div>
                    
                    <div class="posts-filters">
                        <div class="filters-row">
                            <div class="filter-group">
                                <label class="filter-label">ÏÑúÎπÑÏä§</label>
                                <select class="filter-select" id="serviceFilter" onchange="updateTypeFilter()">
                                    <option value="">Ï†ÑÏ≤¥</option>
                                    <option value="apartment" selected>ÏïÑÌååÌä∏</option>
                                    <option value="shopping">ÏáºÌïë</option>
                                    <option value="community">Ïª§ÎÆ§ÎãàÌã∞</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">ÌÉÄÏûÖ</label>
                                <select class="filter-select" id="typeFilter" onchange="filterPosts()">
                                    <option value="">Ï†ÑÏ≤¥</option>
                                    <option value="ÏûÖÏ£º Ï†ïÎ≥¥">ÏûÖÏ£º Ï†ïÎ≥¥</option>
                                    <option value="ÏÉùÌôú Ï†ïÎ≥¥">ÏÉùÌôú Ï†ïÎ≥¥</option>
                                    <option value="Ïù¥ÏïºÍ∏∞">Ïù¥ÏïºÍ∏∞</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">Ï†ïÎ†¨</label>
                                <select class="filter-select" onchange="sortPosts()">
                                    <option value="created_at">ÏµúÏã†Ïàú</option>
                                    <option value="views">Ï°∞ÌöåÏàòÏàú</option>
                                    <option value="likes">Ï¢ãÏïÑÏöîÏàú</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">Í≤ÄÏÉâ</label>
                                <input type="text" class="form-input" id="searchInput" placeholder="Ï†úÎ™© Î∞è ÎÇ¥Ïö© Í≤ÄÏÉâ..." 
                                       onkeyup="searchPosts(this.value)" oninput="filterPosts()" style="width: 200px;">
                            </div>
                        </div>
                    </div>
                    
                    <div class="posts-list" id="postsList">
                        <!-- Í≤åÏãúÍ∏ÄÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>
                </div>
                
                <!-- Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄ -->
                <div class="page" id="post-detail">
                    <div class="post-detail">
                        <div class="post-detail-header">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                                <button onclick="showPage('posts')" style="background: #f3f4f6; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 5px; color: #374151; font-size: 0.9em;">
                                    ‚Üê Î™©Î°ùÏúºÎ°ú
                                </button>
                                
                                <!-- ÏûëÏÑ±ÏûêÎßå Î≥¥Ïù¥Îäî ÏàòÏ†ï/ÏÇ≠Ï†ú Î≤ÑÌäº -->
                                <div class="post-actions" id="postActions" style="display: none; gap: 10px;">
                                    <button onclick="editCurrentPost()" style="background: #2563eb; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 5px; font-size: 0.9em;">
                                        ‚úèÔ∏è ÏàòÏ†ï
                                    </button>
                                    <button onclick="deleteCurrentPost()" style="background: #dc2626; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 5px; font-size: 0.9em;">
                                        üóëÔ∏è ÏÇ≠Ï†ú
                                    </button>
                                </div>
                            </div>
                            <div class="post-detail-title" id="postDetailTitle">
                                Í≤åÏãúÍ∏Ä Ï†úÎ™©
                            </div>
                            <div class="post-detail-meta">
                                <span class="post-type">ÏûêÏú†Í≤åÏãúÌåê</span>
                                <span>‚Ä¢</span>
                                <span>ÏûëÏÑ±Ïûê: user123</span>
                                <span>‚Ä¢</span>
                                <span>2024-01-15 14:30</span>
                            </div>
                            <div class="post-reactions">
                                <button class="reaction-btn" onclick="toggleReaction('like')">
                                    üëç <span id="likeCount">15</span>
                                </button>
                                <button class="reaction-btn" onclick="toggleReaction('dislike')">
                                    üëé <span id="dislikeCount">2</span>
                                </button>
                                <button class="reaction-btn" onclick="toggleReaction('bookmark')">
                                    üîñ <span id="bookmarkCount">8</span>
                                </button>
                            </div>
                        </div>
                        <div class="post-content" id="postDetailContent">
                            <p>Í≤åÏãúÍ∏Ä ÎÇ¥Ïö©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§...</p>
                        </div>
                        
                        <!-- Ï≤®Î∂Ä ÌååÏùº ÏÑπÏÖò -->
                        <div class="post-attachments" id="postAttachments" style="display: none;">
                            <div class="attachments-header">
                                <h4>Ï≤®Î∂Ä Ïù¥ÎØ∏ÏßÄ</h4>
                            </div>
                            <div class="attachments-grid" id="attachmentsGrid">
                                <!-- Ï≤®Î∂Ä Ïù¥ÎØ∏ÏßÄÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÌëúÏãúÎê©ÎãàÎã§ -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÎåìÍ∏Ä ÏÑπÏÖò -->
                    <div class="comments-section">
                        <div class="comments-header">
                            ÎåìÍ∏Ä <span id="commentCount">12</span>Í∞ú
                        </div>
                        
                        <div class="comment-form">
                            <textarea class="comment-textarea" placeholder="ÎåìÍ∏ÄÏùÑ ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî..." id="commentTextarea"></textarea>
                            <div class="comment-actions">
                                <button class="btn-comment" onclick="addComment()">
                                    ÎåìÍ∏Ä ÏûëÏÑ±
                                </button>
                            </div>
                        </div>
                        
                        <div class="comments-list" id="commentsList">
                            <!-- ÎåìÍ∏ÄÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                        </div>
                    </div>
                </div>
                
                <!-- Í≤åÏãúÍ∏Ä ÏàòÏ†ï ÌéòÏù¥ÏßÄ -->
                <div class="page" id="post-edit">
                    <div class="auth-container" style="max-width: 800px;">
                        <div class="auth-card">
                            <h2 class="auth-title">Í≤åÏãúÍ∏Ä ÏàòÏ†ï</h2>
                            <form onsubmit="handleUpdatePost(event)" id="editPostForm">
                                <div class="form-group">
                                    <label class="form-label">Ï†úÎ™©</label>
                                    <input type="text" class="form-input" name="title" id="editPostTitle" required 
                                           placeholder="Í≤åÏãúÍ∏Ä Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÎÇ¥Ïö©</label>
                                    <textarea class="form-textarea" name="content" id="editPostContent" required 
                                              placeholder="Í≤åÏãúÍ∏Ä ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" rows="8"></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÏÑúÎπÑÏä§</label>
                                    <select class="form-input" name="service" id="editPostService" required onchange="updateEditPostType()">
                                        <option value="">ÏÑúÎπÑÏä§ ÏÑ†ÌÉù</option>
                                        <option value="apartment">ÏïÑÌååÌä∏</option>
                                        <option value="shopping">ÏáºÌïë</option>
                                        <option value="community">Ïª§ÎÆ§ÎãàÌã∞</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÌÉÄÏûÖ</label>
                                    <select class="form-input" name="type" id="editPostType" required>
                                        <option value="">ÌÉÄÏûÖ ÏÑ†ÌÉù</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÌÉúÍ∑∏ (ÏΩ§ÎßàÎ°ú Íµ¨Î∂Ñ, ÏµúÎåÄ 3Í∞ú)</label>
                                    <input type="text" class="form-input" name="tags" id="editPostTags" 
                                           placeholder="ÌÉúÍ∑∏1, ÌÉúÍ∑∏2, ÌÉúÍ∑∏3">
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <button type="submit" class="btn-primary" id="updatePostBtn">
                                        ÏàòÏ†ï ÏôÑÎ£å
                                    </button>
                                    <button type="button" class="btn-secondary" onclick="showPage('post-detail')">
                                        Ï∑®ÏÜå
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                
                <!-- Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÌéòÏù¥ÏßÄ -->
                <div class="page" id="post-create">
                    <div class="auth-container" style="max-width: 800px;">
                        <div class="auth-card">
                            <h2 class="auth-title">ÏÉà Í≤åÏãúÍ∏Ä ÏûëÏÑ±</h2>
                            <form onsubmit="handleCreatePost(event)">
                                <div class="form-group">
                                    <label class="form-label">Ï†úÎ™©</label>
                                    <input type="text" class="form-input" name="title" required 
                                           placeholder="Í≤åÏãúÍ∏Ä Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÏÑúÎπÑÏä§</label>
                                    <select class="form-input" name="service" id="createPostService" required onchange="updateCreatePostType()">
                                        <option value="apartment">ÏïÑÌååÌä∏</option>
                                        <option value="shopping">ÏáºÌïë</option>
                                        <option value="community">Ïª§ÎÆ§ÎãàÌã∞</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÌÉÄÏûÖ</label>
                                    <select class="form-input" name="type" id="createPostType" required>
                                        <option value="ÏûÖÏ£º Ï†ïÎ≥¥">ÏûÖÏ£º Ï†ïÎ≥¥</option>
                                        <option value="ÏÉùÌôú Ï†ïÎ≥¥">ÏÉùÌôú Ï†ïÎ≥¥</option>
                                        <option value="Ïù¥ÏïºÍ∏∞">Ïù¥ÏïºÍ∏∞</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÎÇ¥Ïö©</label>
                                    <textarea class="form-input" name="content" required 
                                              placeholder="Í≤åÏãúÍ∏Ä ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." 
                                              style="min-height: 200px; resize: vertical;"></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÌÉúÍ∑∏ (ÏâºÌëúÎ°ú Íµ¨Î∂Ñ)</label>
                                    <input type="text" class="form-input" name="tags" 
                                           placeholder="ÌÉúÍ∑∏1, ÌÉúÍ∑∏2, ÌÉúÍ∑∏3">
                                </div>
                                
                                <!-- ÌååÏùº Ï≤®Î∂Ä Í∏∞Îä• -->
                                <div class="form-group">
                                    <label class="form-label">ÌååÏùº Ï≤®Î∂Ä</label>
                                    <div class="file-upload-area" id="postFileUpload">
                                        <div class="file-upload-content">
                                            <div class="file-upload-icon">üìÅ</div>
                                            <div class="file-upload-text">
                                                <p>ÌååÏùºÏùÑ ÎìúÎûòÍ∑∏ÌïòÏó¨ ÏóÖÎ°úÎìúÌïòÍ±∞ÎÇò ÌÅ¥Î¶≠ÌïòÏó¨ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</p>
                                                <p class="file-upload-hint">Ïù¥ÎØ∏ÏßÄ ÌååÏùº (JPG, PNG, GIF) - ÏµúÎåÄ 10MB</p>
                                            </div>
                                            <input type="file" id="postFileInput" multiple accept="image/*" style="display: none;">
                                        </div>
                                        <div class="uploaded-files" id="postUploadedFiles" style="display: none;">
                                            <h4>Ï≤®Î∂ÄÎêú ÌååÏùº:</h4>
                                            <div class="file-list" id="postFileList"></div>
                                        </div>
                                    </div>
                                </div>
                                <button type="submit" class="btn-primary" id="createPostBtn">
                                    Í≤åÏãúÍ∏Ä ÏûëÏÑ±
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                
                <!-- ÌååÏùº ÏóÖÎ°úÎìú ÌÖåÏä§Ìä∏ ÌéòÏù¥ÏßÄ -->
                <div class="page" id="file-upload">
                    <div class="auth-container" style="max-width: 800px;">
                        <div class="auth-card">
                            <h2 class="auth-title">üìé ÌååÏùº ÏóÖÎ°úÎìú ÌÖåÏä§Ìä∏</h2>
                            <p style="text-align: center; color: #6b7280; margin-bottom: 30px;">
                                ÌååÏùº Í¥ÄÎ¶¨ API (Task 1-6) ÌÜµÌï© ÌÖåÏä§Ìä∏
                            </p>
                            
                            <!-- ÏóÖÎ°úÎìú ÏÑπÏÖò -->
                            <div style="border: 2px dashed #d1d5db; border-radius: 12px; padding: 30px; margin-bottom: 30px; text-align: center; transition: all 0.2s;" id="uploadArea">
                                <div style="font-size: 3em; margin-bottom: 10px;">üì§</div>
                                <h3>ÌååÏùºÏùÑ ÏÑ†ÌÉùÌïòÍ±∞ÎÇò ÎìúÎûòÍ∑∏Ìï¥ÏÑú ÏóÖÎ°úÎìú</h3>
                                <p style="color: #6b7280; margin: 10px 0;">ÏßÄÏõê ÌòïÏãù: JPG, JPEG, PNG, GIF, WEBP (ÏµúÎåÄ 5MB)</p>
                                
                                <form id="fileUploadForm" style="margin-top: 20px;">
                                    <input type="file" id="fileInput" name="file" accept="image/*" style="display: none;" onchange="handleFileSelect(event)">
                                    <button type="button" class="btn-primary" onclick="document.getElementById('fileInput').click()">
                                        ÌååÏùº ÏÑ†ÌÉù
                                    </button>
                                    
                                    <!-- Ï≤®Î∂Ä ÏòµÏÖò -->
                                    <div style="margin-top: 20px; text-align: left;">
                                        <label class="form-label">Ï≤®Î∂Ä ÌÉÄÏûÖ (ÏÑ†ÌÉù)</label>
                                        <select class="form-input" id="attachmentType" name="attachment_type">
                                            <option value="">ÏÑ†ÌÉù ÏïàÌï®</option>
                                            <option value="post">Í≤åÏãúÍ∏Ä</option>
                                            <option value="comment">ÎåìÍ∏Ä</option>
                                            <option value="profile">ÌîÑÎ°úÌïÑ</option>
                                        </select>
                                    </div>
                                    
                                    <div style="margin-top: 15px; text-align: left;">
                                        <label class="form-label">Ï≤®Î∂Ä ID (ÏÑ†ÌÉù)</label>
                                        <input type="text" class="form-input" id="attachmentId" name="attachment_id" placeholder="Ïòà: post_123, comment_456">
                                    </div>
                                </form>
                            </div>
                            
                            <!-- ÌååÏùº Ï†ïÎ≥¥ ÌëúÏãú -->
                            <div id="fileInfo" style="display: none; background: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                                <h4 style="color: #0369a1; margin-bottom: 10px;">üìã ÏÑ†ÌÉùÎêú ÌååÏùº</h4>
                                <div id="fileDetails"></div>
                                <div style="margin-top: 15px;">
                                    <button type="button" class="btn-primary" onclick="uploadSelectedFile()" id="uploadBtn">
                                        ÏóÖÎ°úÎìú ÏãúÏûë
                                    </button>
                                    <button type="button" class="btn-secondary" onclick="clearFileSelection()">
                                        Ï∑®ÏÜå
                                    </button>
                                </div>
                            </div>
                            
                            <!-- ÏóÖÎ°úÎìú ÏßÑÌñâÏÉÅÌô© -->
                            <div id="uploadProgress" style="display: none; margin-bottom: 20px;">
                                <div style="background: #f3f4f6; border-radius: 8px; padding: 4px;">
                                    <div id="progressBar" style="background: #10b981; height: 8px; border-radius: 4px; width: 0%; transition: width 0.3s;"></div>
                                </div>
                                <p style="text-align: center; margin-top: 10px; color: #6b7280;" id="progressText">ÏóÖÎ°úÎìú Ï§ë...</p>
                            </div>
                            
                            <!-- ÏóÖÎ°úÎìú Í≤∞Í≥º -->
                            <div id="uploadResult" style="display: none;">
                                <h4 style="color: #059669; margin-bottom: 15px;">‚úÖ ÏóÖÎ°úÎìú ÏÑ±Í≥µ!</h4>
                                <div id="resultDetails" style="background: #f0fdf4; border: 1px solid #16a34a; border-radius: 8px; padding: 20px;"></div>
                                <div style="margin-top: 15px;">
                                    <button type="button" class="btn-primary" onclick="resetUploadForm()">
                                        ÏÉà ÌååÏùº ÏóÖÎ°úÎìú
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Ïò§Î•ò ÌëúÏãú -->
                            <div id="uploadError" style="display: none;">
                                <h4 style="color: #dc2626; margin-bottom: 15px;">‚ùå ÏóÖÎ°úÎìú Ïã§Ìå®</h4>
                                <div id="errorDetails" style="background: #fef2f2; border: 1px solid #ef4444; border-radius: 8px; padding: 20px; color: #dc2626;"></div>
                                <div style="margin-top: 15px;">
                                    <button type="button" class="btn-primary" onclick="resetUploadForm()">
                                        Îã§Ïãú ÏãúÎèÑ
                                    </button>
                                </div>
                            </div>
                            
                            <!-- API ÌÖåÏä§Ìä∏ Î°úÍ∑∏ -->
                            <div style="margin-top: 30px;">
                                <h4 style="margin-bottom: 15px;">üîß API ÌÖåÏä§Ìä∏ Î°úÍ∑∏</h4>
                                <div id="apiLog" style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 15px; max-height: 300px; overflow-y: auto; font-family: monospace; font-size: 0.9em;">
                                    <div style="color: #6b7280;">API Ìò∏Ï∂ú Î°úÍ∑∏Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§...</div>
                                </div>
                                <button type="button" class="btn-secondary" onclick="clearApiLog()" style="margin-top: 10px;">
                                    Î°úÍ∑∏ ÏßÄÏö∞Í∏∞
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞Î°ú ÏûëÏÑ± ÌéòÏù¥ÏßÄ -->
                <div class="page" id="post-editor">
                    <div class="auth-container" style="max-width: 1200px;">
                        <div class="auth-card">
                            <h2 class="auth-title">‚úçÔ∏è Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞Î°ú Í≤åÏãúÍ∏Ä ÏûëÏÑ±</h2>
                            <p style="text-align: center; color: #6b7280; margin-bottom: 30px;">
                                Îã§ÏñëÌïú ÏÑúÏãùÏùÑ ÌôúÏö©ÌïòÏó¨ Î©ãÏßÑ Í≤åÏãúÍ∏ÄÏùÑ ÏûëÏÑ±Ìï¥Î≥¥ÏÑ∏Ïöî
                            </p>
                            
                            <form id="editorPostForm" onsubmit="handleEditorPostSubmit(event)">
                                <div class="form-group">
                                    <label class="form-label">Ï†úÎ™©</label>
                                    <input type="text" class="form-input" id="editorTitle" placeholder="Í≤åÏãúÍ∏Ä Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">ÏÑúÎπÑÏä§</label>
                                    <select class="form-input" id="editorService" required>
                                        <option value="">ÏÑúÎπÑÏä§Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                                        <option value="apartment">ÏïÑÌååÌä∏</option>
                                        <option value="shopping">ÏáºÌïë</option>
                                        <option value="community">Ïª§ÎÆ§ÎãàÌã∞</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">ÎÇ¥Ïö©</label>
                                    
                                    <!-- Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞ Ìà¥Î∞î -->
                                    <div id="editor-toolbar" class="editor-toolbar">
                                        <!-- Í∏∞Î≥∏ ÏÑúÏãù -->
                                        <div class="toolbar-group">
                                            <button type="button" id="btn-bold" class="toolbar-btn" data-command="bold" title="ÍµµÍ≤å">
                                                <strong>B</strong>
                                            </button>
                                            <button type="button" id="btn-italic" class="toolbar-btn" data-command="italic" title="Í∏∞Ïö∏ÏûÑ">
                                                <em>I</em>
                                            </button>
                                            <button type="button" id="btn-underline" class="toolbar-btn" data-command="underline" title="Î∞ëÏ§Ñ">
                                                <u>U</u>
                                            </button>
                                            <button type="button" id="btn-strike" class="toolbar-btn" data-command="strikethrough" title="Ï∑®ÏÜåÏÑ†">
                                                <s>S</s>
                                            </button>
                                        </div>
                                        
                                        <div class="toolbar-divider"></div>
                                        
                                        <!-- Í∏ÄÏî®Ï≤¥ Î∞è ÌÅ¨Í∏∞ -->
                                        <select id="fontFamily" class="toolbar-select" data-command="fontFamily" title="Í∏ÄÏî®Ï≤¥">
                                            <option value="">Í∏ÄÏî®Ï≤¥</option>
                                            <option value="Arial, sans-serif">Arial</option>
                                            <option value="'Times New Roman', serif">Times New Roman</option>
                                            <option value="'Courier New', monospace">Courier New</option>
                                            <option value="Georgia, serif">Georgia</option>
                                            <option value="Verdana, sans-serif">Verdana</option>
                                            <option value="'Malgun Gothic', sans-serif">ÎßëÏùÄ Í≥†Îîï</option>
                                            <option value="'Noto Sans KR', sans-serif">Noto Sans KR</option>
                                        </select>
                                        
                                        <select id="fontSize" class="toolbar-select" data-command="fontSize" title="Í∏ÄÏûê ÌÅ¨Í∏∞">
                                            <option value="">ÌÅ¨Í∏∞</option>
                                            <option value="12px">12px</option>
                                            <option value="14px">14px</option>
                                            <option value="16px">16px</option>
                                            <option value="18px">18px</option>
                                            <option value="20px">20px</option>
                                            <option value="24px">24px</option>
                                            <option value="28px">28px</option>
                                            <option value="32px">32px</option>
                                        </select>
                                        
                                        <input type="color" id="textColor" class="toolbar-color" data-command="foreColor" title="Í∏ÄÏûê ÏÉâÏÉÅ" value="#000000">
                                        
                                        <div class="toolbar-divider"></div>
                                        
                                        <!-- Î¶¨Ïä§Ìä∏ -->
                                        <div class="toolbar-group">
                                            <button type="button" id="btn-bullet" class="toolbar-btn" data-command="insertUnorderedList" title="Í∏ÄÎ®∏Î¶¨ Í∏∞Ìò∏">
                                                ‚Ä¢ ‚Äî
                                            </button>
                                            <button type="button" id="btn-ordered" class="toolbar-btn" data-command="insertOrderedList" title="Î≤àÌò∏ Îß§Í∏∞Í∏∞">
                                                1. ‚Äî
                                            </button>
                                        </div>
                                        
                                        <div class="toolbar-divider"></div>
                                        
                                        <!-- Ï†ïÎ†¨ -->
                                        <div class="toolbar-group">
                                            <button type="button" id="btn-align-left" class="toolbar-btn" data-command="justifyLeft" title="ÏôºÏ™Ω Ï†ïÎ†¨">
                                                ‚üµ
                                            </button>
                                            <button type="button" id="btn-align-center" class="toolbar-btn" data-command="justifyCenter" title="Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨">
                                                ‚ò∞
                                            </button>
                                            <button type="button" id="btn-align-right" class="toolbar-btn" data-command="justifyRight" title="Ïò§Î•∏Ï™Ω Ï†ïÎ†¨">
                                                ‚ü∂
                                            </button>
                                        </div>
                                        
                                        <div class="toolbar-divider"></div>
                                        
                                        <!-- Í∏∞ÌÉÄ -->
                                        <button type="button" id="btn-quote" class="toolbar-btn" data-command="formatBlock" data-value="blockquote" title="Ïù∏Ïö©Íµ¨">
                                            ‚ùù
                                        </button>
                                        
                                        <button type="button" id="btn-image" class="toolbar-btn" title="Ïù¥ÎØ∏ÏßÄ ÏÇΩÏûÖ">
                                            üñºÔ∏è
                                        </button>
                                        <input type="file" id="imageInput" accept="image/*" style="display: none;">
                                        
                                        <div class="toolbar-divider"></div>
                                        
                                        <!-- Ïã§Ìñâ Ï∑®ÏÜå -->
                                        <div class="toolbar-group">
                                            <button type="button" id="btn-undo" class="toolbar-btn" data-command="undo" title="Ïã§Ìñâ Ï∑®ÏÜå">
                                                ‚Ü∂
                                            </button>
                                            <button type="button" id="btn-redo" class="toolbar-btn" data-command="redo" title="Îã§Ïãú Ïã§Ìñâ">
                                                ‚Ü∑
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞ -->
                                    <div id="rich-text-editor" class="rich-text-editor" contenteditable="true">
                                        <p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>
                                    </div>
                                </div>
                                
                                <div style="display: flex; gap: 10px; margin-top: 20px;">
                                    <button type="submit" class="btn-primary" style="flex: 1;">
                                        Í≤åÏãúÍ∏Ä ÏûëÏÑ±
                                    </button>
                                    <button type="button" class="btn-secondary" onclick="clearEditor()" style="flex: 1;">
                                        Ï¥àÍ∏∞Ìôî
                                    </button>
                                </div>
                            </form>
                            
                            <!-- ÌÖåÏä§Ìä∏ Ìå®ÎÑê (Í∞úÎ∞úÏö©) -->
                            <div id="test-panel" style="margin-top: 30px; padding: 20px; background: #f9fafb; border-radius: 8px; border: 1px solid #e5e7eb; display: none;">
                                <h4 style="margin-bottom: 15px;">ÌÖåÏä§Ìä∏ Í≤∞Í≥º</h4>
                                <div id="test-results" style="background: white; padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.9em; max-height: 300px; overflow-y: auto;">
                                    ÌÖåÏä§Ìä∏ Ï§ÄÎπÑ ÏôÑÎ£å
                                </div>
                                <button type="button" class="btn-secondary" onclick="runEditorTests()" style="margin-top: 10px;">
                                    ÌÖåÏä§Ìä∏ Ïã§Ìñâ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tiptap ÏóêÎîîÌÑ∞ ÌéòÏù¥ÏßÄ -->
                <div class="page" id="editor-tiptap">
                    <div class="auth-container" style="max-width: 1000px;">
                        <div class="auth-card">
                            <h2 class="auth-title">‚úèÔ∏è Tiptap ÏóêÎîîÌÑ∞ ÌÖåÏä§Ìä∏</h2>
                            <p style="text-align: center; color: #6b7280; margin-bottom: 30px;">
                                Tiptap Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞Î°ú Í≤åÏãúÍ∏Ä ÏûëÏÑ±Ìï¥Î≥¥Í∏∞
                            </p>
                            
                            <form id="tiptapPostForm">
                                <div class="form-group">
                                    <label class="form-label">Ï†úÎ™©</label>
                                    <input type="text" class="form-input" id="tiptapTitle" placeholder="Í≤åÏãúÍ∏Ä Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">ÏÑúÎπÑÏä§</label>
                                    <select class="form-input" id="tiptapService" required>
                                        <option value="">ÏÑúÎπÑÏä§Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                                        <option value="apartment">ÏïÑÌååÌä∏</option>
                                        <option value="shopping">ÏáºÌïë</option>
                                        <option value="community">Ïª§ÎÆ§ÎãàÌã∞</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">ÎÇ¥Ïö©</label>
                                    <!-- Tiptap CDN -->
                                    <script src="https://unpkg.com/@tiptap/core@2.1.13/dist/tiptap-core.umd.js"></script>
                                    <script src="https://unpkg.com/@tiptap/starter-kit@2.1.13/dist/tiptap-starter-kit.umd.js"></script>
                                    <script src="https://unpkg.com/@tiptap/extension-link@2.1.13/dist/tiptap-extension-link.umd.js"></script>
                                    <script src="https://unpkg.com/@tiptap/extension-image@2.1.13/dist/tiptap-extension-image.umd.js"></script>
                                    
                                    <!-- Tiptap Ìà¥Î∞î -->
                                    <div id="tiptap-toolbar" style="border: 1px solid #d1d5db; border-bottom: none; border-radius: 8px 8px 0 0; padding: 10px; background: #f9fafb; display: flex; gap: 8px; flex-wrap: wrap;">
                                        <button type="button" onclick="tiptapEditor.chain().focus().toggleBold().run()" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            <strong>B</strong>
                                        </button>
                                        <button type="button" onclick="tiptapEditor.chain().focus().toggleItalic().run()" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            <em>I</em>
                                        </button>
                                        <button type="button" onclick="tiptapEditor.chain().focus().toggleStrike().run()" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            <s>S</s>
                                        </button>
                                        <button type="button" onclick="tiptapEditor.chain().focus().toggleHeading({ level: 1 }).run()" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            H1
                                        </button>
                                        <button type="button" onclick="tiptapEditor.chain().focus().toggleHeading({ level: 2 }).run()" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            H2
                                        </button>
                                        <button type="button" onclick="tiptapEditor.chain().focus().toggleBulletList().run()" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            ‚Ä¢ List
                                        </button>
                                        <button type="button" onclick="tiptapEditor.chain().focus().toggleOrderedList().run()" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            1. List
                                        </button>
                                        <button type="button" onclick="tiptapEditor.chain().focus().toggleBlockquote().run()" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            Quote
                                        </button>
                                    </div>
                                    
                                    <!-- Tiptap ÏóêÎîîÌÑ∞ -->
                                    <div id="tiptap-editor" style="border: 1px solid #d1d5db; border-radius: 0 0 8px 8px; min-height: 300px; padding: 15px; background: white; outline: none;">
                                        <p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>
                                    </div>
                                </div>
                                
                                <div style="display: flex; gap: 10px; margin-top: 20px;">
                                    <button type="submit" class="btn-primary" style="flex: 1;">
                                        Í≤åÏãúÍ∏Ä ÏûëÏÑ±
                                    </button>
                                    <button type="button" class="btn-secondary" onclick="clearTiptapEditor()" style="flex: 1;">
                                        Ï¥àÍ∏∞Ìôî
                                    </button>
                                </div>
                            </form>
                            
                            <!-- API ÌÖåÏä§Ìä∏ Î°úÍ∑∏ -->
                            <div style="margin-top: 30px; padding: 20px; background: #f9fafb; border-radius: 8px; border: 1px solid #e5e7eb;">
                                <h4 style="margin-bottom: 15px;">API ÌÖåÏä§Ìä∏ Í≤∞Í≥º</h4>
                                <div id="tiptap-api-log" style="background: #1f2937; color: #e5e7eb; padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.9em; max-height: 200px; overflow-y: auto;">
                                    Tiptap ÏóêÎîîÌÑ∞ Ï§ÄÎπÑ ÏôÑÎ£å
                                </div>
                                <button type="button" class="btn-secondary" onclick="clearTiptapLog()" style="margin-top: 10px;">
                                    Î°úÍ∑∏ ÏßÄÏö∞Í∏∞
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Novel ÏóêÎîîÌÑ∞ ÌéòÏù¥ÏßÄ -->
                <div class="page" id="editor-novel">
                    <div class="auth-container" style="max-width: 1000px;">
                        <div class="auth-card">
                            <h2 class="auth-title">üìù Novel ÏóêÎîîÌÑ∞ ÌÖåÏä§Ìä∏</h2>
                            <p style="text-align: center; color: #6b7280; margin-bottom: 30px;">
                                Novel AI Í∏∞Î∞ò Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞Î°ú Í≤åÏãúÍ∏Ä ÏûëÏÑ±Ìï¥Î≥¥Í∏∞
                            </p>
                            
                            <form id="novelPostForm">
                                <div class="form-group">
                                    <label class="form-label">Ï†úÎ™©</label>
                                    <input type="text" class="form-input" id="novelTitle" placeholder="Í≤åÏãúÍ∏Ä Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">ÏÑúÎπÑÏä§</label>
                                    <select class="form-input" id="novelService" required>
                                        <option value="">ÏÑúÎπÑÏä§Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                                        <option value="apartment">ÏïÑÌååÌä∏</option>
                                        <option value="shopping">ÏáºÌïë</option>
                                        <option value="community">Ïª§ÎÆ§ÎãàÌã∞</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">ÎÇ¥Ïö©</label>
                                    
                                    <!-- Novel ÏóêÎîîÌÑ∞ Ìà¥Î∞î -->
                                    <div id="novel-toolbar" style="border: 1px solid #d1d5db; border-bottom: none; border-radius: 8px 8px 0 0; padding: 10px; background: #f9fafb; display: flex; gap: 8px; flex-wrap: wrap;">
                                        <button type="button" onclick="execNovelCommand('bold')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer; font-weight: bold;">
                                            B
                                        </button>
                                        <button type="button" onclick="execNovelCommand('italic')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer; font-style: italic;">
                                            I
                                        </button>
                                        <button type="button" onclick="execNovelCommand('underline')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer; text-decoration: underline;">
                                            U
                                        </button>
                                        <button type="button" onclick="execNovelCommand('strikeThrough')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer; text-decoration: line-through;">
                                            S
                                        </button>
                                        <div style="width: 1px; height: 24px; background: #d1d5db; margin: 0 4px;"></div>
                                        <button type="button" onclick="execNovelCommand('formatBlock', '<h1>')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            H1
                                        </button>
                                        <button type="button" onclick="execNovelCommand('formatBlock', '<h2>')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            H2
                                        </button>
                                        <button type="button" onclick="execNovelCommand('formatBlock', '<h3>')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            H3
                                        </button>
                                        <div style="width: 1px; height: 24px; background: #d1d5db; margin: 0 4px;"></div>
                                        <button type="button" onclick="execNovelCommand('insertUnorderedList')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            ‚Ä¢ List
                                        </button>
                                        <button type="button" onclick="execNovelCommand('insertOrderedList')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            1. List
                                        </button>
                                        <div style="width: 1px; height: 24px; background: #d1d5db; margin: 0 4px;"></div>
                                        <button type="button" onclick="execNovelCommand('justifyLeft')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            ‚≠§
                                        </button>
                                        <button type="button" onclick="execNovelCommand('justifyCenter')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            ‚≠ß
                                        </button>
                                        <button type="button" onclick="execNovelCommand('justifyRight')" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            ‚≠¢
                                        </button>
                                        <div style="width: 1px; height: 24px; background: #d1d5db; margin: 0 4px;"></div>
                                        <select onchange="execNovelCommand('fontSize', this.value); this.selectedIndex = 0;" style="padding: 4px 8px; border: 1px solid #d1d5db; border-radius: 4px; background: white; cursor: pointer;">
                                            <option value="">ÌÅ¨Í∏∞</option>
                                            <option value="1">8pt</option>
                                            <option value="2">10pt</option>
                                            <option value="3">12pt</option>
                                            <option value="4">14pt</option>
                                            <option value="5">18pt</option>
                                            <option value="6">24pt</option>
                                            <option value="7">36pt</option>
                                        </select>
                                        <input type="color" onchange="execNovelCommand('foreColor', this.value)" style="width: 40px; height: 30px; border: 1px solid #d1d5db; border-radius: 4px; cursor: pointer;" title="Í∏ÄÏûê ÏÉâÏÉÅ">
                                        <input type="color" onchange="execNovelCommand('backColor', this.value)" style="width: 40px; height: 30px; border: 1px solid #d1d5db; border-radius: 4px; cursor: pointer;" title="Î∞∞Í≤Ω ÏÉâÏÉÅ">
                                    </div>
                                    
                                    <!-- Novel ÏóêÎîîÌÑ∞ Ïª®ÌÖåÏù¥ÎÑà -->
                                    <div id="novel-editor" contenteditable="true" style="border: 1px solid #d1d5db; border-radius: 0 0 8px 8px; min-height: 350px; padding: 15px; background: white; outline: none; font-family: inherit; line-height: 1.6;">
                                        <p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>
                                    </div>
                                </div>
                                
                                <div style="display: flex; gap: 10px; margin-top: 20px;">
                                    <button type="submit" class="btn-primary" style="flex: 1;">
                                        Í≤åÏãúÍ∏Ä ÏûëÏÑ±
                                    </button>
                                    <button type="button" class="btn-secondary" onclick="clearNovelEditor()" style="flex: 1;">
                                        Ï¥àÍ∏∞Ìôî
                                    </button>
                                </div>
                            </form>
                            
                            <!-- API ÌÖåÏä§Ìä∏ Î°úÍ∑∏ -->
                            <div style="margin-top: 30px; padding: 20px; background: #f9fafb; border-radius: 8px; border: 1px solid #e5e7eb;">
                                <h4 style="margin-bottom: 15px;">API ÌÖåÏä§Ìä∏ Í≤∞Í≥º</h4>
                                <div id="novel-api-log" style="background: #1f2937; color: #e5e7eb; padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.9em; max-height: 200px; overflow-y: auto;">
                                    Novel ÏóêÎîîÌÑ∞ Ï§ÄÎπÑ ÏôÑÎ£å
                                </div>
                                <button type="button" class="btn-secondary" onclick="clearNovelLog()" style="margin-top: 10px;">
                                    Î°úÍ∑∏ ÏßÄÏö∞Í∏∞
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ReactQuill ÏóêÎîîÌÑ∞ ÌéòÏù¥ÏßÄ -->
                <div class="page" id="editor-quill">
                    <div class="auth-container" style="max-width: 1000px;">
                        <div class="auth-card">
                            <h2 class="auth-title">üñäÔ∏è ReactQuill ÏóêÎîîÌÑ∞ ÌÖåÏä§Ìä∏</h2>
                            <p style="text-align: center; color: #6b7280; margin-bottom: 30px;">
                                ReactQuill Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞Î°ú Í≤åÏãúÍ∏Ä ÏûëÏÑ±Ìï¥Î≥¥Í∏∞
                            </p>
                            
                            <form id="quillPostForm">
                                <div class="form-group">
                                    <label class="form-label">Ï†úÎ™©</label>
                                    <input type="text" class="form-input" id="quillTitle" placeholder="Í≤åÏãúÍ∏Ä Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">ÏÑúÎπÑÏä§</label>
                                    <select class="form-input" id="quillService" required>
                                        <option value="">ÏÑúÎπÑÏä§Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                                        <option value="apartment">ÏïÑÌååÌä∏</option>
                                        <option value="shopping">ÏáºÌïë</option>
                                        <option value="community">Ïª§ÎÆ§ÎãàÌã∞</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">ÎÇ¥Ïö©</label>
                                    <!-- Quill CDN -->
                                    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
                                    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
                                    
                                    <!-- Quill ÏóêÎîîÌÑ∞ Ïª®ÌÖåÏù¥ÎÑà -->
                                    <div id="quill-editor" style="min-height: 300px; border: 1px solid #d1d5db; border-radius: 8px; background: white;">
                                        <!-- Quill editor will be initialized here -->
                                    </div>
                                </div>
                                
                                <div style="display: flex; gap: 10px; margin-top: 20px;">
                                    <button type="submit" class="btn-primary" style="flex: 1;">
                                        Í≤åÏãúÍ∏Ä ÏûëÏÑ±
                                    </button>
                                    <button type="button" class="btn-secondary" onclick="clearQuillEditor()" style="flex: 1;">
                                        Ï¥àÍ∏∞Ìôî
                                    </button>
                                </div>
                            </form>
                            
                            <!-- API ÌÖåÏä§Ìä∏ Î°úÍ∑∏ -->
                            <div style="margin-top: 30px; padding: 20px; background: #f9fafb; border-radius: 8px; border: 1px solid #e5e7eb;">
                                <h4 style="margin-bottom: 15px;">API ÌÖåÏä§Ìä∏ Í≤∞Í≥º</h4>
                                <div id="quill-api-log" style="background: #1f2937; color: #e5e7eb; padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.9em; max-height: 200px; overflow-y: auto;">
                                    ReactQuill ÏóêÎîîÌÑ∞ Ï§ÄÎπÑ ÏôÑÎ£å
                                </div>
                                <button type="button" class="btn-secondary" onclick="clearQuillLog()" style="margin-top: 10px;">
                                    Î°úÍ∑∏ ÏßÄÏö∞Í∏∞
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Í¥ÄÎ¶¨Ïûê ÌéòÏù¥ÏßÄ Ï†úÍ±∞Îê® -->
                
                <!-- API ÌÖåÏä§Ìä∏ ÌéòÏù¥ÏßÄ Ï†úÍ±∞Îê® -->
            </div>
        </main>
    </div>
    
    <!-- Î™®Îã¨ -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Ï†úÎ™©</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                ÎÇ¥Ïö©
            </div>
        </div>
    </div>
    
    <!-- ÏïåÎ¶º -->
    <div class="notification" id="notification"></div>
    
    <!-- ÏÇ≠Ï†ú ÌôïÏù∏ Îã§Ïù¥ÏñºÎ°úÍ∑∏ -->
    <div class="confirm-dialog" id="deleteConfirmDialog">
        <div class="confirm-content">
            <div class="confirm-title">Í≤åÏãúÍ∏Ä ÏÇ≠Ï†ú</div>
            <div class="confirm-message">
                Ï†ïÎßêÎ°ú Ïù¥ Í≤åÏãúÍ∏ÄÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?<br>
                ÏÇ≠Ï†úÎêú Í≤åÏãúÍ∏ÄÏùÄ Î≥µÍµ¨Ìï† Ïàò ÏóÜÏäµÎãàÎã§.
            </div>
            <div class="confirm-buttons">
                <button class="btn-confirm" onclick="confirmDeletePost()">ÏÇ≠Ï†ú</button>
                <button class="btn-cancel" onclick="cancelDeletePost()">Ï∑®ÏÜå</button>
            </div>
        </div>
    </div>
    
    <script>
        // API ÏÑ§Ï†ï
        const API_BASE_URL = 'http://localhost:8000';
        
        // Ï†ÑÏó≠ ÏÉÅÌÉú
        let currentUser = null;
        let posts = [];
        let comments = [];
        let reactions = {};
        let currentPost = null; // ÌòÑÏû¨ Î≥¥Í≥† ÏûàÎäî Í≤åÏãúÍ∏Ä
        let postsCache = new Map(); // Í≤åÏãúÍ∏Ä Ï∫êÏãú (slug -> post data)
        
        // API Ìó¨Ìçº Ìï®Ïàò
        function getAuthHeaders() {
            const token = localStorage.getItem('authToken');
            console.log('Current auth token:', token ? token.substring(0, 20) + '...' : 'null');
            return token ? { 'Authorization': `Bearer ${token}` } : {};
        }
        
        async function apiCall(endpoint, options = {}) {
            const url = `${API_BASE_URL}${endpoint}`;
            const defaultOptions = {
                headers: {
                    'Content-Type': 'application/json',
                    ...getAuthHeaders(),
                    ...options.headers
                }
            };
            
            console.log('Making API call to:', url);
            console.log('Options:', { ...defaultOptions, ...options });
            
            try {
                const response = await fetch(url, { ...defaultOptions, ...options });
                console.log('Response status:', response.status);
                console.log('Response headers:', Object.fromEntries(response.headers.entries()));
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('API error response:', errorText);
                    
                    // Handle authentication errors
                    if (response.status === 401) {
                        // Clear invalid token and redirect to login
                        localStorage.removeItem('authToken');
                        localStorage.removeItem('currentUser');
                        currentUser = null;
                        updateAuthUI();
                        showNotification('Ïù∏Ï¶ùÏù¥ ÎßåÎ£åÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú Î°úÍ∑∏Ïù∏Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
                        showPage('login');
                        return;
                    }
                    
                    // Try to parse as JSON for better error messages
                    try {
                        const errorData = JSON.parse(errorText);
                        throw new Error(`HTTP ${response.status}: ${errorData.detail || errorText}`);
                    } catch {
                        throw new Error(`HTTP ${response.status}: ${errorText}`);
                    }
                }
                
                // Handle 204 No Content responses (like DELETE operations)
                if (response.status === 204) {
                    return { success: true };
                }
                
                // Check if response has content before parsing JSON
                const contentType = response.headers.get('content-type');
                if (contentType && contentType.includes('application/json')) {
                    return await response.json();
                } else {
                    // Return success object for non-JSON responses
                    return { success: true };
                }
            } catch (error) {
                console.error('API call failed:', error);
                showNotification('API Ìò∏Ï∂ú Ïã§Ìå®: ' + error.message, 'error');
                throw error;
            }
        }
        
        // ÏÑúÎπÑÏä§Î≥Ñ ÌÉÄÏûÖ Ï†ïÏùò
        const serviceTypes = {
            apartment: ["ÏûÖÏ£º Ï†ïÎ≥¥", "ÏÉùÌôú Ï†ïÎ≥¥", "Ïù¥ÏïºÍ∏∞"],
            shopping: ["ÏÉÅÌíà Î¨∏Ïùò", "Î∞∞ÏÜ° Î¨∏Ïùò", "ÍµêÌôò/ÌôòÎ∂à", "Í∏∞ÌÉÄ"],
            community: ["ÏûêÏú†Í≤åÏãúÌåê", "ÏßàÎ¨∏ÎãµÎ≥Ä", "Í≥µÏßÄÏÇ¨Ìï≠", "ÌõÑÍ∏∞"]
        };
        
        // Î™®Ïùò Îç∞Ïù¥ÌÑ∞
        const mockPosts = [
            {
                id: "post1",
                title: "ÏûÖÏ£ºÏûê Î™®Ïßë ÏïàÎÇ¥Î¨∏",
                content: "2024ÎÖÑ 3Ïõî ÏûÖÏ£ºÏòàÏ†ïÏù∏ Ïã†Í∑ú ÏïÑÌååÌä∏ ÏûÖÏ£ºÏûêÎ•º Î™®ÏßëÌï©ÎãàÎã§. ÏûêÏÑ∏Ìïú ÎÇ¥Ïö©ÏùÄ...",
                author_id: "user1",
                slug: "apt-move-in-guide-2024",
                service: "apartment",
                metadata: {
                    type: "ÏûÖÏ£º Ï†ïÎ≥¥",
                    tags: ["Ïã†Í∑úÏûÖÏ£º", "2024ÎÖÑ"],
                    visibility: "public"
                },
                created_at: "2024-01-15T14:30:00",
                view_count: 324,
                like_count: 45,
                dislike_count: 2,
                comment_count: 18
            },
            {
                id: "post2",
                title: "Ï£ºÏ∞®Ïû• Ïù¥Ïö© Í∑úÏ†ï Î≥ÄÍ≤Ω ÏïàÎÇ¥",
                content: "ÏïÑÌååÌä∏ Ï£ºÏ∞®Ïû• Ïù¥Ïö© Í∑úÏ†ïÏù¥ Îã§ÏùåÍ≥º Í∞ôÏù¥ Î≥ÄÍ≤ΩÎê©ÎãàÎã§...",
                author_id: "user2",
                slug: "parking-rule-change-2024",
                service: "apartment",
                metadata: {
                    type: "ÏÉùÌôú Ï†ïÎ≥¥",
                    tags: ["Ï£ºÏ∞®", "Í∑úÏ†ï"],
                    visibility: "public"
                },
                created_at: "2024-01-14T09:15:00",
                view_count: 189,
                like_count: 22,
                dislike_count: 5,
                comment_count: 12
            },
            {
                id: "post3",
                title: "Í¥ÄÎ¶¨ÎπÑ Ï†àÏïΩ ÎÖ∏ÌïòÏö∞",
                content: "Îß§Îã¨ ÎÇòÍ∞ÄÎäî Í¥ÄÎ¶¨ÎπÑÎ•º Ï†àÏïΩÌïòÎäî Î∞©Î≤ïÎì§ÏùÑ Í≥µÏú†Ìï©ÎãàÎã§...",
                author_id: "user3",
                slug: "save-management-fee-tips",
                service: "apartment",
                metadata: {
                    type: "Ïù¥ÏïºÍ∏∞",
                    tags: ["Ï†àÏïΩ", "Í¥ÄÎ¶¨ÎπÑ"],
                    visibility: "public"
                },
                created_at: "2024-01-13T16:45:00",
                view_count: 567,
                like_count: 89,
                dislike_count: 1,
                comment_count: 34
            }
        ];
        
        
        // Í≤åÏãúÍ∏Ä API Ìï®ÏàòÎì§
        async function loadPosts() {
            try {
                const response = await apiCall('/api/posts/');
                console.log('Posts API response:', response);
                posts = response.items || [];
                console.log('Loaded posts with stats:', posts);
                
                // Ï†ÑÏ≤¥ posts Îç∞Ïù¥ÌÑ∞Î•º Í∏ÄÎ°úÎ≤å Î≥ÄÏàòÏóê Ï†ÄÏû• (ÌïÑÌÑ∞ÎßÅÏö©)
                window.allPosts = [...posts];
                
                // Ï∫êÏãú ÏóÖÎç∞Ïù¥Ìä∏
                postsCache.clear();
                posts.forEach(post => {
                    const key = post.slug || post._id || post.id;
                    postsCache.set(key, post);
                });
                
                renderPosts();
            } catch (error) {
                // API Ïã§Ìå®Ïãú Î™®Ïùò Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                console.warn('Failed to load posts from API, using mock data:', error);
                posts = [...mockPosts];
                window.allPosts = [...mockPosts];
                renderPosts();
            }
        }
        
        async function createPost(postData) {
            try {
                const newPost = await apiCall('/api/posts/', {
                    method: 'POST',
                    body: JSON.stringify(postData)
                });
                showNotification('Í≤åÏãúÍ∏ÄÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏûëÏÑ±ÎêòÏóàÏäµÎãàÎã§!', 'success');
                await loadPosts(); // Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®
                
                console.log('ÏÉàÎ°ú ÏûëÏÑ±Îêú Í≤åÏãúÍ∏Ä:', newPost);
                console.log('ÌòÑÏû¨ ÏÇ¨Ïö©Ïûê:', currentUser);
                
                return newPost;
            } catch (error) {
                console.warn('API Ìò∏Ï∂ú Ïã§Ìå®, Î™®Ïùò Í≤åÏãúÍ∏Ä ÏÉùÏÑ±:', error);
                
                // API Ïã§Ìå® Ïãú Î™®Ïùò Í≤åÏãúÍ∏Ä ÏÉùÏÑ±
                const mockPost = {
                    id: `post_${Date.now()}`,
                    slug: `post-${Date.now()}`,
                    title: postData.title,
                    content: postData.content,
                    service: postData.service,
                    metadata: postData.metadata,
                    file_ids: postData.metadata?.file_ids || [], // API Î™ÖÏÑ∏Ïóê Îî∞Îùº file_ids ÏÇ¨Ïö©
                    author_id: currentUser?.email || 'test_user',
                    created_at: new Date().toISOString(),
                    view_count: 0,
                    like_count: 0,
                    dislike_count: 0,
                    comment_count: 0,
                    stats: {
                        view_count: 0,
                        like_count: 0,
                        dislike_count: 0,
                        comment_count: 0,
                        bookmark_count: 0
                    }
                };
                
                // Î™®Ïùò Îç∞Ïù¥ÌÑ∞ Î∞∞Ïó¥Ïóê Ï∂îÍ∞Ä
                mockPosts.unshift(mockPost);
                posts.unshift(mockPost);
                window.allPosts = [...posts];
                
                // Ï∫êÏãúÏóêÎèÑ Ï∂îÍ∞Ä
                postsCache.set(mockPost.slug, mockPost);
                
                showNotification('Í≤åÏãúÍ∏ÄÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏûëÏÑ±ÎêòÏóàÏäµÎãàÎã§! (ÌÖåÏä§Ìä∏ Î™®Îìú)', 'success');
                return mockPost;
            }
        }
        
        async function searchPosts(query) {
            try {
                const response = await apiCall(`/api/posts/search?q=${encodeURIComponent(query)}`);
                posts = response.items || [];
                renderPosts();
            } catch (error) {
                showNotification('Í≤ÄÏÉâÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        }
        
        // Ï¥àÍ∏∞Ìôî
        async function init() {
            // Ï†ÑÏó≠ Ìï®Ïàò Îì±Î°ù (onclick Ïù¥Î≤§Ìä∏ÏóêÏÑú Ï†ëÍ∑º Í∞ÄÎä•ÌïòÎèÑÎ°ù)
            window.togglePostReaction = togglePostReaction;
            window.toggleCommentReaction = toggleCommentReaction;
            window.replyToComment = replyToComment;
            window.addComment = addComment;
            window.submitReply = submitReply;
            window.cancelReply = cancelReply;
            window.editCurrentPost = editCurrentPost;
            window.deleteCurrentPost = deleteCurrentPost;
            window.confirmDeletePost = confirmDeletePost;
            window.cancelDeletePost = cancelDeletePost;
            window.updatePostActions = updatePostActions;
            window.removePostFile = removePostFile;
            window.openImageModal = openImageModal;
            window.closeImageModal = closeImageModal;
            // ÌÖåÏä§Ìä∏ Ìï®Ïàò Ï†úÍ±∞ - ÏΩòÏÜî Ïä§Ìå∏ Î∞©ÏßÄ
            
            // Ï†ÑÏó≠ Ìï®Ïàò Îì±Î°ù ÏôÑÎ£å
            
            // Í≤åÏãúÍ∏Ä Î°úÎìú
            await loadPosts();
            
            // Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÌååÏùº ÏóÖÎ°úÎìú Ï¥àÍ∏∞Ìôî
            initPostFileUpload();
            
            // Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú ÌôïÏù∏
            const token = localStorage.getItem('authToken');
            if (token) {
                try {
                    // ÌÜ†ÌÅ∞Ïù¥ ÏûàÏúºÎ©¥ ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥Î•º localStorageÏóêÏÑú Í∞ÄÏ†∏Ïò§Í±∞ÎÇò Í∏∞Î≥∏Í∞í ÏÑ§Ï†ï
                    const storedUser = localStorage.getItem('currentUser');
                    if (storedUser) {
                        currentUser = JSON.parse(storedUser);
                        console.log('ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ Î≥µÏõêÎê®:', currentUser);
                    } else {
                        console.warn('localStorageÏóê ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥Í∞Ä ÏóÜÏäµÎãàÎã§. Îã§Ïãú Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï† Ïàò ÏûàÏäµÎãàÎã§.');
                        // ÌÜ†ÌÅ∞Îßå ÏûàÍ≥† ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥Í∞Ä ÏóÜÎäî Í≤ΩÏö∞ ÌÜ†ÌÅ∞ Ï†úÍ±∞
                        localStorage.removeItem('authToken');
                        currentUser = null;
                    }
                    updateAuthUI();
                } catch (error) {
                    console.error('Login state check error:', error);
                    // ÌÜ†ÌÅ∞Ïù¥ Ïú†Ìö®ÌïòÏßÄ ÏïäÏúºÎ©¥ Ï†úÍ±∞
                    localStorage.removeItem('authToken');
                    localStorage.removeItem('currentUser');
                    currentUser = null;
                    updateAuthUI();
                }
            }
        }
        
        // ÌéòÏù¥ÏßÄ Ï†ÑÌôò
        function showPage(pageId, targetElement = null) {
            // Î™®Îì† ÌéòÏù¥ÏßÄ Ïà®Í∏∞Í∏∞
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // ÏÑ†ÌÉùÎêú ÌéòÏù¥ÏßÄ Î≥¥Ïù¥Í∏∞
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            } else {
                console.error('Page not found:', pageId);
                return;
            }
            
            // ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // targetElementÍ∞Ä Ï†ÑÎã¨ÎêòÎ©¥ ÌôúÏÑ±Ìôî, ÏïÑÎãàÎ©¥ pageIdÎ°ú Ï∞æÍ∏∞
            if (targetElement) {
                targetElement.classList.add('active');
            } else {
                // pageIdÏóê Ìï¥ÎãπÌïòÎäî nav-item Ï∞æÍ∏∞
                const navItems = document.querySelectorAll('.nav-item');
                navItems.forEach(item => {
                    const onclick = item.getAttribute('onclick');
                    if (onclick && onclick.includes(`'${pageId}'`)) {
                        item.classList.add('active');
                    }
                });
            }
            
            // ÌéòÏù¥ÏßÄ Ï†úÎ™© ÏóÖÎç∞Ïù¥Ìä∏
            const titles = {
                dashboard: 'ÎåÄÏãúÎ≥¥Îìú',
                login: 'Î°úÍ∑∏Ïù∏',
                register: 'ÌöåÏõêÍ∞ÄÏûÖ',
                posts: 'Í≤åÏãúÍ∏Ä Î™©Î°ù',
                'post-detail': 'Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏',
                'post-create': 'Í≤åÏãúÍ∏Ä ÏûëÏÑ±',
                'post-editor': 'ÏóêÎîîÌÑ∞Î°ú ÏûëÏÑ±',
                'file-upload': 'ÌååÏùº ÏóÖÎ°úÎìú ÌÖåÏä§Ìä∏',
                'editor-tiptap': 'Tiptap ÏóêÎîîÌÑ∞',
                'editor-novel': 'Novel ÏóêÎîîÌÑ∞',
                'editor-quill': 'ReactQuill ÏóêÎîîÌÑ∞'
            };
            
            const subtitles = {
                dashboard: 'API Í∞úÎ∞ú ÌòÑÌô© Î∞è ÌÖåÏä§Ìä∏',
                login: 'Í≥ÑÏ†ïÏóê Î°úÍ∑∏Ïù∏ÌïòÏÑ∏Ïöî',
                register: 'ÏÉà Í≥ÑÏ†ïÏùÑ ÎßåÎìúÏÑ∏Ïöî',
                posts: 'Î™®Îì† Í≤åÏãúÍ∏ÄÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî',
                'post-detail': 'Í≤åÏãúÍ∏Ä ÎÇ¥Ïö© Î∞è ÎåìÍ∏Ä',
                'post-create': 'ÏÉàÎ°úÏö¥ Í≤åÏãúÍ∏ÄÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî',
                'post-editor': 'Ìñ•ÏÉÅÎêú Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞Î°ú Î©ãÏßÑ Í≤åÏãúÍ∏Ä ÏûëÏÑ±',
                'file-upload': 'ÌååÏùº Í¥ÄÎ¶¨ API (Task 1-6) ÌÜµÌï© ÌÖåÏä§Ìä∏',
                'editor-tiptap': 'Tiptap Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞Î°ú Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÌÖåÏä§Ìä∏',
                'editor-novel': 'Novel AI Í∏∞Î∞ò Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞Î°ú Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÌÖåÏä§Ìä∏',
                'editor-quill': 'ReactQuill ÏóêÎîîÌÑ∞Î°ú Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÌÖåÏä§Ìä∏'
            };
            
            // ÌéòÏù¥ÏßÄ Ï†úÎ™© ÏöîÏÜå null Ï≤¥ÌÅ¨
            const titleElement = document.getElementById('pageTitle');
            const subtitleElement = document.getElementById('pageSubtitle');
            
            if (titleElement) {
                titleElement.textContent = titles[pageId] || '';
            }
            
            if (subtitleElement) {
                subtitleElement.textContent = subtitles[pageId] || '';
            }
            
            // ÌäπÏ†ï ÌéòÏù¥ÏßÄÏóê ÎåÄÌïú Ï∂îÍ∞Ä Î°úÏßÅ
            if (pageId === 'posts') {
                // Í≤åÏãúÍ∏Ä Î™©Î°ù ÌéòÏù¥ÏßÄ ÌëúÏãú Ïãú Í≤åÏãúÍ∏Ä Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®
                // Ìï≠ÏÉÅ ÏµúÏã† Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÏ†∏Ïò§ÎèÑÎ°ù Í∞ïÏ†ú
                loadPosts();
            }
        }
        
        // Ïù∏Ï¶ù Í¥ÄÎ†®
        async function handleLogin(event) {
            event.preventDefault();
            const btn = document.getElementById('loginBtn');
            const form = event.target;
            const formData = new FormData(form);
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> Î°úÍ∑∏Ïù∏ Ï§ë...';
            
            try {
                const email = formData.get('email');
                const password = formData.get('password');
                
                if (!email || !password) {
                    throw new Error('Ïù¥Î©îÏùºÍ≥º ÎπÑÎ∞ÄÎ≤àÌò∏Î•º Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                }
                
                // Ïã§Ï†ú API Ìò∏Ï∂ú (OAuth2 FormData ÌòïÏãù)
                const loginFormData = new FormData();
                loginFormData.append('username', email);  // OAuth2ÏóêÏÑúÎäî username ÌïÑÎìú ÏÇ¨Ïö©
                loginFormData.append('password', password);
                
                const response = await fetch(`${API_BASE_URL}/auth/login`, {
                    method: 'POST',
                    body: loginFormData  // FormDataÎäî Content-Type Ìó§ÎçîÎ•º ÏûêÎèôÏúºÎ°ú ÏÑ§Ï†ï
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ
                    if (data.access_token) {
                        localStorage.setItem('authToken', data.access_token);
                        currentUser = data.user || { email: email, display_name: email.split('@')[0] };
                        
                        // ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ÎèÑ localStorageÏóê Ï†ÄÏû•
                        localStorage.setItem('currentUser', JSON.stringify(currentUser));
                        
                        updateAuthUI();
                        showNotification('Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ!', 'success');
                        showPage('dashboard');
                    } else {
                        throw new Error('ÌÜ†ÌÅ∞ÏùÑ Î∞õÏßÄ Î™ªÌñàÏäµÎãàÎã§.');
                    }
                } else {
                    throw new Error(data.detail || 'Î°úÍ∑∏Ïù∏Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                }
            } catch (error) {
                showNotification(error.message, 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Î°úÍ∑∏Ïù∏';
            }
        }
        
        async function handleRegister(event) {
            event.preventDefault();
            const btn = document.getElementById('registerBtn');
            const form = event.target;
            const formData = new FormData(form);
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> Í∞ÄÏûÖ Ï§ë...';
            
            try {
                // ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏
                if (formData.get('password') !== formData.get('confirm_password')) {
                    throw new Error('ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§.');
                }
                
                const email = formData.get('email');
                const userHandle = formData.get('user_handle');
                const displayName = formData.get('display_name');
                const password = formData.get('password');
                
                if (!email || !userHandle || !password) {
                    throw new Error('ÌïÑÏàò Ï†ïÎ≥¥Î•º Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                }
                
                // Ïã§Ï†ú API Ìò∏Ï∂ú
                const registerData = {
                    email: email,
                    user_handle: userHandle,
                    password: password
                };
                
                // display_nameÏù¥ ÏûàÏúºÎ©¥ Ï∂îÍ∞Ä
                if (displayName && displayName.trim()) {
                    registerData.display_name = displayName.trim();
                }
                
                const response = await fetch(`${API_BASE_URL}/auth/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(registerData)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showNotification('ÌöåÏõêÍ∞ÄÏûÖ ÏôÑÎ£å! Î°úÍ∑∏Ïù∏Ìï¥Ï£ºÏÑ∏Ïöî.', 'success');
                    showPage('login');
                } else {
                    throw new Error(data.detail || 'ÌöåÏõêÍ∞ÄÏûÖÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                }
            } catch (error) {
                showNotification(error.message, 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'ÌöåÏõêÍ∞ÄÏûÖ';
            }
        }
        
        function logout() {
            localStorage.removeItem('authToken');
            localStorage.removeItem('currentUser');
            currentUser = null;
            updateAuthUI();
            showNotification('Î°úÍ∑∏ÏïÑÏõÉÎêòÏóàÏäµÎãàÎã§.', 'success');
            showPage('login');
        }
        
        function updateAuthUI() {
            try {
                const authUser = document.getElementById('authUser');
                const logoutBtn = document.querySelector('.btn-logout');
                
                if (!authUser || !logoutBtn) {
                    console.error('Auth UI elements not found');
                    return;
                }
                
                if (currentUser) {
                    const displayText = currentUser.display_name || currentUser.email || 'User';
                    authUser.textContent = `üë§ ${displayText}`;
                    authUser.style.display = 'block';
                    logoutBtn.style.display = 'block';
                } else {
                    authUser.style.display = 'none';
                    logoutBtn.style.display = 'none';
                }
            } catch (error) {
                console.error('Error updating auth UI:', error);
            }
        }
        
        // Í≤åÏãúÍ∏Ä Í¥ÄÎ†®
        function renderPosts() {
            const postsList = document.getElementById('postsList');
            if (!postsList) return;
            
            postsList.innerHTML = posts.map(post => {
                const tags = post.metadata?.tags || [];
                const type = post.metadata?.type || '';
                
                return `
                    <div class="post-card" onclick="showPostDetail('${post.slug || post.id}')">
                        <div class="post-meta">
                            <span class="post-type">${type}</span>
                            <span>‚Ä¢</span>
                            <span>ÏûëÏÑ±Ïûê: ${post.author_id || 'Unknown'}</span>
                            <span>‚Ä¢</span>
                            <span>${formatDate(post.created_at)}</span>
                        </div>
                        <div class="post-title">${post.title}</div>
                        <div class="post-stats" style="display: flex; align-items: center; justify-content: space-between; margin-top: 10px;">
                            <div style="display: flex; gap: 15px;">
                                <span style="color: #6b7280;">üëÅ ${(post.stats?.view_count || post.view_count) || 0}</span>
                                <span style="color: #6b7280;">üí¨ ${(post.stats?.comment_count || post.comment_count) || 0}</span>
                                ${tags.length > 0 ? `<span style="color: #6b7280;">üè∑Ô∏è ${tags.join(', ')}</span>` : ''}
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="event.stopPropagation(); togglePostReaction('${post.slug || post.id}', 'like')" 
                                        style="background: none; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; cursor: pointer; display: flex; align-items: center; gap: 4px; font-size: 0.8em;">
                                    üëç ${(post.stats?.like_count || post.like_count) || 0}
                                </button>
                                <button onclick="event.stopPropagation(); togglePostReaction('${post.slug || post.id}', 'dislike')" 
                                        style="background: none; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; cursor: pointer; display: flex; align-items: center; gap: 4px; font-size: 0.8em;">
                                    üëé ${(post.stats?.dislike_count || post.dislike_count) || 0}
                                </button>
                                <button onclick="event.stopPropagation(); togglePostReaction('${post.slug || post.id}', 'bookmark')" 
                                        style="background: none; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; cursor: pointer; display: flex; align-items: center; gap: 4px; font-size: 0.8em;">
                                    üîñ ${(post.stats?.bookmark_count || post.bookmark_count) || 0}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        async function showPostDetail(postSlugOrId) {
            console.log('Showing post detail for:', postSlugOrId);
            
            try {
                // APIÏóêÏÑú ÏµúÏã† Í≤åÏãúÍ∏Ä Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ (Ï°∞ÌöåÏàò Ï¶ùÍ∞Ä Ìè¨Ìï®)
                const response = await apiCall(`/api/posts/${postSlugOrId}`);
                console.log('Post detail API response:', response);
                
                const post = response;
                
                // Í≤åÏãúÍ∏Ä Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• (ÎåìÍ∏Ä Îì±ÏóêÏÑú ÏÇ¨Ïö©)
                window.currentPost = post;
                currentPost = post; // Ï†ÑÏó≠ Î≥ÄÏàòÎèÑ ÏÑ§Ï†ï
                
                // Ï∫êÏãúÏóê ÏµúÏã† Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
                const key = post.slug || post._id || post.id;
                postsCache.set(key, post)
            
            console.log('Current post set:', currentPost);
            
            // ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄ ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('postDetailTitle').textContent = post.title;
            document.getElementById('postDetailContent').innerHTML = `<p>${post.content}</p>`;
            
            // Ï≤®Î∂Ä ÌååÏùº ÌëúÏãú
            console.log('=== showPostDetailÏóêÏÑú Ï≤®Î∂Ä ÌååÏùº Ï≤òÎ¶¨ ===');
            console.log('Í≤åÏãúÍ∏Ä Í∞ùÏ≤¥:', post);
            console.log('ÌååÏùº IDs:', post.file_ids || post.metadata?.file_ids);
            
            // API Î™ÖÏÑ∏Ïóê Îî∞Îùº file_ids ÏÇ¨Ïö©
            const fileIds = post.file_ids || post.metadata?.file_ids || [];
            await displayPostAttachments(fileIds);
            
            // Î©îÌÉÄ Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
            const detailMeta = document.querySelector('.post-detail-meta');
            detailMeta.innerHTML = `
                <span class="post-type">${post.metadata?.type || ''}</span>
                <span>‚Ä¢</span>
                <span>ÏûëÏÑ±Ïûê: ${post.author_id || 'Unknown'}</span>
                <span>‚Ä¢</span>
                <span>${formatDate(post.created_at)}</span>
            `;
            
            // ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏ (stats Í∞ùÏ≤¥Í∞Ä ÏûàÏúºÎ©¥ ÏÇ¨Ïö©, ÏóÜÏúºÎ©¥ ÏßÅÏ†ë ÌïÑÎìú ÏÇ¨Ïö©)
            document.getElementById('likeCount').textContent = (post.stats?.like_count || post.like_count) || 0;
            document.getElementById('dislikeCount').textContent = (post.stats?.dislike_count || post.dislike_count) || 0;
            document.getElementById('bookmarkCount').textContent = (post.stats?.bookmark_count || post.bookmark_count) || 0;
            
                // ÌéòÏù¥ÏßÄ Ï†ÑÌôò
                showPage('post-detail');
                
                // ÏûëÏÑ±Ïûê Í∂åÌïú Ï≤¥ÌÅ¨ Î∞è ÏàòÏ†ï/ÏÇ≠Ï†ú Î≤ÑÌäº ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
                setTimeout(() => {
                    updatePostActions();
                }, 100);
                
                // ÎåìÍ∏Ä Ï¥àÍ∏∞Ìôî Î∞è Î°úÎìú
                comments = []; // Ïù¥Ï†Ñ ÎåìÍ∏Ä Îç∞Ïù¥ÌÑ∞ ÌÅ¥Î¶¨Ïñ¥
                await loadComments(post.slug);
                
            } catch (error) {
                console.error('Failed to load post detail:', error);
                showNotification('Í≤åÏãúÍ∏ÄÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                showPage('posts');
            }
        }
        
        async function handleCreatePost(event) {
            event.preventDefault();
            
            // Debug token status
            const token = localStorage.getItem('authToken');
            console.log('Create post - Token exists:', !!token);
            console.log('Create post - Current user:', currentUser);
            
            if (!currentUser || !token) {
                showNotification('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.', 'error');
                showPage('login');
                return;
            }
            
            const btn = document.getElementById('createPostBtn');
            const form = event.target;
            const formData = new FormData(form);
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> ÏûëÏÑ± Ï§ë...';
            
            try {
                // Î®ºÏ†Ä ÌååÏùºÎì§ÏùÑ ÏóÖÎ°úÎìú
                const fileIds = [];
                if (postUploadedFiles.length > 0) {
                    console.log('Ï≤®Î∂Ä ÌååÏùº ÏóÖÎ°úÎìú ÏãúÏûë:', postUploadedFiles);
                    btn.innerHTML = '<span class="loading"></span> ÌååÏùº ÏóÖÎ°úÎìú Ï§ë...';
                    
                    for (const file of postUploadedFiles) {
                        try {
                            // ÌååÏùº ÏóÖÎ°úÎìú API Ìò∏Ï∂ú
                            const uploadFormData = new FormData();
                            uploadFormData.append('file', file);
                            uploadFormData.append('attachment_type', 'post');
                            
                            const uploadResponse = await fetch(`${API_BASE_URL}/api/files/upload`, {
                                method: 'POST',
                                headers: {
                                    'Authorization': `Bearer ${token}`
                                },
                                body: uploadFormData
                            });
                            
                            if (uploadResponse.ok) {
                                const uploadResult = await uploadResponse.json();
                                console.log('ÌååÏùº ÏóÖÎ°úÎìú ÏÑ±Í≥µ:', uploadResult);
                                fileIds.push(uploadResult.file_id);
                            } else {
                                const errorText = await uploadResponse.text();
                                console.error('ÌååÏùº ÏóÖÎ°úÎìú Ïã§Ìå® - ÏÉÅÌÉú:', uploadResponse.status);
                                console.error('ÌååÏùº ÏóÖÎ°úÎìú Ïã§Ìå® - ÏùëÎãµ:', errorText);
                                throw new Error(`ÌååÏùº ÏóÖÎ°úÎìú Ïã§Ìå®: ${uploadResponse.status}`);
                            }
                        } catch (error) {
                            console.error('ÌååÏùº ÏóÖÎ°úÎìú Ïò§Î•ò:', error);
                            // APIÍ∞Ä ÏóÜÎäî Í≤ΩÏö∞ Î™®Ïùò Ï≤òÎ¶¨
                            const mockFileId = `mock_file_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                            fileIds.push(mockFileId);
                            
                            // Î™®Ïùò ÌôòÍ≤ΩÏóêÏÑúÎäî Data URLÏùÑ localStorageÏóê Ï†ÄÏû• (ÌÖåÏä§Ìä∏Ïö©)
                            await new Promise((resolve) => {
                                const reader = new FileReader();
                                reader.onload = (e) => {
                                    const fileData = {
                                        file_id: mockFileId,
                                        original_filename: file.name,
                                        file_size: file.size,
                                        file_type: file.type,
                                        file_url: e.target.result,
                                        created_at: new Date().toISOString()
                                    };
                                    localStorage.setItem(`file_${mockFileId}`, JSON.stringify(fileData));
                                    console.log('Î™®Ïùò ÌååÏùº Ï†ÄÏû•Îê®:', mockFileId, fileData.original_filename);
                                    resolve();
                                };
                                reader.readAsDataURL(file);
                            });
                        }
                    }
                    
                    console.log('ÏóÖÎ°úÎìúÎêú ÌååÏùº IDs:', fileIds);
                }
                
                btn.innerHTML = '<span class="loading"></span> Í≤åÏãúÍ∏Ä ÏûëÏÑ± Ï§ë...';
                
                const postData = {
                    title: formData.get('title'),
                    content: formData.get('content'),
                    service: formData.get('service'),
                    metadata: {
                        type: formData.get('type'),
                        tags: formData.get('tags') ? formData.get('tags').split(',').map(tag => tag.trim().slice(0, 10)).slice(0, 3) : [],
                        visibility: 'public',
                        file_ids: fileIds // API Î™ÖÏÑ∏Ïóê Îî∞Îùº file_ids ÏÇ¨Ïö©
                    }
                };
                
                console.log('Sending post data:', postData);
                
                const newPost = await createPost(postData);
                
                // ÏÑ±Í≥µ Ïãú ÌååÏùº Î™©Î°ù Ï¥àÍ∏∞Ìôî
                postUploadedFiles = [];
                updatePostFileList();
                form.reset();
                
                // ÏÉàÎ°ú ÏûëÏÑ±Îêú Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
                if (newPost && (newPost.slug || newPost.id)) {
                    await showPostDetail(newPost.slug || newPost.id);
                } else {
                    showPage('posts');
                }
            } catch (error) {
                showNotification(error.message, 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Í≤åÏãúÍ∏Ä ÏûëÏÑ±';
            }
        }
        
        // ÎåìÍ∏Ä Í¥ÄÎ†®
        async function loadComments(postSlug) {
            console.log('Loading comments for post:', postSlug);
            if (!postSlug) {
                console.warn('No post slug provided for loading comments');
                return;
            }
            
            try {
                const response = await apiCall(`/api/posts/${postSlug}/comments`);
                console.log('Comments loaded:', response);
                comments = response.comments || [];
                renderComments();
            } catch (error) {
                console.error('Failed to load comments:', error);
                comments = [];
                renderComments();
                showNotification('ÎåìÍ∏ÄÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        }

        function renderComments() {
            console.log('Rendering comments:', comments);
            const commentsList = document.getElementById('commentsList');
            if (!commentsList) {
                console.warn('commentsList element not found');
                return;
            }
            
            if (comments.length === 0) {
                commentsList.innerHTML = '<div class="no-comments">Ï≤´ Î≤àÏß∏ ÎåìÍ∏ÄÏùÑ ÏûëÏÑ±Ìï¥Î≥¥ÏÑ∏Ïöî!</div>';
            } else {
                commentsList.innerHTML = comments.map(comment => {
                    const commentId = comment._id || comment.id;
                    console.log('Rendering comment with ID:', commentId, 'Replies:', comment.replies);
                    
                    // ÎãµÍ∏Ä Î†åÎçîÎßÅ
                    let repliesHtml = '';
                    if (comment.replies && comment.replies.length > 0) {
                        repliesHtml = `
                            <div class="replies-container">
                                ${comment.replies.map(reply => {
                                    const replyId = reply._id || reply.id;
                                    return `
                                        <div class="reply-item" data-comment-id="${replyId}">
                                            <div class="reply-author">${reply.author_id}</div>
                                            <div class="reply-content">${reply.content}</div>
                                            <div class="reply-meta">
                                                <span>${formatDate(reply.created_at)}</span>
                                                <span class="comment-like-btn" onclick="try{ toggleCommentReaction('${replyId}', 'like'); }catch(e){ console.error('Like error:', e); }" style="cursor: pointer;">üëç ${reply.like_count || 0}</span>
                                                <span class="comment-dislike-btn" onclick="try{ toggleCommentReaction('${replyId}', 'dislike'); }catch(e){ console.error('Dislike error:', e); }" style="cursor: pointer;">üëé ${reply.dislike_count || 0}</span>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        `;
                    }
                    
                    return `
                    <div class="comment-item" data-comment-id="${commentId}">
                        <div class="comment-author">${comment.author_id}</div>
                        <div class="comment-content">${comment.content}</div>
                        <div class="comment-meta">
                            <span>${formatDate(comment.created_at)}</span>
                            <span class="comment-like-btn" onclick="try{ toggleCommentReaction('${commentId}', 'like'); }catch(e){ console.error('Like error:', e); }" style="cursor: pointer;">üëç ${comment.like_count || 0}</span>
                            <span class="comment-dislike-btn" onclick="try{ toggleCommentReaction('${commentId}', 'dislike'); }catch(e){ console.error('Dislike error:', e); }" style="cursor: pointer;">üëé ${comment.dislike_count || 0}</span>
                            <span style="cursor: pointer;" onclick="try{ replyToComment('${commentId}'); }catch(e){ console.error('Reply error:', e); }">ÎãµÍ∏Ä (${comment.reply_count || 0})</span>
                        </div>
                        ${repliesHtml}
                    </div>
                `;
                }).join('');
            }
            
            const commentCountElement = document.getElementById('commentCount');
            if (commentCountElement) {
                commentCountElement.textContent = comments.length;
            }
            
            console.log('Comments rendered, count:', comments.length);
        }
        
        async function addComment() {
            console.log('Adding comment...');
            console.log('Current user:', currentUser);
            console.log('Current post:', currentPost);
            
            if (!currentUser) {
                showNotification('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.', 'error');
                showPage('login');
                return;
            }
            
            if (!currentPost) {
                showNotification('Í≤åÏãúÍ∏Ä Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }
            
            const textarea = document.getElementById('commentTextarea');
            if (!textarea) {
                console.error('Comment textarea not found');
                showNotification('ÎåìÍ∏Ä ÏûÖÎ†•Ï∞ΩÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }
            
            const content = textarea.value.trim();
            console.log('Comment content:', content);
            
            if (!content) {
                showNotification('ÎåìÍ∏Ä ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
                return;
            }
            
            try {
                console.log('Sending comment to API...');
                const response = await apiCall(`/api/posts/${currentPost.slug}/comments`, {
                    method: 'POST',
                    body: JSON.stringify({ content: content })
                });
                
                console.log('Comment created:', response);
                
                // ÎåìÍ∏Ä Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®
                await loadComments(currentPost.slug);
                textarea.value = '';
                
                showNotification('ÎåìÍ∏ÄÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§!', 'success');
            } catch (error) {
                console.error('Failed to add comment:', error);
                showNotification(error.message || 'ÎåìÍ∏Ä Ï∂îÍ∞ÄÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        }

        // Í≤åÏãúÍ∏Ä Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Í∏∞Îä•
        async function togglePostReaction(postSlug, type) {
            console.log('Toggle post reaction:', postSlug, type);
            
            if (!currentUser) {
                showNotification('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.', 'error');
                showPage('login');
                return;
            }
            
            try {
                // Ïã§Ï†ú API Ìò∏Ï∂ú
                const endpoint = type === 'like' ? 'like' : 'dislike';
                const response = await apiCall(`/api/posts/${postSlug}/${endpoint}`, {
                    method: 'POST'
                });
                
                console.log('Post reaction API response:', response);
                
                // Í≤åÏãúÍ∏Ä Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®ÌïòÏó¨ ÏµúÏã† ÏÉÅÌÉú Î∞òÏòÅ
                await loadPosts();
                
                showNotification(`Í≤åÏãúÍ∏ÄÏóê ${type === 'like' ? 'Ï¢ãÏïÑÏöî' : 'Ïã´Ïñ¥Ïöî'}Î•º ÎàåÎ†ÄÏäµÎãàÎã§.`, 'success');
                
            } catch (error) {
                console.error('Failed to toggle post reaction:', error);
                showNotification(error.message || 'Î∞òÏùë Ï≤òÎ¶¨Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        }

        // ÎåìÍ∏Ä Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Í∏∞Îä•
        async function toggleCommentReaction(commentId, type) {
            console.log('Toggle comment reaction:', commentId, type);
            
            if (!currentUser) {
                showNotification('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.', 'error');
                showPage('login');
                return;
            }
            
            if (!currentPost) {
                showNotification('Í≤åÏãúÍ∏Ä Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }
            
            try {
                // Ïã§Ï†ú API Ìò∏Ï∂ú
                const endpoint = type === 'like' ? 'like' : 'dislike';
                const response = await apiCall(`/api/posts/${currentPost.slug}/comments/${commentId}/${endpoint}`, {
                    method: 'POST'
                });
                
                console.log('Reaction API response:', response);
                
                // ÎåìÍ∏Ä Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®ÌïòÏó¨ ÏµúÏã† ÏÉÅÌÉú Î∞òÏòÅ
                await loadComments(currentPost.slug);
                
                showNotification(`ÎåìÍ∏ÄÏóê ${type === 'like' ? 'Ï¢ãÏïÑÏöî' : 'Ïã´Ïñ¥Ïöî'}Î•º ÎàåÎ†ÄÏäµÎãàÎã§.`, 'success');
                
            } catch (error) {
                console.error('Failed to toggle comment reaction:', error);
                showNotification(error.message || 'Î∞òÏùë Ï≤òÎ¶¨Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        }

        // ÎåìÍ∏Ä ÎãµÍ∏Ä Í∏∞Îä•
        function replyToComment(commentId) {
            console.log('Reply to comment:', commentId);
            
            if (!currentUser) {
                showNotification('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.', 'error');
                showPage('login');
                return;
            }
            
            // Í∏∞Ï°¥ ÎãµÍ∏Ä ÌèºÏù¥ ÏûàÏúºÎ©¥ Ï†úÍ±∞
            const existingReplyForm = document.querySelector('.reply-form');
            if (existingReplyForm) {
                existingReplyForm.remove();
            }
            
            // Ìï¥Îãπ ÎåìÍ∏Ä Ï∞æÍ∏∞
            const commentElement = document.querySelector(`[data-comment-id="${commentId}"]`);
            if (!commentElement) {
                console.error('Comment element not found for ID:', commentId);
                return;
            }
            
            // ÎãµÍ∏Ä ÏûÖÎ†• Ìèº ÏÉùÏÑ±
            const replyForm = document.createElement('div');
            replyForm.className = 'reply-form';
            replyForm.innerHTML = `
                <div class="reply-form-content">
                    <textarea class="reply-textarea" placeholder="ÎãµÍ∏ÄÏùÑ ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî..." rows="3"></textarea>
                    <div class="reply-actions">
                        <button class="btn-reply-submit" onclick="submitReply('${commentId}')">ÎãµÍ∏Ä ÏûëÏÑ±</button>
                        <button class="btn-reply-cancel" onclick="cancelReply()">Ï∑®ÏÜå</button>
                    </div>
                </div>
            `;
            
            // ÎåìÍ∏Ä ÏïÑÎûòÏóê ÎãµÍ∏Ä Ìèº Ï∂îÍ∞Ä
            commentElement.appendChild(replyForm);
            
            // ÎãµÍ∏Ä ÏûÖÎ†•Ï∞ΩÏóê Ìè¨Ïª§Ïä§
            const textarea = replyForm.querySelector('.reply-textarea');
            textarea.focus();
        }
        
        // ÎãµÍ∏Ä ÏûëÏÑ± Ï†úÏ∂ú
        async function submitReply(parentCommentId) {
            console.log('Submit reply to comment:', parentCommentId);
            
            const replyForm = document.querySelector('.reply-form');
            if (!replyForm) return;
            
            const textarea = replyForm.querySelector('.reply-textarea');
            const content = textarea.value.trim();
            
            if (!content) {
                showNotification('ÎãµÍ∏Ä ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
                return;
            }
            
            try {
                console.log('Sending reply to API...');
                const response = await apiCall(`/api/posts/${currentPost.slug}/comments/${parentCommentId}/replies`, {
                    method: 'POST',
                    body: JSON.stringify({ content: content })
                });
                
                console.log('Reply created:', response);
                
                // ÎãµÍ∏Ä Ìèº Ï†úÍ±∞
                replyForm.remove();
                
                // ÎåìÍ∏Ä Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®
                await loadComments(currentPost.slug);
                
                showNotification('ÎãµÍ∏ÄÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§!', 'success');
                
            } catch (error) {
                console.error('Failed to submit reply:', error);
                showNotification(error.message || 'ÎãµÍ∏Ä ÏûëÏÑ±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        }
        
        // ÎãµÍ∏Ä ÏûëÏÑ± Ï∑®ÏÜå
        function cancelReply() {
            const replyForm = document.querySelector('.reply-form');
            if (replyForm) {
                replyForm.remove();
            }
        }

        
        // Î∞òÏùë Í¥ÄÎ†®
        async function toggleReaction(type) {
            if (!currentUser) {
                showNotification('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.', 'error');
                showPage('login');
                return;
            }
            
            if (!currentPost) {
                showNotification('Í≤åÏãúÍ∏Ä Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }
            
            try {
                // Ïã§Ï†ú API Ìò∏Ï∂ú
                const endpoint = type === 'like' ? 'like' : type === 'dislike' ? 'dislike' : 'bookmark';
                const response = await apiCall(`/api/posts/${currentPost.slug}/${endpoint}`, {
                    method: 'POST'
                });
                
                console.log('Post detail reaction API response:', response);
                
                // UI ÏóÖÎç∞Ïù¥Ìä∏
                const countElement = document.getElementById(type + 'Count');
                if (type === 'like') {
                    countElement.textContent = response.like_count;
                    document.getElementById('likeCount').textContent = response.like_count;
                    document.getElementById('dislikeCount').textContent = response.dislike_count;
                } else if (type === 'dislike') {
                    countElement.textContent = response.dislike_count;
                    document.getElementById('likeCount').textContent = response.like_count;
                    document.getElementById('dislikeCount').textContent = response.dislike_count;
                } else if (type === 'bookmark') {
                    countElement.textContent = response.bookmark_count;
                }
                
                // Î≤ÑÌäº Ïä§ÌÉÄÏùº ÏóÖÎç∞Ïù¥Ìä∏
                const likeBtn = document.getElementById('likeCount').closest('.reaction-btn');
                const dislikeBtn = document.getElementById('dislikeCount').closest('.reaction-btn');
                const bookmarkBtn = document.getElementById('bookmarkCount').closest('.reaction-btn');
                
                // Like/Dislike Î≤ÑÌäº Ïä§ÌÉÄÏùº ÏóÖÎç∞Ïù¥Ìä∏ (user_reactionÏù¥ ÏûàÎäî Í≤ΩÏö∞ÏóêÎßå)
                if (response.user_reaction) {
                    if (response.user_reaction.liked) {
                        likeBtn.classList.add('active');
                    } else {
                        likeBtn.classList.remove('active');
                    }
                    
                    if (response.user_reaction.disliked) {
                        dislikeBtn.classList.add('active');
                    } else {
                        dislikeBtn.classList.remove('active');
                    }
                    
                    if (response.user_reaction.bookmarked) {
                        bookmarkBtn.classList.add('active');
                    } else {
                        bookmarkBtn.classList.remove('active');
                    }
                }
                
                let message = '';
                if (type === 'like') {
                    message = `Í≤åÏãúÍ∏ÄÏóê Ï¢ãÏïÑÏöîÎ•º ÎàåÎ†ÄÏäµÎãàÎã§.`;
                } else if (type === 'dislike') {
                    message = `Í≤åÏãúÍ∏ÄÏóê Ïã´Ïñ¥ÏöîÎ•º ÎàåÎ†ÄÏäµÎãàÎã§.`;
                } else if (type === 'bookmark') {
                    message = response.action === 'bookmarked' ? 'Î∂ÅÎßàÌÅ¨Ïóê Ï∂îÍ∞ÄÌñàÏäµÎãàÎã§.' : 'Î∂ÅÎßàÌÅ¨Î•º Ï†úÍ±∞ÌñàÏäµÎãàÎã§.';
                }
                showNotification(message, 'success');
                
            } catch (error) {
                console.error('Failed to toggle reaction:', error);
                showNotification(error.message || 'Î∞òÏùë Ï≤òÎ¶¨Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        }
        
        // ÏÑúÎπÑÏä§Î≥Ñ ÌÉÄÏûÖ ÏóÖÎç∞Ïù¥Ìä∏
        function updateTypeFilter() {
            const serviceFilter = document.getElementById('serviceFilter');
            const typeFilter = document.getElementById('typeFilter');
            const selectedService = serviceFilter.value;
            
            // ÌÉÄÏûÖ ÏòµÏÖò Ï¥àÍ∏∞Ìôî
            typeFilter.innerHTML = '<option value="">Ï†ÑÏ≤¥</option>';
            
            // ÏÑ†ÌÉùÎêú ÏÑúÎπÑÏä§Ïùò ÌÉÄÏûÖÎì§ Ï∂îÍ∞Ä
            if (selectedService && serviceTypes[selectedService]) {
                serviceTypes[selectedService].forEach(type => {
                    const option = document.createElement('option');
                    option.value = type;
                    option.textContent = type;
                    typeFilter.appendChild(option);
                });
            }
            
            // ÌïÑÌÑ∞ Ï†ÅÏö©
            filterPosts();
        }
        
        // Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÌèºÏùò ÌÉÄÏûÖ ÏóÖÎç∞Ïù¥Ìä∏
        function updateCreatePostType() {
            const serviceSelect = document.getElementById('createPostService');
            const typeSelect = document.getElementById('createPostType');
            const selectedService = serviceSelect.value;
            
            // ÌÉÄÏûÖ ÏòµÏÖò Ï¥àÍ∏∞Ìôî
            typeSelect.innerHTML = '';
            
            // ÏÑ†ÌÉùÎêú ÏÑúÎπÑÏä§Ïùò ÌÉÄÏûÖÎì§ Ï∂îÍ∞Ä
            if (selectedService && serviceTypes[selectedService]) {
                serviceTypes[selectedService].forEach(type => {
                    const option = document.createElement('option');
                    option.value = type;
                    option.textContent = type;
                    typeSelect.appendChild(option);
                });
            }
        }
        
        // ÌïÑÌÑ∞ÎßÅ Î∞è Í≤ÄÏÉâ
        function filterPosts() {
            const serviceFilter = document.getElementById('serviceFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            const searchInput = document.getElementById('searchInput');
            const searchQuery = searchInput ? searchInput.value.trim() : '';
            
            // Ï†ÑÏ≤¥ posts Îç∞Ïù¥ÌÑ∞ÏóêÏÑú ÌïÑÌÑ∞ÎßÅ ÏãúÏûë (API Î°úÎìúÎêú Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©)
            let filteredPosts = [...(window.allPosts || posts)];
            
            // ÏÑúÎπÑÏä§ ÌïÑÌÑ∞
            if (serviceFilter) {
                filteredPosts = filteredPosts.filter(post => post.service === serviceFilter);
            }
            
            // ÌÉÄÏûÖ ÌïÑÌÑ∞
            if (typeFilter) {
                filteredPosts = filteredPosts.filter(post => post.metadata?.type === typeFilter);
            }
            
            // Í≤ÄÏÉâÏñ¥ ÌïÑÌÑ∞
            if (searchQuery) {
                filteredPosts = filteredPosts.filter(post => 
                    post.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                    post.content.toLowerCase().includes(searchQuery.toLowerCase()) ||
                    (post.metadata?.tags || []).some(tag => tag.toLowerCase().includes(searchQuery.toLowerCase()))
                );
            }
            
            posts = filteredPosts;
            renderPosts();
        }
        
        function sortPosts() {
            const select = event.target;
            const sortBy = select.value;
            
            posts.sort((a, b) => {
                if (sortBy === 'created_at') {
                    return new Date(b.created_at) - new Date(a.created_at);
                } else if (sortBy === 'views') {
                    return ((b.stats?.view_count || b.view_count) || 0) - ((a.stats?.view_count || a.view_count) || 0);
                } else if (sortBy === 'likes') {
                    return ((b.stats?.like_count || b.like_count) || 0) - ((a.stats?.like_count || a.like_count) || 0);
                }
                return 0;
            });
            
            renderPosts();
        }
        
        function searchPosts(query) {
            const serviceFilter = document.getElementById('serviceFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            
            // APIÏóêÏÑú Î°úÎìúÎêú posts Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö© (mockPosts ÎåÄÏã†)
            let filteredPosts = [...posts];
            
            // Î®ºÏ†Ä ÏÑúÎπÑÏä§/ÌÉÄÏûÖ ÌïÑÌÑ∞ Ï†ÅÏö©
            if (serviceFilter) {
                filteredPosts = filteredPosts.filter(post => post.service === serviceFilter);
            }
            if (typeFilter) {
                filteredPosts = filteredPosts.filter(post => post.metadata?.type === typeFilter);
            }
            
            // Í≤ÄÏÉâÏñ¥ ÌïÑÌÑ∞ (Ï†úÎ™©Í≥º ÎÇ¥Ïö©Ïóê ÎåÄÌï¥ÏÑúÎßå)
            if (query.trim()) {
                filteredPosts = filteredPosts.filter(post => 
                    post.title.toLowerCase().includes(query.toLowerCase()) ||
                    post.content.toLowerCase().includes(query.toLowerCase()) ||
                    (post.metadata?.tags || []).some(tag => tag.toLowerCase().includes(query.toLowerCase()))
                );
            }
            
            // Í≤ÄÏÉâ Í≤∞Í≥ºÎ•º postsÏóê Ìï†ÎãπÌïòÏó¨ Î†åÎçîÎßÅ
            const originalPosts = [...posts]; // ÏõêÎ≥∏ Îç∞Ïù¥ÌÑ∞ Î∞±ÏóÖ
            posts = filteredPosts;
            renderPosts();
            
            // Í≤ÄÏÉâÏù¥ ÎÅùÎÇòÍ≥† Îã§Ïãú ÏõêÎ≥∏ Îç∞Ïù¥ÌÑ∞Î°ú Î≥µÏõêÌïòÏßÄ ÏïäÏùå (ÏÇ¨Ïö©ÏûêÍ∞Ä ÌïÑÌÑ∞Î•º Ìï¥Ï†úÌï† ÎïåÍπåÏßÄ)
        }
        
        // API ÌÖåÏä§Ìä∏ Í¥ÄÎ†® Ìï®ÏàòÎì§
        function toggleApiTest(element) {
            const toggle = element.querySelector('.endpoint-toggle');
            const panel = element.parentElement.querySelector('.api-test-panel');
            
            const isExpanded = panel.classList.contains('expanded');
            
            if (isExpanded) {
                panel.classList.remove('expanded');
                toggle.classList.remove('expanded');
                toggle.textContent = '‚ñ∂';
            } else {
                panel.classList.add('expanded');
                toggle.classList.add('expanded');
                toggle.textContent = '‚ñº';
            }
        }
        
        async function testApiCall(button, method, endpoint) {
            console.log('=== API Call Started ===');
            console.log('Method:', method, 'Endpoint:', endpoint);
            
            const panel = button.closest('.test-panel-content');
            const form = panel.querySelector('.test-form');
            const responseSection = panel.querySelector('.api-response-section');
            const responseContent = panel.querySelector('.response-content pre');
            
            // Î≤ÑÌäº Î°úÎî© ÏÉÅÌÉú
            const originalText = button.textContent;
            button.textContent = '‚è≥ ÏöîÏ≤≠Ï§ë...';
            button.disabled = true;
            
            try {
                let requestData = {};
                
                // Î°úÍ∑∏Ïù∏ APIÏùò Í≤ΩÏö∞ ÏßÅÏ†ë Îç∞Ïù¥ÌÑ∞ ÏàòÏßë
                if (endpoint === '/auth/login') {
                    const emailInput = form.querySelector('input[type="email"]');
                    const passwordInput = form.querySelector('input[type="password"]');
                    
                    console.log('Email input:', emailInput ? emailInput.value : 'not found');
                    console.log('Password input:', passwordInput ? passwordInput.value : 'not found');
                    
                    const email = emailInput ? emailInput.value.trim() : '';
                    const password = passwordInput ? passwordInput.value.trim() : '';
                    
                    if (!email || !password) {
                        throw new Error('Ïù¥Î©îÏùºÍ≥º ÎπÑÎ∞ÄÎ≤àÌò∏Î•º Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                    }
                    
                    // OAuth2 ÌëúÏ§Ä FormData ÌòïÏãù
                    const formData = new FormData();
                    formData.append('username', email);  // OAuth2ÏóêÏÑúÎäî username ÌïÑÎìú ÏÇ¨Ïö©
                    formData.append('password', password);
                    
                    console.log('Login FormData created:', { username: email, password: '***' });
                    
                    const response = await fetch(`http://localhost:8000${endpoint}`, {
                        method: 'POST',
                        body: formData  // FormDataÎäî Content-Type Ìó§ÎçîÎ•º ÏûêÎèôÏúºÎ°ú ÏÑ§Ï†ï
                    });
                    
                    console.log('Response status:', response.status);
                    const data = await response.json();
                    console.log('Response data:', data);
                    
                    const apiResponse = {
                        status: response.status,
                        statusText: response.statusText,
                        data: data,
                        timestamp: new Date().toISOString()
                    };
                    
                    // ÏùëÎãµ ÌëúÏãú
                    responseContent.textContent = JSON.stringify(apiResponse, null, 2);
                    responseSection.style.display = 'block';
                    
                    if (response.ok) {
                        showNotification('Î°úÍ∑∏Ïù∏ API ÌÖåÏä§Ìä∏ ÏÑ±Í≥µ!', 'success');
                        
                        // Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ Ïãú ÌÜ†ÌÅ∞ Ï†ÄÏû•
                        if (data.access_token) {
                            localStorage.setItem('authToken', data.access_token);
                            currentUser = data.user || { email: email };
                            updateAuthUI();
                        }
                    } else {
                        showNotification(`Î°úÍ∑∏Ïù∏ API ÌÖåÏä§Ìä∏ Ïã§Ìå®: ${data.detail || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò'}`, 'error');
                    }
                    
                } else {
                    // Îã§Î•∏ APIÎì§ÏùÑ ÏúÑÌïú Í∏∞Ï°¥ Î°úÏßÅ
                    const formData = {};
                    const inputs = form.querySelectorAll('input, textarea, select');
                    
                    inputs.forEach(input => {
                        if (input.value && !input.placeholder.includes('Bearer')) {
                            const labelElement = input.previousElementSibling;
                            const labelText = labelElement ? labelElement.textContent.trim() : '';
                            let key = '';
                            
                            switch(labelText) {
                                case 'Ï†úÎ™©': key = 'title'; break;
                                case 'ÎÇ¥Ïö©': key = 'content'; break;
                                case 'ÏÑúÎπÑÏä§': key = 'service'; break;
                                case 'ÌéòÏù¥ÏßÄ': key = 'page'; break;
                                case 'Í∞úÏàò': key = 'limit'; break;
                                case 'ÌÉÄÏûÖ (ÏÑ†ÌÉù)':
                                case 'ÌÉÄÏûÖ': key = 'type'; break;
                                case 'Í≤åÏãúÍ∏Ä Slug': key = 'slug'; break;
                                default:
                                    key = labelText.toLowerCase().replace(/[^a-z0-9]/g, '_');
                            }
                            
                            if (key) {
                                formData[key] = input.value.trim();
                            }
                        }
                    });
                    
                    const headers = { 'Content-Type': 'application/json' };
                    
                    // Authorization Ìó§Îçî Ï≤òÎ¶¨
                    const authInput = form.querySelector('input[placeholder*="Bearer"]');
                    if (authInput && authInput.value) {
                        headers['Authorization'] = authInput.value;
                    }
                    
                    let response;
                    const apiUrl = `http://localhost:8000${endpoint}`;
                    
                    if (method === 'GET') {
                        const params = new URLSearchParams(formData);
                        response = await fetch(`${apiUrl}?${params}`, {
                            method: 'GET',
                            headers: headers
                        });
                    } else {
                        response = await fetch(apiUrl, {
                            method: method,
                            headers: headers,
                            body: JSON.stringify(formData)
                        });
                    }
                    
                    const data = await response.json();
                    const apiResponse = {
                        status: response.status,
                        statusText: response.statusText,
                        data: data,
                        timestamp: new Date().toISOString()
                    };
                    
                    responseContent.textContent = JSON.stringify(apiResponse, null, 2);
                    responseSection.style.display = 'block';
                    
                    if (response.ok) {
                        showNotification(`${endpoint} API ÌÖåÏä§Ìä∏ ÏÑ±Í≥µ!`, 'success');
                    } else {
                        showNotification(`${endpoint} API ÌÖåÏä§Ìä∏ Ïã§Ìå®: ${data.detail || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò'}`, 'error');
                    }
                }
                
                // ÏùëÎãµ ÏÑπÏÖòÏúºÎ°ú Ïä§ÌÅ¨Î°§
                setTimeout(() => {
                    responseSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
                
            } catch (error) {
                console.error('API Call Error:', error);
                
                const errorResponse = {
                    error: "API Ìò∏Ï∂ú Ïã§Ìå®",
                    message: error.message,
                    timestamp: new Date().toISOString()
                };
                
                responseContent.textContent = JSON.stringify(errorResponse, null, 2);
                responseSection.style.display = 'block';
                
                showNotification(`API ÌÖåÏä§Ìä∏ Ïã§Ìå®: ${error.message}`, 'error');
                
                setTimeout(() => {
                    responseSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
            } finally {
                // Î≤ÑÌäº Î≥µÏõê
                button.textContent = originalText;
                button.disabled = false;
                console.log('=== API Call Ended ===');
            }
        }
        
        function clearApiForm(button) {
            const form = button.closest('.test-form');
            const inputs = form.querySelectorAll('input, textarea, select');
            inputs.forEach(input => {
                if (input.type === 'number') {
                    input.value = input.placeholder || '1';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                } else {
                    input.value = '';
                }
            });
            
            const responseSection = button.closest('.test-panel-content').querySelector('.api-response-section');
            if (responseSection) {
                responseSection.style.display = 'none';
                const responseContent = responseSection.querySelector('.response-content pre');
                if (responseContent) {
                    responseContent.textContent = 'ÏùëÎãµ ÎåÄÍ∏∞Ï§ë...';
                }
            }
        }
        
        // ÏùëÎãµ ÌÉ≠ Ï†ÑÌôò (API ÌÖåÏä§Ìä∏Ïö©)
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('response-tab')) {
                const tabs = e.target.parentElement.querySelectorAll('.response-tab');
                tabs.forEach(tab => tab.classList.remove('active'));
                e.target.classList.add('active');
                
                const content = e.target.closest('.api-response-section').querySelector('.response-content pre');
                if (e.target.textContent === 'Ìó§Îçî') {
                    content.textContent = JSON.stringify({
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer token...',
                        'User-Agent': 'FastAPI-Dashboard/1.0',
                        'Accept': 'application/json'
                    }, null, 2);
                } else if (e.target.textContent === 'ÏöîÏ≤≠') {
                    content.textContent = JSON.stringify({
                        method: 'POST',
                        url: '/api/endpoint',
                        headers: {'Content-Type': 'application/json'},
                        body: {'test': 'data'}
                    }, null, 2);
                }
            }
        });
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        function showModal(title, content) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalBody').innerHTML = content;
            document.getElementById('modalOverlay').classList.add('active');
        }
        
        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('active');
        }
        
        // Î™®Îã¨ Î∞∞Í≤Ω ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
        document.getElementById('modalOverlay').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // Î°úÍ∑∏Ïù∏ API Ìò∏Ï∂ú Ìï®Ïàò
        async function testApiCallNew(button, method, endpoint) {
            const originalText = button.textContent;
            button.textContent = '‚è≥ Î°úÍ∑∏Ïù∏ Ï§ë...';
            button.disabled = true;
            
            try {
                // Î°úÍ∑∏Ïù∏ Îç∞Ïù¥ÌÑ∞ ÏàòÏßë
                const formData = new FormData();
                formData.append('username', 'test@test.com');
                formData.append('password', 'password123');
                
                const response = await fetch('http://localhost:8000/auth/login', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                // ÏùëÎãµ ÌëúÏãú
                const responseSection = button.closest('.test-panel-content').querySelector('.api-response-section');
                const responseContent = responseSection.querySelector('.response-content pre');
                
                const apiResponse = {
                    status: response.status,
                    statusText: response.statusText,
                    data: data,
                    timestamp: new Date().toISOString()
                };
                
                responseContent.textContent = JSON.stringify(apiResponse, null, 2);
                responseSection.style.display = 'block';
                
                if (response.ok) {
                    showNotification('Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ!', 'success');
                    
                    // Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ Ïãú ÌÜ†ÌÅ∞ Ï†ÄÏû•
                    if (data.access_token) {
                        localStorage.setItem('authToken', data.access_token);
                        currentUser = data.user || { email: 'test@test.com' };
                        updateAuthUI();
                    }
                } else {
                    showNotification('Î°úÍ∑∏Ïù∏ Ïã§Ìå®: ' + (data.detail || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò'), 'error');
                }
                
                // ÏùëÎãµ ÏÑπÏÖòÏúºÎ°ú Ïä§ÌÅ¨Î°§
                setTimeout(() => {
                    responseSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
                
            } catch (error) {
                const errorResponse = {
                    error: "API Ìò∏Ï∂ú Ïã§Ìå®",
                    message: error.message,
                    timestamp: new Date().toISOString()
                };
                
                const responseSection = button.closest('.test-panel-content').querySelector('.api-response-section');
                const responseContent = responseSection.querySelector('.response-content pre');
                responseContent.textContent = JSON.stringify(errorResponse, null, 2);
                responseSection.style.display = 'block';
                
                showNotification('API Ìò∏Ï∂ú Ïò§Î•ò: ' + error.message, 'error');
            } finally {
                button.textContent = originalText;
                button.disabled = false;
            }
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            // Î°úÍ∑∏Ïù∏ API Î≤ÑÌäº Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
            const loginButton = document.getElementById('loginApiButton');
            if (loginButton) {
                loginButton.addEventListener('click', function() {
                    const method = this.dataset.method;
                    const endpoint = this.dataset.endpoint;
                    testApiCallNew(this, method, endpoint);
                });
            }
            
            init();
        });
        
        // Î™®Î∞îÏùº ÏÇ¨Ïù¥ÎìúÎ∞î ÌÜ†Í∏Ä
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }
        
        // Ï∞Ω ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω Ïãú ÏÇ¨Ïù¥ÎìúÎ∞î ÏûêÎèô Îã´Í∏∞
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                document.getElementById('sidebar').classList.remove('open');
            }
        });
        
        // =========================
        // Í≤åÏãúÍ∏Ä ÏàòÏ†ï/ÏÇ≠Ï†ú Í∏∞Îä•
        // =========================
        
        // Í≤åÏãúÍ∏Ä ÏàòÏ†ï Î≤ÑÌäº ÌÅ¥Î¶≠
        function editCurrentPost() {
            if (!currentPost) {
                showNotification('Í≤åÏãúÍ∏Ä Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }
            
            // ÏàòÏ†ï ÌèºÏóê Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞ Ï±ÑÏö∞Í∏∞
            document.getElementById('editPostTitle').value = currentPost.title || '';
            document.getElementById('editPostContent').value = currentPost.content || '';
            document.getElementById('editPostService').value = currentPost.service || '';
            
            // ÏÑúÎπÑÏä§Ïóê Îî∞Î•∏ ÌÉÄÏûÖ ÏòµÏÖò ÏóÖÎç∞Ïù¥Ìä∏
            updateEditPostType();
            document.getElementById('editPostType').value = currentPost.metadata?.type || '';
            
            // ÌÉúÍ∑∏ ÏÑ§Ï†ï
            const tags = currentPost.metadata?.tags || [];
            document.getElementById('editPostTags').value = tags.join(', ');
            
            // ÏàòÏ†ï ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
            showPage('post-edit');
        }
        
        // Í≤åÏãúÍ∏Ä ÏÇ≠Ï†ú Î≤ÑÌäº ÌÅ¥Î¶≠
        function deleteCurrentPost() {
            if (!currentPost) {
                showNotification('Í≤åÏãúÍ∏Ä Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }
            
            // ÏÇ≠Ï†ú ÌôïÏù∏ Îã§Ïù¥ÏñºÎ°úÍ∑∏ ÌëúÏãú
            document.getElementById('deleteConfirmDialog').classList.add('active');
        }
        
        // ÏÇ≠Ï†ú ÌôïÏù∏
        async function confirmDeletePost() {
            if (!currentPost) return;
            
            try {
                await apiCall(`/api/posts/${currentPost.slug}`, {
                    method: 'DELETE'
                });
                
                showNotification('Í≤åÏãúÍ∏ÄÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.', 'success');
                
                // Îã§Ïù¥ÏñºÎ°úÍ∑∏ Îã´Í∏∞
                document.getElementById('deleteConfirmDialog').classList.remove('active');
                
                // Í≤åÏãúÍ∏Ä Î™©Î°ùÏúºÎ°ú Ïù¥Îèô
                showPage('posts');
                
                // Í≤åÏãúÍ∏Ä Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®
                await loadPosts();
                
            } catch (error) {
                console.error('Failed to delete post:', error);
                showNotification('Í≤åÏãúÍ∏Ä ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        }
        
        // ÏÇ≠Ï†ú Ï∑®ÏÜå
        function cancelDeletePost() {
            document.getElementById('deleteConfirmDialog').classList.remove('active');
        }
        
        // Í≤åÏãúÍ∏Ä ÏàòÏ†ï Ï†úÏ∂ú
        async function handleUpdatePost(event) {
            event.preventDefault();
            
            if (!currentPost) {
                showNotification('Í≤åÏãúÍ∏Ä Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }
            
            const btn = document.getElementById('updatePostBtn');
            const form = event.target;
            const formData = new FormData(form);
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> ÏàòÏ†ï Ï§ë...';
            
            try {
                const updateData = {
                    title: formData.get('title'),
                    content: formData.get('content'),
                    service: formData.get('service'),
                    metadata: {
                        type: formData.get('type'),
                        tags: formData.get('tags') ? formData.get('tags').split(',').map(tag => tag.trim().slice(0, 10)).slice(0, 3) : [],
                        visibility: 'public'
                    }
                };
                
                console.log('Updating post with data:', updateData);
                
                const updatedPost = await apiCall(`/api/posts/${currentPost.slug}`, {
                    method: 'PUT',
                    body: JSON.stringify(updateData)
                });
                
                showNotification('Í≤åÏãúÍ∏ÄÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§!', 'success');
                
                // ÌòÑÏû¨ Í≤åÏãúÍ∏Ä Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
                currentPost = updatedPost;
                window.currentPost = updatedPost;
                
                // Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄÎ°ú Ïù¥ÎèôÌïòÏó¨ ÏóÖÎç∞Ïù¥Ìä∏Îêú ÎÇ¥Ïö© ÌëúÏãú
                await showPostDetail(updatedPost.slug || updatedPost.id);
                
            } catch (error) {
                console.error('Failed to update post:', error);
                showNotification('Í≤åÏãúÍ∏Ä ÏàòÏ†ïÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'ÏàòÏ†ï ÏôÑÎ£å';
            }
        }
        
        // ÏàòÏ†ï ÌèºÏùò ÏÑúÎπÑÏä§Î≥Ñ ÌÉÄÏûÖ ÏóÖÎç∞Ïù¥Ìä∏
        function updateEditPostType() {
            const serviceSelect = document.getElementById('editPostService');
            const typeSelect = document.getElementById('editPostType');
            const selectedService = serviceSelect.value;
            
            // ÌÉÄÏûÖ ÏòµÏÖò Ï¥àÍ∏∞Ìôî
            typeSelect.innerHTML = '<option value="">ÌÉÄÏûÖ ÏÑ†ÌÉù</option>';
            
            // ÏÑ†ÌÉùÎêú ÏÑúÎπÑÏä§Ïùò ÌÉÄÏûÖÎì§ Ï∂îÍ∞Ä
            if (selectedService && serviceTypes[selectedService]) {
                serviceTypes[selectedService].forEach(type => {
                    const option = document.createElement('option');
                    option.value = type;
                    option.textContent = type;
                    typeSelect.appendChild(option);
                });
            }
        }
        
        // ÏûëÏÑ±Ïûê Í∂åÌïú Ï≤¥ÌÅ¨ Î∞è UI ÏóÖÎç∞Ïù¥Ìä∏
        function updatePostActions() {
            console.log('=== Í≤åÏãúÍ∏Ä ÏàòÏ†ï/ÏÇ≠Ï†ú Î≤ÑÌäº Í∂åÌïú Ï≤¥ÌÅ¨ ===');
            const postActions = document.getElementById('postActions');
            
            if (!postActions) {
                console.error('‚ùå postActions ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§!');
                return;
            }
            
            // Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú Î∞è ÌòÑÏû¨ Í≤åÏãúÍ∏Ä Ï≤¥ÌÅ¨
            if (!currentUser) {
                console.log('‚ùå Î°úÍ∑∏Ïù∏ÎêòÏßÄ ÏïäÏùå - Î≤ÑÌäº Ïà®ÍπÄ');
                postActions.style.display = 'none';
                return;
            }
            
            if (!currentPost) {
                console.log('‚ùå Í≤åÏãúÍ∏Ä Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå - Î≤ÑÌäº Ïà®ÍπÄ');
                postActions.style.display = 'none';
                return;
            }
            
            // ÏÇ¨Ïö©ÏûêÏôÄ ÏûëÏÑ±Ïûê Ï†ïÎ≥¥ ÎπÑÍµê
            const userEmail = currentUser.email;
            const userHandle = currentUser.user_handle;
            const postAuthor = currentPost.author_id;
            
            console.log('ÌòÑÏû¨ ÏÇ¨Ïö©Ïûê:', userEmail);
            console.log('Í≤åÏãúÍ∏Ä ÏûëÏÑ±Ïûê:', postAuthor);
            
            // ÏûëÏÑ±Ïûê Ï≤¥ÌÅ¨ (User IDÎ°ú ÎπÑÍµê)
            const userId = currentUser._id || currentUser.id;
            const isAuthor = userId === postAuthor || userEmail === postAuthor || userHandle === postAuthor;
            
            console.log('User ID:', userId);
            console.log('ÎπÑÍµê:', {
                'ID Îß§Ïπò': userId === postAuthor,
                'Ïù¥Î©îÏùº Îß§Ïπò': userEmail === postAuthor,
                'Ìï∏Îì§ Îß§Ïπò': userHandle === postAuthor
            });
            
            console.log('ÏûëÏÑ±Ïûê Ïó¨Î∂Ä:', isAuthor);
            console.log('ÎπÑÍµê Í≤∞Í≥º:', {
                'Ïù¥Î©îÏùº Îß§Ïπò': userEmail === postAuthor,
                'Ìï∏Îì§ Îß§Ïπò': userHandle === postAuthor
            });
            
            if (isAuthor) {
                console.log('‚úÖ ÏûëÏÑ±Ïûê ÌôïÏù∏! ÏàòÏ†ï/ÏÇ≠Ï†ú Î≤ÑÌäº ÌëúÏãú');
                postActions.style.display = 'flex';
            } else {
                console.log('‚ùå ÏûëÏÑ±ÏûêÍ∞Ä ÏïÑÎãò. Î≤ÑÌäº Ïà®ÍπÄ');
                postActions.style.display = 'none';
            }
        }
        
        // ====== ÏÉàÎ°úÏö¥ Í≤åÏãúÍ∏Ä ÌååÏùº ÏóÖÎ°úÎìú Í¥ÄÎ†® Ìï®ÏàòÎì§ ======
        let postUploadedFiles = [];
        
        // Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÌååÏùº ÏóÖÎ°úÎìú Ï¥àÍ∏∞Ìôî
        function initPostFileUpload() {
            const uploadArea = document.getElementById('postFileUpload');
            const fileInput = document.getElementById('postFileInput');
            const fileList = document.getElementById('postFileList');
            const uploadedFilesContainer = document.getElementById('postUploadedFiles');
            
            if (!uploadArea || !fileInput) return;
            
            // ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            uploadArea.addEventListener('click', () => fileInput.click());
            
            // ÌååÏùº ÏÑ†ÌÉù Ïù¥Î≤§Ìä∏
            fileInput.addEventListener('change', handlePostFileSelect);
            
            // ÎìúÎûòÍ∑∏ Ïï§ ÎìúÎ°≠ Ïù¥Î≤§Ìä∏
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    fileInput.files = files;
                    handlePostFileSelect({ target: { files } });
                }
            });
        }
        
        function handlePostFileSelect(event) {
            const files = Array.from(event.target.files);
            if (files.length === 0) return;
            
            // Ïù¥ÎØ∏ÏßÄ ÌååÏùºÎßå ÌïÑÌÑ∞ÎßÅ
            const imageFiles = files.filter(file => file.type.startsWith('image/'));
            
            if (imageFiles.length === 0) {
                showNotification('Ïù¥ÎØ∏ÏßÄ ÌååÏùºÎßå ÏóÖÎ°úÎìú Í∞ÄÎä•Ìï©ÎãàÎã§.', 'error');
                return;
            }
            
            // ÌååÏùº ÌÅ¨Í∏∞ Ï≤¥ÌÅ¨ (10MB Ï†úÌïú)
            const maxSize = 10 * 1024 * 1024; // 10MB
            const oversizedFiles = imageFiles.filter(file => file.size > maxSize);
            
            if (oversizedFiles.length > 0) {
                showNotification('ÌååÏùº ÌÅ¨Í∏∞Îäî 10MBÎ•º Ï¥àÍ≥ºÌï† Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }
            
            // ÌååÏùºÎì§ÏùÑ postUploadedFilesÏóê Ï∂îÍ∞Ä
            imageFiles.forEach(file => {
                if (!postUploadedFiles.find(f => f.name === file.name && f.size === file.size)) {
                    postUploadedFiles.push(file);
                }
            });
            
            updatePostFileList();
        }
        
        function updatePostFileList() {
            const fileList = document.getElementById('postFileList');
            const uploadedFilesContainer = document.getElementById('postUploadedFiles');
            
            if (postUploadedFiles.length === 0) {
                uploadedFilesContainer.style.display = 'none';
                return;
            }
            
            uploadedFilesContainer.style.display = 'block';
            fileList.innerHTML = '';
            
            postUploadedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                // Ïù¥ÎØ∏ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞ ÏÉùÏÑ±
                const reader = new FileReader();
                reader.onload = (e) => {
                    fileItem.innerHTML = `
                        <div class="file-info">
                            <img src="${e.target.result}" alt="ÎØ∏Î¶¨Î≥¥Í∏∞" class="file-preview">
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button type="button" class="file-remove" onclick="removePostFile(${index})">
                            ÏÇ≠Ï†ú
                        </button>
                    `;
                };
                reader.readAsDataURL(file);
                
                fileList.appendChild(fileItem);
            });
        }
        
        function removePostFile(index) {
            postUploadedFiles.splice(index, 1);
            updatePostFileList();
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏ÏóêÏÑú Ï≤®Î∂Ä ÌååÏùº ÌëúÏãú
        async function displayPostAttachments(fileIds) {
            console.log('=== Ï≤®Î∂Ä ÌååÏùº ÌëúÏãú Ìï®Ïàò Ìò∏Ï∂ú ===');
            console.log('Ï†ÑÎã¨Î∞õÏùÄ file IDs:', fileIds);
            
            const attachmentsContainer = document.getElementById('postAttachments');
            const attachmentsGrid = document.getElementById('attachmentsGrid');
            
            if (!attachmentsContainer || !attachmentsGrid) {
                console.error('Ï≤®Î∂Ä ÌååÏùº Ïª®ÌÖåÏù¥ÎÑà ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§');
                return;
            }
            
            if (!fileIds || fileIds.length === 0) {
                console.log('Ï≤®Î∂Ä ÌååÏùºÏù¥ ÏóÜÏñ¥ Ïª®ÌÖåÏù¥ÎÑàÎ•º Ïà®ÍπÅÎãàÎã§');
                attachmentsContainer.style.display = 'none';
                return;
            }
            
            console.log(`${fileIds.length}Í∞úÏùò Ï≤®Î∂Ä ÌååÏùºÏùÑ ÌëúÏãúÌï©ÎãàÎã§`);
            attachmentsContainer.style.display = 'block';
            attachmentsGrid.innerHTML = '';
            
            for (let i = 0; i < fileIds.length; i++) {
                const fileId = fileIds[i];
                console.log(`ÌååÏùº ${i + 1} ID:`, fileId);
                
                const attachmentItem = document.createElement('div');
                attachmentItem.className = 'attachment-item';
                
                // API Î™ÖÏÑ∏Ïóê Îî∞Î•∏ Ïù¥ÎØ∏ÏßÄ URL
                let imageUrl = `${API_BASE_URL}/api/files/${fileId}`;
                let fileName = `Ïù¥ÎØ∏ÏßÄ ${i + 1}`;
                let fileSize = 0;
                
                // Î™®Ïùò ÌååÏùºÏù∏ Í≤ΩÏö∞ localStorageÏóêÏÑú Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
                if (fileId.startsWith('mock_file_')) {
                    const storedFileData = localStorage.getItem(`file_${fileId}`);
                    if (storedFileData) {
                        try {
                            const fileData = JSON.parse(storedFileData);
                            imageUrl = fileData.file_url; // Data URL
                            fileName = fileData.original_filename || fileName;
                            fileSize = fileData.file_size || 0;
                            console.log('Î™®Ïùò ÌååÏùº Îç∞Ïù¥ÌÑ∞ Î°úÎìú:', fileData);
                        } catch (e) {
                            console.error('Î™®Ïùò ÌååÏùº Îç∞Ïù¥ÌÑ∞ ÌååÏã± Ïã§Ìå®:', e);
                        }
                    }
                } else {
                    // Ïã§Ï†ú ÌååÏùºÏù∏ Í≤ΩÏö∞ Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ Ï°∞Ìöå ÏãúÎèÑ
                    try {
                        const metaResponse = await fetch(`${API_BASE_URL}/api/files/${fileId}/info`);
                        if (metaResponse.ok) {
                            const metaData = await metaResponse.json();
                            fileName = metaData.original_filename || fileName;
                            fileSize = metaData.file_size || 0;
                        }
                    } catch (error) {
                        console.log('ÌååÏùº Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ Ï°∞Ìöå Ïã§Ìå® (Ï†ïÏÉÅ):', error);
                    }
                }
                
                console.log(`Ïù¥ÎØ∏ÏßÄ URL: ${imageUrl}`);
                console.log(`ÌååÏùºÎ™Ö: ${fileName}`);
                
                attachmentItem.innerHTML = `
                    <img src="${imageUrl}" alt="${fileName}" class="attachment-image" 
                         onclick="openImageModal('${imageUrl.replace(/'/g, '&#39;')}')" 
                         onerror="console.error('Ïù¥ÎØ∏ÏßÄ Î°úÎìú Ïã§Ìå®:', '${fileName}'); this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' width=\\'100\\' height=\\'100\\' viewBox=\\'0 0 100 100\\'%3E%3Crect width=\\'100\\' height=\\'100\\' fill=\\'%23f0f0f0\\'/%3E%3Ctext x=\\'50\\' y=\\'50\\' text-anchor=\\'middle\\' dy=\\'.3em\\' fill=\\'%23999\\' font-family=\\'sans-serif\\' font-size=\\'14\\'%3EÏù¥ÎØ∏ÏßÄ ÏóÜÏùå%3C/text%3E%3C/svg%3E';"
                         onload="console.log('Ïù¥ÎØ∏ÏßÄ Î°úÎìú ÏÑ±Í≥µ:', '${fileName}')">
                    <div class="attachment-info">
                        <div class="attachment-name">${fileName}</div>
                        <div class="attachment-size">${formatFileSize(fileSize)}</div>
                    </div>
                `;
                
                attachmentsGrid.appendChild(attachmentItem);
            }
        }
        
        // Ïù¥ÎØ∏ÏßÄ Î™®Îã¨ Ïó¥Í∏∞
        function openImageModal(imageUrl) {
            // Î™®Îã¨Ïù¥ ÏóÜÏúºÎ©¥ ÎèôÏ†Å ÏÉùÏÑ±
            let modal = document.getElementById('imageModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'imageModal';
                modal.className = 'image-modal';
                modal.innerHTML = `
                    <button class="modal-close" onclick="closeImageModal()">&times;</button>
                    <img src="" alt="Ïù¥ÎØ∏ÏßÄ" class="modal-image" id="modalImage">
                `;
                document.body.appendChild(modal);
                
                // Î™®Îã¨ Î∞∞Í≤Ω ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        closeImageModal();
                    }
                });
                
                // ESC ÌÇ§Î°ú Îã´Í∏∞
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        closeImageModal();
                    }
                });
            }
            
            document.getElementById('modalImage').src = imageUrl;
            modal.classList.add('active');
        }
        
        // Ïù¥ÎØ∏ÏßÄ Î™®Îã¨ Îã´Í∏∞
        function closeImageModal() {
            const modal = document.getElementById('imageModal');
            if (modal) {
                modal.classList.remove('active');
            }
        }
        
        // ====== Í∏∞Ï°¥ ÌååÏùº ÏóÖÎ°úÎìú Í¥ÄÎ†® Ìï®ÏàòÎì§ ======
        let selectedFile = null;
        
        function logApi(message, type = 'info') {
            const apiLog = document.getElementById('apiLog');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.style.marginBottom = '5px';
            logEntry.style.color = type === 'error' ? '#dc2626' : type === 'success' ? '#059669' : '#374151';
            logEntry.innerHTML = `<span style="color: #6b7280;">[${timestamp}]</span> ${message}`;
            apiLog.appendChild(logEntry);
            apiLog.scrollTop = apiLog.scrollHeight;
        }
        
        function clearApiLog() {
            const apiLog = document.getElementById('apiLog');
            apiLog.innerHTML = '<div style="color: #6b7280;">API Ìò∏Ï∂ú Î°úÍ∑∏Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§...</div>';
        }
        
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            selectedFile = file;
            logApi(`üìÅ ÌååÏùº ÏÑ†ÌÉùÎê®: ${file.name} (${formatFileSize(file.size)})`);
            
            // ÌååÏùº Ï†ïÎ≥¥ ÌëúÏãú
            document.getElementById('fileDetails').innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9em;">
                    <div><strong>ÌååÏùºÎ™Ö:</strong> ${file.name}</div>
                    <div><strong>ÌÅ¨Í∏∞:</strong> ${formatFileSize(file.size)}</div>
                    <div><strong>ÌÉÄÏûÖ:</strong> ${file.type}</div>
                    <div><strong>ÎßàÏßÄÎßâ ÏàòÏ†ï:</strong> ${new Date(file.lastModified).toLocaleDateString()}</div>
                </div>
            `;
            
            document.getElementById('fileInfo').style.display = 'block';
            document.getElementById('uploadArea').style.borderColor = '#10b981';
            document.getElementById('uploadArea').style.backgroundColor = '#f0fdf4';
            
            // Îã§Î•∏ ÏÉÅÌÉú Ïà®Í∏∞Í∏∞
            hideAllUploadStates();
        }
        
        function clearFileSelection() {
            selectedFile = null;
            document.getElementById('fileInput').value = '';
            document.getElementById('fileInfo').style.display = 'none';
            document.getElementById('uploadArea').style.borderColor = '#d1d5db';
            document.getElementById('uploadArea').style.backgroundColor = 'transparent';
            hideAllUploadStates();
            logApi('‚ùå ÌååÏùº ÏÑ†ÌÉù Ï∑®ÏÜåÎê®');
        }
        
        function hideAllUploadStates() {
            document.getElementById('uploadProgress').style.display = 'none';
            document.getElementById('uploadResult').style.display = 'none';
            document.getElementById('uploadError').style.display = 'none';
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        async function uploadSelectedFile() {
            if (!selectedFile) {
                logApi('‚ö†Ô∏è ÏóÖÎ°úÎìúÌï† ÌååÏùºÏù¥ ÏÑ†ÌÉùÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.', 'error');
                return;
            }
            
            // UI ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('fileInfo').style.display = 'none';
            document.getElementById('uploadProgress').style.display = 'block';
            hideAllUploadStates();
            document.getElementById('uploadProgress').style.display = 'block';
            
            const uploadBtn = document.getElementById('uploadBtn');
            uploadBtn.disabled = true;
            
            try {
                logApi(`üöÄ ÏóÖÎ°úÎìú ÏãúÏûë: ${selectedFile.name}`);
                
                // FormData ÏÉùÏÑ±
                const formData = new FormData();
                formData.append('file', selectedFile);
                
                // Ï≤®Î∂Ä Ï†ïÎ≥¥ Ï∂îÍ∞Ä (ÏÑ†ÌÉùÏÇ¨Ìï≠)
                const attachmentType = document.getElementById('attachmentType').value;
                const attachmentId = document.getElementById('attachmentId').value;
                
                if (attachmentType) {
                    formData.append('attachment_type', attachmentType);
                    logApi(`üìé Ï≤®Î∂Ä ÌÉÄÏûÖ: ${attachmentType}`);
                }
                if (attachmentId) {
                    formData.append('attachment_id', attachmentId);
                    logApi(`üîó Ï≤®Î∂Ä ID: ${attachmentId}`);
                }
                
                // ÏßÑÌñâÏÉÅÌô© ÏãúÎÆ¨Î†àÏù¥ÏÖò
                updateProgress(0, 'ÏóÖÎ°úÎìú Ï§ÄÎπÑ Ï§ë...');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                updateProgress(25, 'ÌååÏùº Í≤ÄÏ¶ù Ï§ë...');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                updateProgress(50, 'ÏÑúÎ≤ÑÏóê ÏóÖÎ°úÎìú Ï§ë...');
                
                // API Ìò∏Ï∂ú
                const response = await fetch(`${API_BASE_URL}/api/files/upload`, {
                    method: 'POST',
                    body: formData
                });
                
                updateProgress(75, 'ÏÑúÎ≤Ñ ÏùëÎãµ Ï≤òÎ¶¨ Ï§ë...');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const result = await response.json();
                
                updateProgress(100, 'ÏóÖÎ°úÎìú ÏôÑÎ£å!');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                if (response.ok) {
                    // ÏÑ±Í≥µ Ï≤òÎ¶¨
                    logApi(`‚úÖ ÏóÖÎ°úÎìú ÏÑ±Í≥µ! ÌååÏùº ID: ${result.file_id}`, 'success');
                    showUploadSuccess(result);
                } else {
                    // Ïò§Î•ò Ï≤òÎ¶¨
                    logApi(`‚ùå ÏóÖÎ°úÎìú Ïã§Ìå®: ${result.detail || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò'}`, 'error');
                    showUploadError(result.detail || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                }
                
            } catch (error) {
                logApi(`üí• ÎÑ§Ìä∏ÏõåÌÅ¨ Ïò§Î•ò: ${error.message}`, 'error');
                showUploadError(`ÎÑ§Ìä∏ÏõåÌÅ¨ Ïò§Î•ò: ${error.message}`);
            } finally {
                document.getElementById('uploadProgress').style.display = 'none';
                uploadBtn.disabled = false;
            }
        }
        
        function updateProgress(percent, text) {
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('progressText').textContent = text;
        }
        
        function showUploadSuccess(result) {
            document.getElementById('uploadResult').style.display = 'block';
            document.getElementById('resultDetails').innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 0.9em;">
                    <div><strong>ÌååÏùº ID:</strong><br><code style="background: #e5e7eb; padding: 2px 6px; border-radius: 4px; font-size: 0.8em;">${result.file_id}</code></div>
                    <div><strong>ÌååÏùºÎ™Ö:</strong><br>${result.filename}</div>
                    <div><strong>ÌååÏùº Í≤ΩÎ°ú:</strong><br><code style="background: #e5e7eb; padding: 2px 6px; border-radius: 4px; font-size: 0.8em;">${result.file_path}</code></div>
                    <div><strong>ÌååÏùº ÌÅ¨Í∏∞:</strong><br>${formatFileSize(result.file_size)}</div>
                    <div><strong>MIME ÌÉÄÏûÖ:</strong><br>${result.content_type}</div>
                    <div><strong>ÏÉÅÌÉú:</strong><br><span style="color: #059669;">‚úÖ ÏóÖÎ°úÎìú ÏôÑÎ£å</span></div>
                </div>
                <div style="margin-top: 15px; padding: 10px; background: #ecfdf5; border-radius: 6px;">
                    <strong>üéâ Î™®Îì† Í≤ÄÏ¶ù Îã®Í≥ÑÎ•º ÌÜµÍ≥ºÌñàÏäµÎãàÎã§!</strong>
                    <ul style="margin: 10px 0; padding-left: 20px; color: #059669;">
                        <li>ÌååÏùº ÌÉÄÏûÖ Í≤ÄÏ¶ù ‚úÖ</li>
                        <li>ÌååÏùº ÌÅ¨Í∏∞ Í≤ÄÏ¶ù ‚úÖ</li>
                        <li>ÌôïÏû•Ïûê ÏùºÏπòÏÑ± Í≤ÄÏ¶ù ‚úÖ</li>
                        <li>ÎîîÏä§ÌÅ¨ Ï†ÄÏû• ‚úÖ</li>
                        <li>Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ï†ÄÏû• ‚úÖ</li>
                    </ul>
                </div>
            `;
        }
        
        function showUploadError(message) {
            document.getElementById('uploadError').style.display = 'block';
            document.getElementById('errorDetails').innerHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>Ïò§Î•ò Î©îÏãúÏßÄ:</strong><br>
                    ${message}
                </div>
                <div style="font-size: 0.9em; color: #7f1d1d;">
                    <strong>Î¨∏Ï†ú Ìï¥Í≤∞ Î∞©Î≤ï:</strong>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li>ÌååÏùºÏù¥ Ïù¥ÎØ∏ÏßÄ ÌòïÏãùÏù∏ÏßÄ ÌôïÏù∏ (JPG, PNG, GIF, WEBP)</li>
                        <li>ÌååÏùº ÌÅ¨Í∏∞Í∞Ä 5MB Ïù¥ÌïòÏù∏ÏßÄ ÌôïÏù∏</li>
                        <li>ÌååÏùº ÌôïÏû•ÏûêÏôÄ Ïã§Ï†ú ÌååÏùº ÌòïÏãùÏù¥ ÏùºÏπòÌïòÎäîÏßÄ ÌôïÏù∏</li>
                        <li>ÎÑ§Ìä∏ÏõåÌÅ¨ Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏</li>
                        <li>ÏÑúÎ≤ÑÍ∞Ä Ïã§Ìñâ Ï§ëÏù∏ÏßÄ ÌôïÏù∏</li>
                    </ul>
                </div>
            `;
        }
        
        function resetUploadForm() {
            clearFileSelection();
            hideAllUploadStates();
            
            // Ìèº Ï¥àÍ∏∞Ìôî
            document.getElementById('attachmentType').value = '';
            document.getElementById('attachmentId').value = '';
            
            logApi('üîÑ ÏóÖÎ°úÎìú ÌèºÏù¥ Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.');
        }
        
        // ÎìúÎûòÍ∑∏ Ïï§ ÎìúÎ°≠ ÏßÄÏõê
        document.addEventListener('DOMContentLoaded', function() {
            const uploadArea = document.getElementById('uploadArea');
            
            if (uploadArea) {
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    uploadArea.addEventListener(eventName, preventDefaults, false);
                });
                
                function preventDefaults(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    uploadArea.addEventListener(eventName, highlight, false);
                });
                
                ['dragleave', 'drop'].forEach(eventName => {
                    uploadArea.addEventListener(eventName, unhighlight, false);
                });
                
                function highlight(e) {
                    uploadArea.style.borderColor = '#2563eb';
                    uploadArea.style.backgroundColor = '#eff6ff';
                }
                
                function unhighlight(e) {
                    uploadArea.style.borderColor = '#d1d5db';
                    uploadArea.style.backgroundColor = 'transparent';
                }
                
                uploadArea.addEventListener('drop', handleDrop, false);
                
                function handleDrop(e) {
                    const dt = e.dataTransfer;
                    const files = dt.files;
                    
                    if (files.length > 0) {
                        const file = files[0];
                        document.getElementById('fileInput').files = files;
                        handleFileSelect({ target: { files: [file] } });
                    }
                }
            }
            
            // ÏóêÎîîÌÑ∞ Í¥ÄÎ†® Î≥ÄÏàò
            let tiptapEditor = null;
            let enhancedTiptapEditor = null;
            let novelEditor = null;
            let quillEditor = null;
            
            // ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî Ìï®ÏàòÎì§
            function initTiptapEditor() {
                // Ïù¥ÎØ∏ Ï¥àÍ∏∞ÌôîÎêòÏóàÎã§Î©¥ Î¶¨ÌÑ¥
                if (tiptapEditor) {
                    logToTiptap('Tiptap ÏóêÎîîÌÑ∞ Ïù¥ÎØ∏ Ï¥àÍ∏∞ÌôîÎê®');
                    return;
                }
                
                // ÎùºÏù¥Î∏åÎü¨Î¶¨ Î°úÎî© Ï≤¥ÌÅ¨ (ÏµúÎåÄ 5Î≤àÍπåÏßÄÎßå)
                if (typeof window.TiptapCore === 'undefined') {
                    if (!window.tiptapRetryCount) window.tiptapRetryCount = 0;
                    if (window.tiptapRetryCount < 5) {
                        window.tiptapRetryCount++;
                        console.log('Tiptap ÎùºÏù¥Î∏åÎü¨Î¶¨ Î°úÎî© Ï§ë... (' + window.tiptapRetryCount + '/5)');
                        setTimeout(initTiptapEditor, 1000);
                        return;
                    } else {
                        logToTiptap('Tiptap ÎùºÏù¥Î∏åÎü¨Î¶¨ Î°úÎî© Ïã§Ìå® - Í∏∞Î≥∏ ÏóêÎîîÌÑ∞Î°ú ÎåÄÏ≤¥');
                        initBasicTiptapEditor();
                        return;
                    }
                }
                
                try {
                    const { Editor } = window.TiptapCore;
                    const { StarterKit } = window.TiptapStarterKit;
                    
                    tiptapEditor = new Editor({
                        element: document.querySelector('#tiptap-editor'),
                        extensions: [StarterKit],
                        content: '<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>',
                        editorProps: {
                            attributes: {
                                style: 'outline: none; min-height: 300px; padding: 15px;'
                            }
                        }
                    });
                    
                    logToTiptap('Tiptap ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
                } catch (error) {
                    logToTiptap('Tiptap ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî Ïò§Î•ò: ' + error.message + ' - Í∏∞Î≥∏ ÏóêÎîîÌÑ∞Î°ú ÎåÄÏ≤¥');
                    initBasicTiptapEditor();
                }
            }
            
            function initBasicTiptapEditor() {
                const editorElement = document.getElementById('tiptap-editor');
                editorElement.innerHTML = `
                    <div style="padding: 15px; border: 1px solid #d1d5db; border-radius: 8px; min-height: 300px; background: white;">
                        <textarea style="width: 100%; height: 270px; border: none; outline: none; resize: none; font-family: inherit;" placeholder="Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî..."></textarea>
                    </div>
                `;
                // Í∞ÄÏßú ÏóêÎîîÌÑ∞ Í∞ùÏ≤¥
                tiptapEditor = {
                    getHTML: function() {
                        const textarea = editorElement.querySelector('textarea');
                        return '<p>' + (textarea.value.replace(/\n/g, '</p><p>')) + '</p>';
                    },
                    commands: {
                        setContent: function(content) {
                            const textarea = editorElement.querySelector('textarea');
                            textarea.value = content.replace(/<[^>]*>/g, '');
                        }
                    },
                    chain: function() { return { focus: function() { return { toggleBold: function() { return { run: function() {} }; } }; } }; }
                };
                logToTiptap('Í∏∞Î≥∏ ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞Î°ú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
            }
            
            function initNovelEditor() {
                // Ïù¥ÎØ∏ Ï¥àÍ∏∞ÌôîÎêòÏóàÎã§Î©¥ Î¶¨ÌÑ¥
                if (novelEditor) {
                    logToNovel('Novel ÏóêÎîîÌÑ∞ Ïù¥ÎØ∏ Ï¥àÍ∏∞ÌôîÎê®');
                    return;
                }
                
                try {
                    const editorElement = document.getElementById('novel-editor');
                    
                    // contenteditable divÎ°ú Novel ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî
                    novelEditor = {
                        element: editorElement,
                        getContent: function() {
                            return this.element.innerHTML;
                        },
                        setContent: function(content) {
                            this.element.innerHTML = content;
                        },
                        getText: function() {
                            return this.element.textContent || this.element.innerText;
                        },
                        focus: function() {
                            this.element.focus();
                        }
                    };
                    
                    // ÏóêÎîîÌÑ∞ Ïù¥Î≤§Ìä∏ ÏÑ§Ï†ï
                    editorElement.addEventListener('focus', function() {
                        if (this.textContent.trim() === 'Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...') {
                            this.innerHTML = '<p><br></p>';
                        }
                    });
                    
                    editorElement.addEventListener('blur', function() {
                        if (this.textContent.trim() === '') {
                            this.innerHTML = '<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>';
                        }
                    });
                    
                    // ÏóîÌÑ∞ ÌÇ§ Ï≤òÎ¶¨
                    editorElement.addEventListener('keydown', function(e) {
                        if (e.key === 'Enter' && !e.shiftKey) {
                            document.execCommand('formatBlock', false, 'p');
                        }
                    });
                    
                    logToNovel('Novel Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
                } catch (error) {
                    logToNovel('Novel ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî Ïò§Î•ò: ' + error.message);
                }
            }
            
            // Novel ÏóêÎîîÌÑ∞ Î™ÖÎ†π Ïã§Ìñâ Ìï®Ïàò
            function execNovelCommand(command, value = null) {
                try {
                    const editorElement = document.getElementById('novel-editor');
                    editorElement.focus();
                    
                    if (value) {
                        document.execCommand(command, false, value);
                    } else {
                        document.execCommand(command, false, null);
                    }
                    
                    // Ìè¨Ïª§Ïä§ Ïú†ÏßÄ
                    editorElement.focus();
                } catch (error) {
                    logToNovel('Î™ÖÎ†π Ïã§Ìñâ Ïò§Î•ò: ' + error.message);
                }
            }
            
            // Ìñ•ÏÉÅÎêú Tiptap ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî
            function initEnhancedTiptapEditor() {
                // Ïù¥ÎØ∏ Ï¥àÍ∏∞ÌôîÎêòÏóàÎã§Î©¥ Î¶¨ÌÑ¥
                if (enhancedTiptapEditor) {
                    logToEnhancedTiptap('Ìñ•ÏÉÅÎêú Tiptap ÏóêÎîîÌÑ∞ Ïù¥ÎØ∏ Ï¥àÍ∏∞ÌôîÎê®');
                    return;
                }
                
                try {
                    // Tiptap ÎùºÏù¥Î∏åÎü¨Î¶¨Í∞Ä ÏóÜÏùÑ Í≤ΩÏö∞ Í∏∞Î≥∏ ÏóêÎîîÌÑ∞Î°ú Ï¥àÍ∏∞Ìôî
                    if (typeof window.TiptapCore === 'undefined') {
                        initBasicEnhancedTiptapEditor();
                        return;
                    }
                    
                    const { Editor } = window.TiptapCore;
                    const { StarterKit } = window.TiptapStarterKit;
                    
                    // Í∏∞Î≥∏ ÌôïÏû• Ï∂îÍ∞Ä
                    const extensions = [StarterKit];
                    
                    // Underline ÌôïÏû•Ïù¥ ÏûàÏúºÎ©¥ Ï∂îÍ∞Ä
                    if (window.TiptapUnderline) {
                        extensions.push(window.TiptapUnderline.Underline);
                    }
                    
                    // TextAlign ÌôïÏû•Ïù¥ ÏûàÏúºÎ©¥ Ï∂îÍ∞Ä
                    if (window.TiptapTextAlign) {
                        extensions.push(window.TiptapTextAlign.TextAlign.configure({
                            types: ['heading', 'paragraph'],
                        }));
                    }
                    
                    // Image ÌôïÏû•Ïù¥ ÏûàÏúºÎ©¥ Ï∂îÍ∞Ä
                    if (window.TiptapImage) {
                        extensions.push(window.TiptapImage.Image);
                    }
                    
                    enhancedTiptapEditor = new Editor({
                        element: document.querySelector('#enhanced-tiptap-editor'),
                        extensions: extensions,
                        content: '<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>',
                        editorProps: {
                            attributes: {
                                style: 'outline: none; min-height: 400px; padding: 20px; line-height: 1.6;'
                            }
                        }
                    });
                    
                    logToEnhancedTiptap('Ìñ•ÏÉÅÎêú Tiptap ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
                } catch (error) {
                    logToEnhancedTiptap('Ìñ•ÏÉÅÎêú Tiptap ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî Ïò§Î•ò: ' + error.message + ' - Í∏∞Î≥∏ ÏóêÎîîÌÑ∞Î°ú ÎåÄÏ≤¥');
                    initBasicEnhancedTiptapEditor();
                }
            }
            
            function initBasicEnhancedTiptapEditor() {
                const editorElement = document.getElementById('enhanced-tiptap-editor');
                editorElement.innerHTML = `
                    <div style="padding: 20px; min-height: 400px; line-height: 1.6;">
                        <div contenteditable="true" style="outline: none; min-height: 360px;" id="enhanced-basic-editor">
                            <p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>
                        </div>
                    </div>
                `;
                
                const basicEditor = document.getElementById('enhanced-basic-editor');
                
                // Í∞ÄÏßú ÏóêÎîîÌÑ∞ Í∞ùÏ≤¥
                enhancedTiptapEditor = {
                    getHTML: function() {
                        return basicEditor.innerHTML;
                    },
                    chain: function() {
                        return {
                            focus: function() {
                                basicEditor.focus();
                                return {
                                    toggleBold: function() { return { run: function() { document.execCommand('bold'); } }; },
                                    toggleItalic: function() { return { run: function() { document.execCommand('italic'); } }; },
                                    toggleUnderline: function() { return { run: function() { document.execCommand('underline'); } }; },
                                    toggleStrike: function() { return { run: function() { document.execCommand('strikeThrough'); } }; },
                                    toggleHeading: function(options) { return { run: function() { document.execCommand('formatBlock', false, 'h' + options.level); } }; },
                                    toggleBulletList: function() { return { run: function() { document.execCommand('insertUnorderedList'); } }; },
                                    toggleOrderedList: function() { return { run: function() { document.execCommand('insertOrderedList'); } }; },
                                    toggleBlockquote: function() { return { run: function() { document.execCommand('formatBlock', false, 'blockquote'); } }; },
                                    setTextAlign: function(align) { return { run: function() { document.execCommand('justify' + align.charAt(0).toUpperCase() + align.slice(1)); } }; },
                                    undo: function() { return { run: function() { document.execCommand('undo'); } }; },
                                    redo: function() { return { run: function() { document.execCommand('redo'); } }; }
                                };
                            }
                        };
                    },
                    commands: {
                        setContent: function(content) {
                            basicEditor.innerHTML = content;
                        }
                    }
                };
                
                // Í∏∞Î≥∏ Ïù¥Î≤§Ìä∏ ÏÑ§Ï†ï
                basicEditor.addEventListener('focus', function() {
                    if (this.textContent.trim() === 'Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...') {
                        this.innerHTML = '<p><br></p>';
                    }
                });
                
                basicEditor.addEventListener('blur', function() {
                    if (this.textContent.trim() === '') {
                        this.innerHTML = '<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>';
                    }
                });
                
                logToEnhancedTiptap('Í∏∞Î≥∏ contenteditable ÏóêÎîîÌÑ∞Î°ú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
            }
            
            
            function initQuillEditor() {
                // Ïù¥ÎØ∏ Ï¥àÍ∏∞ÌôîÎêòÏóàÎã§Î©¥ Î¶¨ÌÑ¥
                if (quillEditor) {
                    logToQuill('ReactQuill ÏóêÎîîÌÑ∞ Ïù¥ÎØ∏ Ï¥àÍ∏∞ÌôîÎê®');
                    return;
                }
                
                // Quill ÎùºÏù¥Î∏åÎü¨Î¶¨ Ï≤¥ÌÅ¨ (ÏµúÎåÄ 5Î≤àÍπåÏßÄÎßå)
                if (typeof window.Quill === 'undefined') {
                    if (!window.quillRetryCount) window.quillRetryCount = 0;
                    if (window.quillRetryCount < 5) {
                        window.quillRetryCount++;
                        console.log('Quill ÎùºÏù¥Î∏åÎü¨Î¶¨ Î°úÎî© Ï§ë... (' + window.quillRetryCount + '/5)');
                        setTimeout(initQuillEditor, 1000);
                        return;
                    } else {
                        logToQuill('Quill ÎùºÏù¥Î∏åÎü¨Î¶¨ Î°úÎî© Ïã§Ìå® - Í∏∞Î≥∏ ÏóêÎîîÌÑ∞Î°ú ÎåÄÏ≤¥');
                        initBasicQuillEditor();
                        return;
                    }
                }
                
                try {
                    const toolbarOptions = [
                        ['bold', 'italic', 'underline', 'strike'],
                        ['blockquote', 'code-block'],
                        [{ 'header': 1 }, { 'header': 2 }],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        [{ 'script': 'sub'}, { 'script': 'super' }],
                        [{ 'indent': '-1'}, { 'indent': '+1' }],
                        [{ 'direction': 'rtl' }],
                        [{ 'size': ['small', false, 'large', 'huge'] }],
                        [{ 'header': [1, 2, 3, 4, 5, 6, false] }],
                        [{ 'color': [] }, { 'background': [] }],
                        [{ 'font': [] }],
                        [{ 'align': [] }],
                        ['clean']
                    ];
                    
                    quillEditor = new window.Quill('#quill-editor', {
                        theme: 'snow',
                        modules: {
                            toolbar: toolbarOptions
                        },
                        placeholder: 'Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...'
                    });
                    
                    logToQuill('ReactQuill ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
                } catch (error) {
                    logToQuill('ReactQuill ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî Ïò§Î•ò: ' + error.message + ' - Í∏∞Î≥∏ ÏóêÎîîÌÑ∞Î°ú ÎåÄÏ≤¥');
                    initBasicQuillEditor();
                }
            }
            
            function initBasicQuillEditor() {
                const editorElement = document.getElementById('quill-editor');
                editorElement.outerHTML = `
                    <textarea id="quill-editor" style="width: 100%; min-height: 300px; padding: 15px; border: 1px solid #d1d5db; border-radius: 8px; font-family: inherit; resize: vertical;" placeholder="Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî..."></textarea>
                `;
                
                // Í∞ÄÏßú ÏóêÎîîÌÑ∞ Í∞ùÏ≤¥
                quillEditor = {
                    root: {
                        innerHTML: function() {
                            return document.getElementById('quill-editor').value;
                        }
                    },
                    setContents: function(content) {
                        document.getElementById('quill-editor').value = Array.isArray(content) ? '' : content.replace(/<[^>]*>/g, '');
                    }
                };
                
                // root.innerHTMLÏùÑ ÏÜçÏÑ±ÏúºÎ°ú ÎßåÎì§Í∏∞
                Object.defineProperty(quillEditor.root, 'innerHTML', {
                    get: function() {
                        return document.getElementById('quill-editor').value;
                    }
                });
                
                logToQuill('Í∏∞Î≥∏ ÌÖçÏä§Ìä∏ ÏóêÎ¶¨Ïñ¥Î°ú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
            }
            
            // Î°úÍ∑∏ Ìï®ÏàòÎì§
            function logToTiptap(message) {
                const logElement = document.getElementById('tiptap-api-log');
                if (logElement) {
                    logElement.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
                    logElement.scrollTop = logElement.scrollHeight;
                }
            }
            
            function logToNovel(message) {
                const logElement = document.getElementById('novel-api-log');
                if (logElement) {
                    logElement.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
                    logElement.scrollTop = logElement.scrollHeight;
                }
            }
            
            function logToQuill(message) {
                const logElement = document.getElementById('quill-api-log');
                if (logElement) {
                    logElement.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
                    logElement.scrollTop = logElement.scrollHeight;
                }
            }
            
            // ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî Ìï®ÏàòÎì§
            
            // Ìèº Ï†úÏ∂ú Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑàÎì§
            document.addEventListener('DOMContentLoaded', function() {
                // Tiptap Ìèº Ï†úÏ∂ú
                const tiptapForm = document.getElementById('tiptapPostForm');
                if (tiptapForm) {
                    tiptapForm.addEventListener('submit', async function(e) {
                        e.preventDefault();
                        
                        const title = document.getElementById('tiptapTitle').value;
                        const service = document.getElementById('tiptapService').value;
                        const content = tiptapEditor ? tiptapEditor.getHTML() : '';
                        
                        if (!title || !service || !content) {
                            logToTiptap('Ïò§Î•ò: Î™®Îì† ÌïÑÎìúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî');
                            return;
                        }
                        
                        try {
                            logToTiptap('Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÏöîÏ≤≠ Ï§ë...');
                            logToTiptap('Ï†úÎ™©: ' + title);
                            logToTiptap('ÏÑúÎπÑÏä§: ' + service);
                            logToTiptap('ÎÇ¥Ïö© Í∏∏Ïù¥: ' + content.length + 'Ïûê');
                            logToTiptap('Tiptap HTML ÎÇ¥Ïö©: ' + content.substring(0, 100) + '...');
                            
                            // Ïã§Ï†ú API Ìò∏Ï∂ú Ïãú Ï£ºÏÑù Ìï¥Ï†ú
                            // const response = await apiCall('/api/posts', 'POST', {
                            //     title: title,
                            //     content: content,
                            //     service: service
                            // });
                            // logToTiptap('Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÏÑ±Í≥µ: ' + JSON.stringify(response));
                            
                            logToTiptap('Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÌÖåÏä§Ìä∏ ÏôÑÎ£å (API Ïó∞Í≤∞ ÌõÑ Ïã§Ï†ú ÏûëÎèô)');
                        } catch (error) {
                            logToTiptap('Í≤åÏãúÍ∏Ä ÏûëÏÑ± Ïò§Î•ò: ' + error.message);
                        }
                    });
                }
                
                // Novel Ìèº Ï†úÏ∂ú
                const novelForm = document.getElementById('novelPostForm');
                if (novelForm) {
                    novelForm.addEventListener('submit', async function(e) {
                        e.preventDefault();
                        
                        const title = document.getElementById('novelTitle').value;
                        const service = document.getElementById('novelService').value;
                        let content = '';
                        
                        if (novelEditor && novelEditor.getContent) {
                            content = novelEditor.getContent();
                        } else {
                            const editorElement = document.getElementById('novel-editor');
                            if (editorElement) {
                                content = editorElement.innerHTML;
                            }
                        }
                        
                        if (!title || !service || !content) {
                            logToNovel('Ïò§Î•ò: Î™®Îì† ÌïÑÎìúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî');
                            return;
                        }
                        
                        try {
                            logToNovel('Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÏöîÏ≤≠ Ï§ë...');
                            logToNovel('Ï†úÎ™©: ' + title);
                            logToNovel('ÏÑúÎπÑÏä§: ' + service);
                            logToNovel('ÎÇ¥Ïö© Í∏∏Ïù¥: ' + content.length + 'Ïûê');
                            logToNovel('Novel HTML ÎÇ¥Ïö©: ' + content.substring(0, 100) + '...');
                            
                            logToNovel('Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÌÖåÏä§Ìä∏ ÏôÑÎ£å (API Ïó∞Í≤∞ ÌõÑ Ïã§Ï†ú ÏûëÎèô)');
                        } catch (error) {
                            logToNovel('Í≤åÏãúÍ∏Ä ÏûëÏÑ± Ïò§Î•ò: ' + error.message);
                        }
                    });
                }
                
                // Quill Ìèº Ï†úÏ∂ú
                const quillForm = document.getElementById('quillPostForm');
                if (quillForm) {
                    quillForm.addEventListener('submit', async function(e) {
                        e.preventDefault();
                        
                        const title = document.getElementById('quillTitle').value;
                        const service = document.getElementById('quillService').value;
                        const content = quillEditor ? quillEditor.root.innerHTML : '';
                        
                        if (!title || !service || !content) {
                            logToQuill('Ïò§Î•ò: Î™®Îì† ÌïÑÎìúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî');
                            return;
                        }
                        
                        try {
                            logToQuill('Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÏöîÏ≤≠ Ï§ë...');
                            logToQuill('Ï†úÎ™©: ' + title);
                            logToQuill('ÏÑúÎπÑÏä§: ' + service);
                            logToQuill('ÎÇ¥Ïö© Í∏∏Ïù¥: ' + content.length + 'Ïûê');
                            logToQuill('Quill HTML ÎÇ¥Ïö©: ' + content.substring(0, 100) + '...');
                            
                            logToQuill('Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÌÖåÏä§Ìä∏ ÏôÑÎ£å (API Ïó∞Í≤∞ ÌõÑ Ïã§Ï†ú ÏûëÎèô)');
                        } catch (error) {
                            logToQuill('Í≤åÏãúÍ∏Ä ÏûëÏÑ± Ïò§Î•ò: ' + error.message);
                        }
                    });
                }
                
                // Ìñ•ÏÉÅÎêú Tiptap Ìèº Ï†úÏ∂ú
                const editorForm = document.getElementById('editorPostForm');
                if (editorForm) {
                    editorForm.addEventListener('submit', async function(e) {
                        e.preventDefault();
                        
                        const title = document.getElementById('editorTitle').value;
                        const service = document.getElementById('editorService').value;
                        const content = enhancedTiptapEditor ? enhancedTiptapEditor.getHTML() : '';
                        
                        if (!title || !service || !content) {
                            logToEnhancedTiptap('Ïò§Î•ò: Î™®Îì† ÌïÑÎìúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî');
                            return;
                        }
                        
                        try {
                            logToEnhancedTiptap('Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÏöîÏ≤≠ Ï§ë...');
                            logToEnhancedTiptap('Ï†úÎ™©: ' + title);
                            logToEnhancedTiptap('ÏÑúÎπÑÏä§: ' + service);
                            logToEnhancedTiptap('ÎÇ¥Ïö© Í∏∏Ïù¥: ' + content.length + 'Ïûê');
                            logToEnhancedTiptap('Ìñ•ÏÉÅÎêú Tiptap HTML ÎÇ¥Ïö©: ' + content.substring(0, 100) + '...');
                            
                            // Ïã§Ï†ú API Ìò∏Ï∂ú Ïãú Ï£ºÏÑù Ìï¥Ï†ú
                            // const response = await apiCall('/api/posts', 'POST', {
                            //     title: title,
                            //     content: content,
                            //     service: service
                            // });
                            // logToEnhancedTiptap('Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÏÑ±Í≥µ: ' + JSON.stringify(response));
                            
                            logToEnhancedTiptap('Í≤åÏãúÍ∏Ä ÏûëÏÑ± ÌÖåÏä§Ìä∏ ÏôÑÎ£å (API Ïó∞Í≤∞ ÌõÑ Ïã§Ï†ú ÏûëÎèô)');
                        } catch (error) {
                            logToEnhancedTiptap('Í≤åÏãúÍ∏Ä ÏûëÏÑ± Ïò§Î•ò: ' + error.message);
                        }
                    });
                }
            });
            
            // ÌéòÏù¥ÏßÄ Ï†ÑÌôò Ïãú ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî
            const originalShowPage = window.showPage;
            window.showPage = function(pageId, targetElement) {
                originalShowPage(pageId, targetElement);
                
                // ÏóêÎîîÌÑ∞ ÌéòÏù¥ÏßÄ Ï†ëÍ∑º Ïãú Ï¥àÍ∏∞Ìôî
                setTimeout(() => {
                    if (pageId === 'editor-tiptap' && !tiptapEditor) {
                        initTiptapEditor();
                    } else if (pageId === 'editor-novel' && !novelEditor) {
                        initNovelEditor();
                    } else if (pageId === 'editor-quill' && !quillEditor) {
                        initQuillEditor();
                    } else if (pageId === 'post-editor' && !enhancedTiptapEditor) {
                        initEnhancedTiptapEditor();
                    }
                    
                    // Ìñ•ÏÉÅÎêú ÏóêÎîîÌÑ∞ ÌéòÏù¥ÏßÄÏóêÏÑú Ìè¨Îß∑ÌåÖ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                    if (pageId === 'post-editor') {
                        setTimeout(updateFormattingState, 200);
                    }
                }, 100);
            };
        });
        
        // Ï†ÑÏó≠ Î≥ÄÏàòÎì§
        var enhancedTiptapEditor = null;
        var tiptapEditor = null;
        var novelEditor = null;
        var quillEditor = null;
        
        // ÌòÑÏû¨ ÏûÖÎ†• Ïä§ÌÉÄÏùº ÏÉÅÌÉú Ï∂îÏ†Å
        var currentInputStyle = {
            color: null,
            fontSize: null,
            fontFamily: null
        };
        
        // Ï†ÑÏó≠ Ìï®ÏàòÎì§ - HTMLÏóêÏÑú ÏßÅÏ†ë Ìò∏Ï∂ú Í∞ÄÎä•ÌïòÎèÑÎ°ù
        
        // Ìñ•ÏÉÅÎêú Tiptap ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî
        function initEnhancedTiptapEditor() {
            // Ïù¥ÎØ∏ Ï¥àÍ∏∞ÌôîÎêòÏóàÎã§Î©¥ Î¶¨ÌÑ¥
            if (enhancedTiptapEditor) {
                logToEnhancedTiptap('Ìñ•ÏÉÅÎêú Tiptap ÏóêÎîîÌÑ∞ Ïù¥ÎØ∏ Ï¥àÍ∏∞ÌôîÎê®');
                return;
            }
            
            try {
                // Tiptap ÎùºÏù¥Î∏åÎü¨Î¶¨Í∞Ä ÏóÜÏùÑ Í≤ΩÏö∞ Í∏∞Î≥∏ ÏóêÎîîÌÑ∞Î°ú Ï¥àÍ∏∞Ìôî
                if (typeof window.TiptapCore === 'undefined') {
                    initBasicEnhancedTiptapEditor();
                    return;
                }
                
                const { Editor } = window.TiptapCore;
                const { StarterKit } = window.TiptapStarterKit;
                
                // Í∏∞Î≥∏ ÌôïÏû• Ï∂îÍ∞Ä
                const extensions = [StarterKit];
                
                // Underline ÌôïÏû•Ïù¥ ÏûàÏúºÎ©¥ Ï∂îÍ∞Ä
                if (window.TiptapUnderline) {
                    extensions.push(window.TiptapUnderline.Underline);
                }
                
                // TextAlign ÌôïÏû•Ïù¥ ÏûàÏúºÎ©¥ Ï∂îÍ∞Ä
                if (window.TiptapTextAlign) {
                    extensions.push(window.TiptapTextAlign.TextAlign.configure({
                        types: ['heading', 'paragraph'],
                    }));
                }
                
                // Image ÌôïÏû•Ïù¥ ÏûàÏúºÎ©¥ Ï∂îÍ∞Ä
                if (window.TiptapImage) {
                    extensions.push(window.TiptapImage.Image);
                }
                
                enhancedTiptapEditor = new Editor({
                    element: document.querySelector('#enhanced-tiptap-editor'),
                    extensions: extensions,
                    content: '<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>',
                    editorProps: {
                        attributes: {
                            style: 'outline: none; min-height: 400px; padding: 20px; line-height: 1.6;'
                        }
                    }
                });
                
                logToEnhancedTiptap('Ìñ•ÏÉÅÎêú Tiptap ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
            } catch (error) {
                logToEnhancedTiptap('Ìñ•ÏÉÅÎêú Tiptap ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî Ïò§Î•ò: ' + error.message + ' - Í∏∞Î≥∏ ÏóêÎîîÌÑ∞Î°ú ÎåÄÏ≤¥');
                initBasicEnhancedTiptapEditor();
            }
        }
        
        function initBasicEnhancedTiptapEditor() {
            const editorElement = document.getElementById('enhanced-tiptap-editor');
            if (!editorElement) return;
            
            editorElement.innerHTML = `
                <div style="padding: 20px; min-height: 400px; line-height: 1.6;">
                    <div contenteditable="true" style="outline: none; min-height: 360px;" id="enhanced-basic-editor">
                        <p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>
                    </div>
                </div>
            `;
            
            const basicEditor = document.getElementById('enhanced-basic-editor');
            
            // Í∞ÄÏßú ÏóêÎîîÌÑ∞ Í∞ùÏ≤¥
            enhancedTiptapEditor = {
                getHTML: function() {
                    return basicEditor.innerHTML;
                },
                chain: function() {
                    return {
                        focus: function() {
                            basicEditor.focus();
                            return {
                                toggleBold: function() { return { run: function() { document.execCommand('bold'); } }; },
                                toggleItalic: function() { return { run: function() { document.execCommand('italic'); } }; },
                                toggleUnderline: function() { return { run: function() { document.execCommand('underline'); } }; },
                                toggleStrike: function() { return { run: function() { document.execCommand('strikeThrough'); } }; },
                                toggleHeading: function(options) { return { run: function() { document.execCommand('formatBlock', false, 'h' + options.level); } }; },
                                toggleBulletList: function() { return { run: function() { document.execCommand('insertUnorderedList'); } }; },
                                toggleOrderedList: function() { return { run: function() { document.execCommand('insertOrderedList'); } }; },
                                toggleBlockquote: function() { return { run: function() { document.execCommand('formatBlock', false, 'blockquote'); } }; },
                                setTextAlign: function(align) { return { run: function() { document.execCommand('justify' + align.charAt(0).toUpperCase() + align.slice(1)); } }; },
                                undo: function() { return { run: function() { document.execCommand('undo'); } }; },
                                redo: function() { return { run: function() { document.execCommand('redo'); } }; }
                            };
                        }
                    };
                },
                commands: {
                    setContent: function(content) {
                        basicEditor.innerHTML = content;
                    }
                }
            };
            
            // Í∏∞Î≥∏ Ïù¥Î≤§Ìä∏ ÏÑ§Ï†ï
            basicEditor.addEventListener('focus', function() {
                if (this.textContent.trim() === 'Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...') {
                    this.innerHTML = '<p><br></p>';
                }
            });
            
            basicEditor.addEventListener('blur', function() {
                if (this.textContent.trim() === '') {
                    this.innerHTML = '<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>';
                }
            });
            
            // ÏûÖÎ†• Ïãú Ìè¨Îß∑ÌåÖ ÏÉÅÌÉú Í∞êÏßÄ Î∞è ÏóÖÎç∞Ïù¥Ìä∏
            basicEditor.addEventListener('keyup', updateFormattingState);
            basicEditor.addEventListener('mouseup', updateFormattingState);
            document.addEventListener('selectionchange', updateFormattingState);
            
            // ÌÇ§ ÏûÖÎ†• Ïãú ÌòÑÏû¨ Ïä§ÌÉÄÏùº Ï†ÅÏö©
            basicEditor.addEventListener('input', function(e) {
                const hasStyle = currentInputStyle.color || currentInputStyle.fontSize || currentInputStyle.fontFamily;
                
                if (hasStyle && e.inputType === 'insertText') {
                    const selection = window.getSelection();
                    if (selection.rangeCount > 0) {
                        const range = selection.getRangeAt(0);
                        
                        // ÌòÑÏû¨ Ïª§ÏÑú ÏúÑÏπòÏùò ÌÖçÏä§Ìä∏ ÎÖ∏Îìú Ï∞æÍ∏∞
                        let textNode = range.startContainer;
                        if (textNode.nodeType === Node.ELEMENT_NODE) {
                            // ÏöîÏÜå ÎÖ∏ÎìúÏù∏ Í≤ΩÏö∞ ÎßàÏßÄÎßâ ÌÖçÏä§Ìä∏ ÎÖ∏Îìú Ï∞æÍ∏∞
                            const walker = document.createTreeWalker(
                                textNode,
                                NodeFilter.SHOW_TEXT,
                                null,
                                false
                            );
                            let lastTextNode = null;
                            while (walker.nextNode()) {
                                lastTextNode = walker.currentNode;
                            }
                            textNode = lastTextNode;
                        }
                        
                        if (textNode && textNode.nodeType === Node.TEXT_NODE) {
                            // ÏûÖÎ†•Îêú Î¨∏ÏûêÏùò ÏúÑÏπò Ï∞æÍ∏∞
                            const offset = range.startOffset;
                            const textContent = textNode.textContent;
                            
                            if (offset > 0) {
                                // ÏÉàÎ°ú ÏûÖÎ†•Îêú ÎßàÏßÄÎßâ Î¨∏ÏûêÎ•º spanÏúºÎ°ú Í∞êÏã∏Í∏∞
                                const beforeText = textContent.substring(0, offset - 1);
                                const newChar = textContent.charAt(offset - 1);
                                const afterText = textContent.substring(offset);
                                
                                // ÌÖçÏä§Ìä∏ ÎÖ∏Îìú ÍµêÏ≤¥
                                const parent = textNode.parentNode;
                                
                                // Ïù¥Ï†Ñ ÌÖçÏä§Ìä∏
                                if (beforeText) {
                                    const beforeTextNode = document.createTextNode(beforeText);
                                    parent.insertBefore(beforeTextNode, textNode);
                                }
                                
                                // ÏÉà Î¨∏ÏûêÎ•º Ïä§ÌÉÄÏùºÏù¥ Ï†ÅÏö©Îêú spanÏúºÎ°ú
                                const span = document.createElement('span');
                                if (currentInputStyle.color) span.style.color = currentInputStyle.color;
                                if (currentInputStyle.fontSize) span.style.fontSize = currentInputStyle.fontSize;
                                if (currentInputStyle.fontFamily) span.style.fontFamily = currentInputStyle.fontFamily;
                                span.appendChild(document.createTextNode(newChar));
                                parent.insertBefore(span, textNode);
                                
                                // Ïù¥ÌõÑ ÌÖçÏä§Ìä∏
                                if (afterText) {
                                    const afterTextNode = document.createTextNode(afterText);
                                    parent.insertBefore(afterTextNode, textNode);
                                }
                                
                                // ÏõêÎûò ÌÖçÏä§Ìä∏ ÎÖ∏Îìú Ï†úÍ±∞
                                parent.removeChild(textNode);
                                
                                // Ïª§ÏÑúÎ•º span Îã§ÏùåÏúºÎ°ú Ïù¥Îèô
                                const newRange = document.createRange();
                                if (afterText) {
                                    newRange.setStart(afterTextNode, 0);
                                } else {
                                    newRange.setStartAfter(span);
                                }
                                newRange.collapse(true);
                                selection.removeAllRanges();
                                selection.addRange(newRange);
                            }
                        }
                    }
                }
            });
            
            basicEditor.addEventListener('keydown', function(e) {
                const hasStyle = currentInputStyle.color || currentInputStyle.fontSize || currentInputStyle.fontFamily;
                // Enter ÌÇ§ Ï≤òÎ¶¨ - ÏÉà Ï§ÑÏóêÏÑúÎèÑ Ïä§ÌÉÄÏùº Ïú†ÏßÄ
                if (e.key === 'Enter' && hasStyle) {
                    const selection = window.getSelection();
                    if (selection.rangeCount > 0) {
                        const range = selection.getRangeAt(0);
                        
                        if (range.collapsed) {
                            e.preventDefault();
                            
                            // ÏÉà Ï§Ñ ÏÇΩÏûÖ
                            document.execCommand('insertHTML', false, '<br>');
                            
                            // Ïä§ÌÉÄÏùºÏù¥ Ï†ÅÏö©Îêú span ÏÇΩÏûÖ Ï§ÄÎπÑ
                            setTimeout(() => {
                                const newSelection = window.getSelection();
                                if (newSelection.rangeCount > 0) {
                                    const newRange = newSelection.getRangeAt(0);
                                    
                                    const span = document.createElement('span');
                                    if (currentInputStyle.color) span.style.color = currentInputStyle.color;
                                    if (currentInputStyle.fontSize) span.style.fontSize = currentInputStyle.fontSize;
                                    if (currentInputStyle.fontFamily) span.style.fontFamily = currentInputStyle.fontFamily;
                                    
                                    span.appendChild(document.createTextNode('\u00A0')); // ÎπÑÏñ¥ÏûàÏßÄ ÏïäÏùÄ Í≥µÍ∞Ñ
                                    newRange.insertNode(span);
                                    
                                    // Ïª§ÏÑúÎ•º span ÏïàÏúºÎ°ú Ïù¥Îèô
                                    const finalRange = document.createRange();
                                    finalRange.setStart(span.firstChild, 1);
                                    finalRange.collapse(true);
                                    newSelection.removeAllRanges();
                                    newSelection.addRange(finalRange);
                                }
                            }, 10);
                        }
                    }
                }
            });
            
            logToEnhancedTiptap('Í∏∞Î≥∏ contenteditable ÏóêÎîîÌÑ∞Î°ú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
            
            // Ï¥àÍ∏∞ Ìè¨Îß∑ÌåÖ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            setTimeout(updateFormattingState, 100);
        }
        
        // Ìñ•ÏÉÅÎêú Tiptap ÏóêÎîîÌÑ∞ Í∏∞Îä• Ìï®ÏàòÎì§
        function changeFontFamily(fontFamily) {
            if (fontFamily) {
                // ÏóêÎîîÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ ÏûêÎèô Ï¥àÍ∏∞Ìôî
                if (!enhancedTiptapEditor) {
                    initEnhancedTiptapEditor();
                }
                
                const editorElement = document.getElementById('enhanced-tiptap-editor') || document.getElementById('enhanced-basic-editor');
                if (editorElement) {
                    editorElement.focus();
                    
                    // ÌòÑÏû¨ ÏÑ†ÌÉùÎêú ÌÖçÏä§Ìä∏ ÎòêÎäî Ïª§ÏÑú ÏúÑÏπòÏóê Ï†ÅÏö©
                    const selection = window.getSelection();
                    if (selection.rangeCount > 0) {
                        const range = selection.getRangeAt(0);
                        
                        if (range.collapsed) {
                            // ÏÑ†ÌÉùÎêú ÌÖçÏä§Ìä∏Í∞Ä ÏóÜÏúºÎ©¥ Îã§Ïùå ÏûÖÎ†•Ïóê Ï†ÅÏö©
                            currentInputStyle.fontFamily = fontFamily;
                            logToEnhancedTiptap('Îã§Ïùå ÏûÖÎ†• ÌÖçÏä§Ìä∏Ïóê Ìè∞Ìä∏ Ï†ÅÏö© ÏòàÏ†ï: ' + fontFamily);
                            displayCurrentInputStyle();
                        } else {
                            // ÏÑ†ÌÉùÎêú ÌÖçÏä§Ìä∏Í∞Ä ÏûàÏúºÎ©¥ Ìï¥Îãπ ÌÖçÏä§Ìä∏Ïóê Ï†ÅÏö©
                            document.execCommand('fontName', false, fontFamily);
                        }
                    } else {
                        // ÏÑ†ÌÉùÏù¥ ÏóÜÏúºÎ©¥ Ï†ÑÏ≤¥ ÏóêÎîîÌÑ∞Ïóê Í∏∞Î≥∏ Ìè∞Ìä∏ ÏÑ§Ï†ï
                        editorElement.style.fontFamily = fontFamily;
                    }
                    
                    // ÌòÑÏû¨ ÏÉÅÌÉú ÌëúÏãú
                    updateFontFamilyDisplay(fontFamily);
                }
            }
            // ÎìúÎ°≠Îã§Ïö¥ ÏÉÅÌÉúÎäî updateFontFamilyDisplayÏóêÏÑú Ï≤òÎ¶¨
        }
        
        function changeFontSize(fontSize) {
            if (fontSize) {
                // ÏóêÎîîÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ ÏûêÎèô Ï¥àÍ∏∞Ìôî
                if (!enhancedTiptapEditor) {
                    initEnhancedTiptapEditor();
                }
                
                const editorElement = document.getElementById('enhanced-tiptap-editor') || document.getElementById('enhanced-basic-editor');
                if (editorElement) {
                    editorElement.focus();
                    
                    // ÌòÑÏû¨ ÏÑ†ÌÉùÎêú ÌÖçÏä§Ìä∏ ÎòêÎäî Ïª§ÏÑú ÏúÑÏπòÏóê Ï†ÅÏö©
                    const selection = window.getSelection();
                    if (selection.rangeCount > 0) {
                        const range = selection.getRangeAt(0);
                        
                        if (range.collapsed) {
                            // ÏÑ†ÌÉùÎêú ÌÖçÏä§Ìä∏Í∞Ä ÏóÜÏúºÎ©¥ Îã§Ïùå ÏûÖÎ†•Ïóê Ï†ÅÏö©
                            currentInputStyle.fontSize = fontSize;
                            logToEnhancedTiptap('Îã§Ïùå ÏûÖÎ†• ÌÖçÏä§Ìä∏Ïóê ÌÅ¨Í∏∞ Ï†ÅÏö© ÏòàÏ†ï: ' + fontSize);
                            displayCurrentInputStyle();
                        } else {
                            // ÏÑ†ÌÉùÎêú ÌÖçÏä§Ìä∏Í∞Ä ÏûàÏúºÎ©¥ Ìï¥Îãπ ÌÖçÏä§Ìä∏Ïóê Ï†ÅÏö©
                            const span = document.createElement('span');
                            span.style.fontSize = fontSize;
                            try {
                                range.surroundContents(span);
                            } catch (e) {
                                span.appendChild(range.extractContents());
                                range.insertNode(span);
                            }
                        }
                    } else {
                        // ÏÑ†ÌÉùÏù¥ ÏóÜÏúºÎ©¥ Ï†ÑÏ≤¥ ÏóêÎîîÌÑ∞Ïóê Í∏∞Î≥∏ ÌÅ¨Í∏∞ ÏÑ§Ï†ï
                        editorElement.style.fontSize = fontSize;
                    }
                    
                    // ÌòÑÏû¨ ÏÉÅÌÉú ÌëúÏãú
                    updateFontSizeDisplay(fontSize);
                }
            }
            // ÎìúÎ°≠Îã§Ïö¥ ÏÉÅÌÉúÎäî updateFontSizeDisplayÏóêÏÑú Ï≤òÎ¶¨
        }
        
        function changeTextColor(color) {
            if (color) {
                // ÏóêÎîîÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ ÏûêÎèô Ï¥àÍ∏∞Ìôî
                if (!enhancedTiptapEditor) {
                    initEnhancedTiptapEditor();
                }
                
                const editorElement = document.getElementById('enhanced-tiptap-editor') || document.getElementById('enhanced-basic-editor');
                if (editorElement) {
                    editorElement.focus();
                    
                    const selection = window.getSelection();
                    if (selection.rangeCount > 0) {
                        const range = selection.getRangeAt(0);
                        
                        if (range.collapsed) {
                            // ÏÑ†ÌÉùÎêú ÌÖçÏä§Ìä∏Í∞Ä ÏóÜÏúºÎ©¥ Îã§Ïùå ÏûÖÎ†•Ïóê Ï†ÅÏö©
                            currentInputStyle.color = color;
                            logToEnhancedTiptap('Îã§Ïùå ÏûÖÎ†• ÌÖçÏä§Ìä∏Ïóê ÏÉâÏÉÅ Ï†ÅÏö© ÏòàÏ†ï: ' + color);
                            displayCurrentInputStyle();
                        } else {
                            // ÏÑ†ÌÉùÎêú ÌÖçÏä§Ìä∏Í∞Ä ÏûàÏúºÎ©¥ Ï¶âÏãú Ï†ÅÏö©
                            document.execCommand('foreColor', false, color);
                            logToEnhancedTiptap('ÏÑ†ÌÉùÎêú ÌÖçÏä§Ìä∏Ïóê ÏÉâÏÉÅ Ï†ÅÏö©: ' + color);
                        }
                    }
                    
                    // ÏÉâÏÉÅ ÏÑ†ÌÉùÍ∏∞ ÏÉÅÌÉú ÌëúÏãú
                    const colorPicker = document.getElementById('textColor');
                    if (colorPicker) {
                        colorPicker.style.border = '2px solid #3b82f6';
                        colorPicker.value = color;
                        
                        // ÏÉâÏÉÅ ÏÑ†ÌÉùÍ∏∞ ÌïòÏù¥ÎùºÏù¥Ìä∏ Ïú†ÏßÄ (3Ï¥à)
                        setTimeout(() => {
                            colorPicker.style.border = '1px solid #d1d5db';
                        }, 3000);
                    }
                }
            }
        }
        
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageUrl = e.target.result;
                    
                    if (enhancedTiptapEditor && enhancedTiptapEditor.chain && typeof enhancedTiptapEditor.chain === 'function') {
                        // Tiptap ÏóêÎîîÌÑ∞Í∞Ä Ï†ïÏÉÅ ÏûëÎèôÌïòÎäî Í≤ΩÏö∞
                        try {
                            enhancedTiptapEditor.chain().focus().setImage({ src: imageUrl }).run();
                        } catch (error) {
                            // Ïù¥ÎØ∏ÏßÄ ÌôïÏû•Ïù¥ ÏóÜÎäî Í≤ΩÏö∞ HTMLÎ°ú ÏßÅÏ†ë ÏÇΩÏûÖ
                            insertImageAsHTML(imageUrl);
                        }
                    } else {
                        // Í∏∞Î≥∏ ÏóêÎîîÌÑ∞Ïù∏ Í≤ΩÏö∞
                        insertImageAsHTML(imageUrl);
                    }
                    
                    logToEnhancedTiptap('Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú ÏôÑÎ£å: ' + file.name);
                };
                reader.readAsDataURL(file);
            } else {
                logToEnhancedTiptap('Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ Ïù¥ÎØ∏ÏßÄ ÌååÏùºÏûÖÎãàÎã§.');
            }
            
            // ÌååÏùº ÏûÖÎ†• Ï¥àÍ∏∞Ìôî
            event.target.value = '';
        }
        
        function insertImageAsHTML(imageUrl) {
            const editorElement = document.getElementById('enhanced-basic-editor') || document.getElementById('enhanced-tiptap-editor');
            if (editorElement) {
                editorElement.focus();
                const img = `<img src="${imageUrl}" style="max-width: 100%; height: auto; margin: 10px 0;" alt="ÏóÖÎ°úÎìúÎêú Ïù¥ÎØ∏ÏßÄ">`;
                document.execCommand('insertHTML', false, img);
            }
        }
        
        function clearEnhancedTiptapEditor() {
            if (enhancedTiptapEditor && enhancedTiptapEditor.commands) {
                enhancedTiptapEditor.commands.setContent('<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>');
            } else {
                const basicEditor = document.getElementById('enhanced-basic-editor');
                if (basicEditor) {
                    basicEditor.innerHTML = '<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>';
                }
            }
            const titleInput = document.getElementById('editorTitle');
            const serviceSelect = document.getElementById('editorService');
            
            if (titleInput) titleInput.value = '';
            if (serviceSelect) serviceSelect.value = '';
            
            // ÌòÑÏû¨ ÏûÖÎ†• Ïä§ÌÉÄÏùº Ï¥àÍ∏∞Ìôî
            currentInputStyle = {
                color: null,
                fontSize: null,
                fontFamily: null
            };
            
            // Î™®Îì† Ìà¥Î∞î Î≤ÑÌäº Ï¥àÍ∏∞Ìôî
            ['btn-bold', 'btn-italic', 'btn-underline', 'btn-strike', 'btn-h1', 'btn-h2', 'btn-h3', 
             'btn-bullet', 'btn-ordered', 'btn-align-left', 'btn-align-center', 'btn-align-right', 'btn-quote'].forEach(id => {
                const btn = document.getElementById(id);
                if (btn) {
                    btn.style.background = 'white';
                    btn.style.color = 'black';
                }
            });
            
            logToEnhancedTiptap('ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
        }
        
        function logToEnhancedTiptap(message) {
            const logElement = document.getElementById('enhanced-tiptap-api-log');
            if (logElement) {
                logElement.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
                logElement.scrollTop = logElement.scrollHeight;
            }
        }
        
        function clearEnhancedTiptapLog() {
            const logElement = document.getElementById('enhanced-tiptap-api-log');
            if (logElement) {
                logElement.innerHTML = 'Ìñ•ÏÉÅÎêú Tiptap ÏóêÎîîÌÑ∞ Ï§ÄÎπÑ ÏôÑÎ£å';
            }
        }
        
        // Ìà¥Î∞î Î≤ÑÌäº ÏÉÅÌÉú Í¥ÄÎ¶¨ Ìï®ÏàòÎì§
        function toggleFormatAndHighlight(format, button) {
            // ÏóêÎîîÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ ÏûêÎèô Ï¥àÍ∏∞Ìôî
            if (!enhancedTiptapEditor) {
                initEnhancedTiptapEditor();
            }
            
            const editorElement = document.getElementById('enhanced-tiptap-editor') || document.getElementById('enhanced-basic-editor');
            if (editorElement) {
                editorElement.focus();
                
                // Ìè¨Îß∑ Ï†ÅÏö©
                switch(format) {
                    case 'bold':
                        if (enhancedTiptapEditor?.chain) {
                            enhancedTiptapEditor.chain().focus().toggleBold().run();
                        } else {
                            document.execCommand('bold');
                        }
                        break;
                    case 'italic':
                        if (enhancedTiptapEditor?.chain) {
                            enhancedTiptapEditor.chain().focus().toggleItalic().run();
                        } else {
                            document.execCommand('italic');
                        }
                        break;
                    case 'underline':
                        if (enhancedTiptapEditor?.chain) {
                            enhancedTiptapEditor.chain().focus().toggleUnderline().run();
                        } else {
                            document.execCommand('underline');
                        }
                        break;
                    case 'strike':
                        if (enhancedTiptapEditor?.chain) {
                            enhancedTiptapEditor.chain().focus().toggleStrike().run();
                        } else {
                            document.execCommand('strikeThrough');
                        }
                        break;
                }
                
                // Î≤ÑÌäº ÏÉÅÌÉú ÌÜ†Í∏Ä
                if (button.style.background === 'rgb(59, 130, 246)' || button.style.background === '#3b82f6') {
                    button.style.background = 'white';
                    button.style.color = 'black';
                } else {
                    button.style.background = '#3b82f6';
                    button.style.color = 'white';
                }
                
                logToEnhancedTiptap(format + ' Ìè¨Îß∑ Ï†ÅÏö©/Ìï¥Ï†ú');
            }
        }
        
        function toggleHeadingAndHighlight(level, button) {
            // ÏóêÎîîÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ ÏûêÎèô Ï¥àÍ∏∞Ìôî
            if (!enhancedTiptapEditor) {
                initEnhancedTiptapEditor();
            }
            
            const editorElement = document.getElementById('enhanced-tiptap-editor') || document.getElementById('enhanced-basic-editor');
            if (editorElement) {
                editorElement.focus();
                
                const selection = window.getSelection();
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    
                    // ÌòÑÏû¨ Îã®ÎùΩÏùò Ìó§Îî© ÏÉÅÌÉú ÌôïÏù∏
                    let currentElement = range.startContainer;
                    if (currentElement.nodeType === Node.TEXT_NODE) {
                        currentElement = currentElement.parentNode;
                    }
                    
                    // Î∂ÄÎ™® ÏöîÏÜå Ï§ëÏóêÏÑú Ìó§Îî© ÌÉúÍ∑∏ Ï∞æÍ∏∞
                    let currentHeading = null;
                    let tempElement = currentElement;
                    while (tempElement && tempElement !== editorElement) {
                        if (tempElement.tagName && /^H[1-6]$/.test(tempElement.tagName)) {
                            currentHeading = tempElement;
                            break;
                        }
                        tempElement = tempElement.parentNode;
                    }
                    
                    const targetTag = 'H' + level;
                    
                    // Ïù¥ÎØ∏ Í∞ôÏùÄ Î†àÎ≤®Ïùò Ìó§Îî©Ïù¥Î©¥ Ìï¥Ï†ú, ÏïÑÎãàÎ©¥ Ï†ÅÏö©
                    if (currentHeading && currentHeading.tagName === targetTag) {
                        // Ìó§Îî© Ìï¥Ï†ú - p ÌÉúÍ∑∏Î°ú Î≥ÄÍ≤Ω
                        const p = document.createElement('p');
                        p.innerHTML = currentHeading.innerHTML;
                        currentHeading.parentNode.replaceChild(p, currentHeading);
                        
                        // Î™®Îì† Ìó§Îî© Î≤ÑÌäº ÎπÑÌôúÏÑ±Ìôî
                        ['btn-h1', 'btn-h2', 'btn-h3'].forEach(id => {
                            const btn = document.getElementById(id);
                            if (btn) {
                                btn.style.background = 'white';
                                btn.style.color = 'black';
                            }
                        });
                        
                        logToEnhancedTiptap('H' + level + ' Ìó§Îî© Ìï¥Ï†ú');
                    } else {
                        // Ìó§Îî© Ï†ÅÏö©
                        if (enhancedTiptapEditor?.chain) {
                            enhancedTiptapEditor.chain().focus().toggleHeading({ level: level }).run();
                        } else {
                            document.execCommand('formatBlock', false, 'h' + level);
                        }
                        
                        // Îã§Î•∏ Ìó§Îî© Î≤ÑÌäºÎì§ Ï¥àÍ∏∞Ìôî
                        ['btn-h1', 'btn-h2', 'btn-h3'].forEach(id => {
                            const btn = document.getElementById(id);
                            if (btn && btn !== button) {
                                btn.style.background = 'white';
                                btn.style.color = 'black';
                            }
                        });
                        
                        // ÌòÑÏû¨ Î≤ÑÌäº ÌôúÏÑ±Ìôî
                        button.style.background = '#3b82f6';
                        button.style.color = 'white';
                        
                        logToEnhancedTiptap('H' + level + ' Ìó§Îî© Ï†ÅÏö© (ÌòÑÏû¨ Îã®ÎùΩ Ï†ÑÏ≤¥)');
                    }
                    
                    // Ïª§ÏÑú ÏúÑÏπò Î≥µÏõê
                    setTimeout(() => {
                        const newSelection = window.getSelection();
                        const newRange = document.createRange();
                        try {
                            newRange.setStart(range.startContainer, range.startOffset);
                            newRange.collapse(true);
                            newSelection.removeAllRanges();
                            newSelection.addRange(newRange);
                        } catch (e) {
                            // Ïª§ÏÑú Î≥µÏõê Ïã§Ìå® Ïãú ÏóêÎîîÌÑ∞ ÎÅùÏúºÎ°ú Ïù¥Îèô
                            newRange.selectNodeContents(editorElement);
                            newRange.collapse(false);
                            newSelection.removeAllRanges();
                            newSelection.addRange(newRange);
                        }
                    }, 10);
                }
            }
        }
        
        function toggleListAndHighlight(type, button) {
            // ÏóêÎîîÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ ÏûêÎèô Ï¥àÍ∏∞Ìôî
            if (!enhancedTiptapEditor) {
                initEnhancedTiptapEditor();
            }
            
            const editorElement = document.getElementById('enhanced-tiptap-editor') || document.getElementById('enhanced-basic-editor');
            if (editorElement) {
                editorElement.focus();
                
                // ÌòÑÏû¨ Ïª§ÏÑú ÏúÑÏπò Ï†ÄÏû•
                const selection = window.getSelection();
                let savedRange = null;
                let cursorOffset = 0;
                
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    savedRange = range.cloneRange();
                    
                    // ÌòÑÏû¨ ÎÖ∏Îìú ÎÇ¥ÏóêÏÑúÏùò Ïª§ÏÑú Ïò§ÌîÑÏÖã Ï†ÄÏû•
                    if (range.startContainer.nodeType === Node.TEXT_NODE) {
                        cursorOffset = range.startOffset;
                    }
                }
                
                // Îã§Î•∏ Î¶¨Ïä§Ìä∏ Î≤ÑÌäº Ï¥àÍ∏∞Ìôî
                const otherButton = type === 'bullet' ? document.getElementById('btn-ordered') : document.getElementById('btn-bullet');
                if (otherButton) {
                    otherButton.style.background = 'white';
                    otherButton.style.color = 'black';
                }
                
                // Î¶¨Ïä§Ìä∏ Ï†ÅÏö©
                if (type === 'bullet') {
                    if (enhancedTiptapEditor?.chain) {
                        enhancedTiptapEditor.chain().focus().toggleBulletList().run();
                    } else {
                        document.execCommand('insertUnorderedList');
                    }
                } else {
                    if (enhancedTiptapEditor?.chain) {
                        enhancedTiptapEditor.chain().focus().toggleOrderedList().run();
                    } else {
                        document.execCommand('insertOrderedList');
                    }
                }
                
                // Ïª§ÏÑú ÏúÑÏπò Î≥µÏõê
                if (savedRange) {
                    setTimeout(() => {
                        try {
                            // Î¶¨Ïä§Ìä∏Í∞Ä Ï†ÅÏö©Îêú ÌõÑ ÌòÑÏû¨ Ïª§ÏÑúÍ∞Ä ÏûàÎäî Î¶¨Ïä§Ìä∏ ÏïÑÏù¥ÌÖú Ï∞æÍ∏∞
                            const currentSelection = window.getSelection();
                            if (currentSelection.rangeCount > 0) {
                                const currentRange = currentSelection.getRangeAt(0);
                                let listItem = currentRange.startContainer;
                                
                                // Î¶¨Ïä§Ìä∏ ÏïÑÏù¥ÌÖú Ï∞æÍ∏∞
                                while (listItem && listItem.nodeName !== 'LI' && listItem.parentNode) {
                                    listItem = listItem.parentNode;
                                }
                                
                                if (listItem && listItem.nodeName === 'LI') {
                                    // Î¶¨Ïä§Ìä∏ ÏïÑÏù¥ÌÖú ÎÇ¥Ïùò ÌÖçÏä§Ìä∏ ÎÖ∏Îìú Ï∞æÍ∏∞
                                    const textNode = findTextNode(listItem);
                                    if (textNode) {
                                        const newRange = document.createRange();
                                        const offset = Math.min(cursorOffset, textNode.textContent.length);
                                        newRange.setStart(textNode, offset);
                                        newRange.collapse(true);
                                        currentSelection.removeAllRanges();
                                        currentSelection.addRange(newRange);
                                    }
                                }
                            }
                        } catch (e) {
                            // Ïª§ÏÑú Î≥µÏõê Ïã§Ìå® Ïãú Î¨¥Ïãú
                        }
                    }, 10);
                }
                
                // Î≤ÑÌäº ÏÉÅÌÉú ÌÜ†Í∏Ä
                if (button.style.background === 'rgb(59, 130, 246)' || button.style.background === '#3b82f6') {
                    button.style.background = 'white';
                    button.style.color = 'black';
                    logToEnhancedTiptap((type === 'bullet' ? 'Î∂àÎ¶ø' : 'Î≤àÌò∏') + ' Î¶¨Ïä§Ìä∏ Ìï¥Ï†ú');
                } else {
                    button.style.background = '#3b82f6';
                    button.style.color = 'white';
                    logToEnhancedTiptap((type === 'bullet' ? 'Î∂àÎ¶ø' : 'Î≤àÌò∏') + ' Î¶¨Ïä§Ìä∏ Ï†ÅÏö©');
                }
                
                // Ìè¨Îß∑ÌåÖ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                setTimeout(updateFormattingState, 50);
            }
        }
        
        // ÌÖçÏä§Ìä∏ ÎÖ∏Îìú Ï∞æÍ∏∞ Ìó¨Ìçº Ìï®Ïàò
        function findTextNode(element) {
            if (element.nodeType === Node.TEXT_NODE && element.textContent.trim()) {
                return element;
            }
            for (let child of element.childNodes) {
                const textNode = findTextNode(child);
                if (textNode) return textNode;
            }
            return null;
        }
        
        function setAlignAndHighlight(align, button) {
            // ÏóêÎîîÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ ÏûêÎèô Ï¥àÍ∏∞Ìôî
            if (!enhancedTiptapEditor) {
                initEnhancedTiptapEditor();
            }
            
            const editorElement = document.getElementById('enhanced-tiptap-editor') || document.getElementById('enhanced-basic-editor');
            if (editorElement) {
                editorElement.focus();
                
                // Îã§Î•∏ Ï†ïÎ†¨ Î≤ÑÌäºÎì§ Ï¥àÍ∏∞Ìôî
                ['btn-align-left', 'btn-align-center', 'btn-align-right'].forEach(id => {
                    const btn = document.getElementById(id);
                    if (btn && btn !== button) {
                        btn.style.background = 'white';
                        btn.style.color = 'black';
                    }
                });
                
                // Ï†ïÎ†¨ Ï†ÅÏö©
                if (enhancedTiptapEditor?.chain) {
                    enhancedTiptapEditor.chain().focus().setTextAlign(align).run();
                } else {
                    const command = 'justify' + align.charAt(0).toUpperCase() + align.slice(1);
                    document.execCommand(command);
                }
                
                // Î≤ÑÌäº ÌôúÏÑ±Ìôî
                button.style.background = '#3b82f6';
                button.style.color = 'white';
                
                logToEnhancedTiptap(align + ' Ï†ïÎ†¨ Ï†ÅÏö©');
            }
        }
        
        function toggleQuoteAndHighlight(button) {
            // ÏóêÎîîÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ ÏûêÎèô Ï¥àÍ∏∞Ìôî
            if (!enhancedTiptapEditor) {
                initEnhancedTiptapEditor();
            }
            
            const editorElement = document.getElementById('enhanced-tiptap-editor') || document.getElementById('enhanced-basic-editor');
            if (editorElement) {
                editorElement.focus();
                
                // Ïù∏Ïö© Ï†ÅÏö©
                if (enhancedTiptapEditor?.chain) {
                    enhancedTiptapEditor.chain().focus().toggleBlockquote().run();
                } else {
                    document.execCommand('formatBlock', false, 'blockquote');
                }
                
                // Î≤ÑÌäº ÏÉÅÌÉú ÌÜ†Í∏Ä
                if (button.style.background === 'rgb(59, 130, 246)' || button.style.background === '#3b82f6') {
                    button.style.background = 'white';
                    button.style.color = 'black';
                    logToEnhancedTiptap('Ïù∏Ïö© Ìï¥Ï†ú');
                } else {
                    button.style.background = '#3b82f6';
                    button.style.color = 'white';
                    logToEnhancedTiptap('Ïù∏Ïö© Ï†ÅÏö©');
                }
            }
        }
        
        function updateFontSizeDisplay(fontSize) {
            // ÌòÑÏû¨ ÏÑ†ÌÉùÎêú Ìè∞Ìä∏ ÌÅ¨Í∏∞Î•º Ìà¥Î∞îÏóê ÌëúÏãú
            const sizeSelect = document.getElementById('fontSize');
            if (sizeSelect) {
                // ÏÑ†ÌÉùÎêú Í∞íÏùÑ ÎìúÎ°≠Îã§Ïö¥Ïóê Ïú†ÏßÄ
                for (let i = 0; i < sizeSelect.options.length; i++) {
                    if (sizeSelect.options[i].value === fontSize) {
                        sizeSelect.selectedIndex = i;
                        sizeSelect.style.background = '#eff6ff';
                        sizeSelect.style.color = '#2563eb';
                        
                        // 3Ï¥à ÌõÑ Í∏∞Î≥∏Í∞íÏúºÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞
                        setTimeout(() => {
                            if (sizeSelect.selectedIndex === i) { // ÏïÑÏßÅ Í∞ôÏùÄ ÏÉÅÌÉúÏù¥Î©¥
                                sizeSelect.selectedIndex = 0;
                                sizeSelect.style.background = 'white';
                                sizeSelect.style.color = 'black';
                            }
                        }, 3000);
                        break;
                    }
                }
            }
        }
        
        function updateFontFamilyDisplay(fontFamily) {
            // ÌòÑÏû¨ ÏÑ†ÌÉùÎêú Ìè∞Ìä∏Î•º Ìà¥Î∞îÏóê ÌëúÏãú
            const fontSelect = document.getElementById('fontFamily');
            if (fontSelect) {
                // ÏÑ†ÌÉùÎêú Í∞íÏùÑ ÎìúÎ°≠Îã§Ïö¥Ïóê Ïú†ÏßÄ
                for (let i = 0; i < fontSelect.options.length; i++) {
                    if (fontSelect.options[i].value === fontFamily) {
                        fontSelect.selectedIndex = i;
                        fontSelect.style.background = '#eff6ff';
                        fontSelect.style.color = '#2563eb';
                        
                        // 3Ï¥à ÌõÑ Í∏∞Î≥∏Í∞íÏúºÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞
                        setTimeout(() => {
                            if (fontSelect.selectedIndex === i) { // ÏïÑÏßÅ Í∞ôÏùÄ ÏÉÅÌÉúÏù¥Î©¥
                                fontSelect.selectedIndex = 0;
                                fontSelect.style.background = 'white';
                                fontSelect.style.color = 'black';
                            }
                        }, 3000);
                        break;
                    }
                }
            }
        }
        
        // Novel ÏóêÎîîÌÑ∞ Î™ÖÎ†π Ïã§Ìñâ Ìï®Ïàò
        function execNovelCommand(command, value = null) {
            try {
                const editorElement = document.getElementById('novel-editor');
                if (editorElement) {
                    editorElement.focus();
                    
                    if (value) {
                        document.execCommand(command, false, value);
                    } else {
                        document.execCommand(command, false, null);
                    }
                    
                    // Ìè¨Ïª§Ïä§ Ïú†ÏßÄ
                    editorElement.focus();
                }
            } catch (error) {
                const logElement = document.getElementById('novel-api-log');
                if (logElement) {
                    logElement.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': Î™ÖÎ†π Ïã§Ìñâ Ïò§Î•ò: ' + error.message + '</div>';
                }
            }
        }
        
        // Ìè¨Îß∑ÌåÖ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function updateFormattingState() {
            // ÏóêÎîîÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏúºÎ©¥ Î¶¨ÌÑ¥
            if (!enhancedTiptapEditor) return;
            
            try {
                // Í∏∞Î≥∏ Ìè¨Îß∑ÌåÖ Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                updateButtonState('btn-bold', document.queryCommandState('bold'));
                updateButtonState('btn-italic', document.queryCommandState('italic'));
                updateButtonState('btn-underline', document.queryCommandState('underline'));
                updateButtonState('btn-strike', document.queryCommandState('strikeThrough'));
                
                // Ìó§Îî© ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                const formatBlock = document.queryCommandValue('formatBlock').toLowerCase();
                ['btn-h1', 'btn-h2', 'btn-h3'].forEach(id => {
                    const btn = document.getElementById(id);
                    if (btn) {
                        const level = id.replace('btn-h', '');
                        const active = formatBlock === 'h' + level || formatBlock === 'heading';
                        updateButtonState(id, active);
                    }
                });
                
                // Î¶¨Ïä§Ìä∏ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                updateButtonState('btn-bullet', document.queryCommandState('insertUnorderedList'));
                updateButtonState('btn-ordered', document.queryCommandState('insertOrderedList'));
                
                // Ï†ïÎ†¨ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                const justifyState = {
                    left: document.queryCommandState('justifyLeft'),
                    center: document.queryCommandState('justifyCenter'),
                    right: document.queryCommandState('justifyRight')
                };
                
                ['btn-align-left', 'btn-align-center', 'btn-align-right'].forEach(id => {
                    const align = id.replace('btn-align-', '');
                    updateButtonState(id, justifyState[align]);
                });
                
                // Ïù∏Ïö© ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                const blockquoteState = document.queryCommandValue('formatBlock').toLowerCase() === 'blockquote';
                updateButtonState('btn-quote', blockquoteState);
            } catch (error) {
                // ÏóêÎü¨ Î¨¥Ïãú (Î∏åÎùºÏö∞Ï†Ä Ìò∏ÌôòÏÑ± Î¨∏Ï†ú)
            }
        }
        
        // Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏ Ìó¨Ìçº Ìï®Ïàò
        function updateButtonState(buttonId, isActive) {
            const button = document.getElementById(buttonId);
            if (button) {
                if (isActive) {
                    button.style.background = '#3b82f6';
                    button.style.color = 'white';
                } else {
                    button.style.background = 'white';
                    button.style.color = 'black';
                }
            }
        }
        
        // ÌòÑÏû¨ ÏûÖÎ†• Ïä§ÌÉÄÏùº ÌëúÏãú Ìï®Ïàò
        function displayCurrentInputStyle() {
            const styles = [];
            if (currentInputStyle.color) {
                styles.push('ÏÉâÏÉÅ: ' + currentInputStyle.color);
            }
            if (currentInputStyle.fontSize) {
                styles.push('ÌÅ¨Í∏∞: ' + currentInputStyle.fontSize);
            }
            if (currentInputStyle.fontFamily) {
                styles.push('Ìè∞Ìä∏: ' + currentInputStyle.fontFamily);
            }
            
            if (styles.length > 0) {
                logToEnhancedTiptap('ÌòÑÏû¨ ÏûÖÎ†• Ïä§ÌÉÄÏùº: ' + styles.join(', '));
            }
        }
        
        // Í∏∞ÌÉÄ ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî Ìï®ÏàòÎì§
        function clearTiptapEditor() {
            if (tiptapEditor) {
                tiptapEditor.commands.setContent('<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>');
                const titleInput = document.getElementById('tiptapTitle');
                const serviceSelect = document.getElementById('tiptapService');
                
                if (titleInput) titleInput.value = '';
                if (serviceSelect) serviceSelect.value = '';
                
                const logElement = document.getElementById('tiptap-api-log');
                if (logElement) {
                    logElement.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å</div>';
                }
            }
        }
        
        function clearNovelEditor() {
            if (novelEditor && novelEditor.setContent) {
                novelEditor.setContent('<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>');
            } else {
                const editorElement = document.getElementById('novel-editor');
                if (editorElement) {
                    editorElement.innerHTML = '<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>';
                }
            }
            const titleInput = document.getElementById('novelTitle');
            const serviceSelect = document.getElementById('novelService');
            
            if (titleInput) titleInput.value = '';
            if (serviceSelect) serviceSelect.value = '';
            
            const logElement = document.getElementById('novel-api-log');
            if (logElement) {
                logElement.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å</div>';
            }
        }
        
        function clearQuillEditor() {
            if (quillEditor && quillEditor.setContents) {
                quillEditor.setContents([]);
            } else {
                const editorElement = document.getElementById('quill-editor');
                if (editorElement && editorElement.tagName === 'TEXTAREA') {
                    editorElement.value = '';
                }
            }
            const titleInput = document.getElementById('quillTitle');
            const serviceSelect = document.getElementById('quillService');
            
            if (titleInput) titleInput.value = '';
            if (serviceSelect) serviceSelect.value = '';
            
            const logElement = document.getElementById('quill-api-log');
            if (logElement) {
                logElement.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å</div>';
            }
        }
        
        // Î°úÍ∑∏ ÌÅ¥Î¶¨Ïñ¥ Ìï®ÏàòÎì§
        function clearTiptapLog() {
            const logElement = document.getElementById('tiptap-api-log');
            if (logElement) {
                logElement.innerHTML = 'Tiptap ÏóêÎîîÌÑ∞ Ï§ÄÎπÑ ÏôÑÎ£å';
            }
        }
        
        function clearNovelLog() {
            const logElement = document.getElementById('novel-api-log');
            if (logElement) {
                logElement.innerHTML = 'Novel ÏóêÎîîÌÑ∞ Ï§ÄÎπÑ ÏôÑÎ£å';
            }
        }
        
        function clearQuillLog() {
            const logElement = document.getElementById('quill-api-log');
            if (logElement) {
                logElement.innerHTML = 'ReactQuill ÏóêÎîîÌÑ∞ Ï§ÄÎπÑ ÏôÑÎ£å';
            }
        }
        
        // ===================== Î¶¨Ïπò ÌÖçÏä§Ìä∏ ÏóêÎîîÌÑ∞ TDD Íµ¨ÌòÑ =====================
        
        // ÏóêÎîîÌÑ∞ ÏÉÅÌÉú Í¥ÄÎ¶¨
        let editorState = {
            editor: null,
            currentRange: null,
            history: [],
            historyIndex: -1
        };
        
        // ÌÖåÏä§Ìä∏ Í≤∞Í≥º Ï†ÄÏû•
        let testResults = [];
        
        // ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî
        function initializeEditor() {
            const editor = document.getElementById('rich-text-editor');
            if (!editor) return false;
            
            editorState.editor = editor;
            
            // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
            setupEventListeners();
            
            // Ìà¥Î∞î Î≤ÑÌäº Ïù¥Î≤§Ìä∏ Î∞îÏù∏Îî©
            bindToolbarEvents();
            
            // ÌûàÏä§ÌÜ†Î¶¨ Ï¥àÍ∏∞Ìôî
            saveState();
            
            logTest('ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
            return true;
        }
        
        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
        function setupEventListeners() {
            const editor = editorState.editor;
            
            // Ïª§ÏÑú ÏúÑÏπò Ï†ÄÏû•
            editor.addEventListener('mouseup', saveCurrentRange);
            editor.addEventListener('keyup', saveCurrentRange);
            
            // ÎÇ¥Ïö© Î≥ÄÍ≤Ω Í∞êÏßÄ
            editor.addEventListener('input', onContentChange);
            
            // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§
            editor.addEventListener('keydown', handleKeyboardShortcuts);
        }
        
        // Ìà¥Î∞î Ïù¥Î≤§Ìä∏ Î∞îÏù∏Îî©
        function bindToolbarEvents() {
            // Í∏∞Î≥∏ ÏÑúÏãù Î≤ÑÌäºÎì§
            document.getElementById('btn-bold')?.addEventListener('click', () => executeCommand('bold'));
            document.getElementById('btn-italic')?.addEventListener('click', () => executeCommand('italic'));
            document.getElementById('btn-underline')?.addEventListener('click', () => executeCommand('underline'));
            document.getElementById('btn-strike')?.addEventListener('click', () => executeCommand('strikethrough'));
            
            // Î¶¨Ïä§Ìä∏ Î≤ÑÌäºÎì§
            document.getElementById('btn-bullet')?.addEventListener('click', () => executeCommand('insertUnorderedList'));
            document.getElementById('btn-ordered')?.addEventListener('click', () => executeCommand('insertOrderedList'));
            
            // Ï†ïÎ†¨ Î≤ÑÌäºÎì§
            document.getElementById('btn-align-left')?.addEventListener('click', () => executeCommand('justifyLeft'));
            document.getElementById('btn-align-center')?.addEventListener('click', () => executeCommand('justifyCenter'));
            document.getElementById('btn-align-right')?.addEventListener('click', () => executeCommand('justifyRight'));
            
            // Ïù∏Ïö©Íµ¨ Î≤ÑÌäº
            document.getElementById('btn-quote')?.addEventListener('click', () => executeCommand('formatBlock', 'blockquote'));
            
            // Ïã§Ìñâ Ï∑®ÏÜå/Ïû¨Ïã§Ìñâ
            document.getElementById('btn-undo')?.addEventListener('click', () => executeCommand('undo'));
            document.getElementById('btn-redo')?.addEventListener('click', () => executeCommand('redo'));
            
            // Í∏ÄÏî®Ï≤¥ Î∞è ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω
            document.getElementById('fontFamily')?.addEventListener('change', (e) => {
                if (e.target.value) {
                    executeCommand('fontName', e.target.value);
                }
            });
            
            document.getElementById('fontSize')?.addEventListener('change', (e) => {
                if (e.target.value) {
                    executeCommand('fontSize', '3');
                    // CSSÎ°ú ÌÅ¨Í∏∞ Ï†ÅÏö©
                    applyFontSize(e.target.value);
                }
            });
            
            // Í∏ÄÏûê ÏÉâÏÉÅ Î≥ÄÍ≤Ω
            document.getElementById('textColor')?.addEventListener('change', (e) => {
                executeCommand('foreColor', e.target.value);
            });
            
            // Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú
            document.getElementById('btn-image')?.addEventListener('click', () => {
                document.getElementById('imageInput')?.click();
            });
            
            document.getElementById('imageInput')?.addEventListener('change', handleImageUpload);
        }
        
        // Î™ÖÎ†π Ïã§Ìñâ (TDD ÌÖåÏä§Ìä∏ Í∞ÄÎä•)
        function executeCommand(command, value = null) {
            try {
                // Ìè¨Ïª§Ïä§ Î≥µÏõê
                restoreCurrentRange();
                
                // Î™ÖÎ†π Ïã§Ìñâ
                const success = document.execCommand(command, false, value);
                
                // Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                updateToolbarState();
                
                // ÌûàÏä§ÌÜ†Î¶¨ Ï†ÄÏû•
                saveState();
                
                logTest(`Î™ÖÎ†π Ïã§Ìñâ ÏÑ±Í≥µ: ${command}${value ? ` (${value})` : ''}`);
                return success;
            } catch (error) {
                logTest(`Î™ÖÎ†π Ïã§Ìñâ Ïã§Ìå®: ${command} - ${error.message}`, 'error');
                return false;
            }
        }
        
        // Ïª§ÏÑú ÏúÑÏπò Ï†ÄÏû•/Î≥µÏõê
        function saveCurrentRange() {
            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
                editorState.currentRange = selection.getRangeAt(0);
            }
        }
        
        function restoreCurrentRange() {
            if (editorState.currentRange) {
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(editorState.currentRange);
            }
            editorState.editor?.focus();
        }
        
        // ÌûàÏä§ÌÜ†Î¶¨ Í¥ÄÎ¶¨
        function saveState() {
            const content = editorState.editor?.innerHTML;
            if (content) {
                editorState.history = editorState.history.slice(0, editorState.historyIndex + 1);
                editorState.history.push(content);
                editorState.historyIndex = editorState.history.length - 1;
            }
        }
        
        // Ìà¥Î∞î ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        function updateToolbarState() {
            // Í∏∞Î≥∏ ÏÑúÏãù Î≤ÑÌäº ÏÉÅÌÉú
            updateButtonState('btn-bold', document.queryCommandState('bold'));
            updateButtonState('btn-italic', document.queryCommandState('italic'));
            updateButtonState('btn-underline', document.queryCommandState('underline'));
            updateButtonState('btn-strike', document.queryCommandState('strikethrough'));
            
            // Î¶¨Ïä§Ìä∏ Î≤ÑÌäº ÏÉÅÌÉú
            updateButtonState('btn-bullet', document.queryCommandState('insertUnorderedList'));
            updateButtonState('btn-ordered', document.queryCommandState('insertOrderedList'));
            
            // Ï†ïÎ†¨ Î≤ÑÌäº ÏÉÅÌÉú
            updateButtonState('btn-align-left', document.queryCommandState('justifyLeft'));
            updateButtonState('btn-align-center', document.queryCommandState('justifyCenter'));
            updateButtonState('btn-align-right', document.queryCommandState('justifyRight'));
        }
        
        function updateButtonState(buttonId, isActive) {
            const button = document.getElementById(buttonId);
            if (button) {
                if (isActive) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            }
        }
        
        // Í∏ÄÏûê ÌÅ¨Í∏∞ Ï†ÅÏö©
        function applyFontSize(size) {
            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
                const range = selection.getRangeAt(0);
                if (!range.collapsed) {
                    const span = document.createElement('span');
                    span.style.fontSize = size;
                    try {
                        range.surroundContents(span);
                    } catch (e) {
                        span.appendChild(range.extractContents());
                        range.insertNode(span);
                    }
                }
            }
        }
        
        // Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú Ï≤òÎ¶¨
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = `<img src="${e.target.result}" alt="ÏóÖÎ°úÎìúÎêú Ïù¥ÎØ∏ÏßÄ" style="max-width: 100%; height: auto; margin: 10px 0;">`;
                    executeCommand('insertHTML', img);
                };
                reader.readAsDataURL(file);
            }
        }
        
        // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§ Ï≤òÎ¶¨
        function handleKeyboardShortcuts(event) {
            if (event.ctrlKey || event.metaKey) {
                switch (event.key) {
                    case 'b':
                        event.preventDefault();
                        executeCommand('bold');
                        break;
                    case 'i':
                        event.preventDefault();
                        executeCommand('italic');
                        break;
                    case 'u':
                        event.preventDefault();
                        executeCommand('underline');
                        break;
                    case 'z':
                        if (event.shiftKey) {
                            event.preventDefault();
                            executeCommand('redo');
                        } else {
                            event.preventDefault();
                            executeCommand('undo');
                        }
                        break;
                }
            }
        }
        
        // ÎÇ¥Ïö© Î≥ÄÍ≤Ω Í∞êÏßÄ
        function onContentChange() {
            updateToolbarState();
            // ÎîîÎ∞îÏö¥Ïã±Îêú ÌûàÏä§ÌÜ†Î¶¨ Ï†ÄÏû•
            clearTimeout(window.editorSaveTimeout);
            window.editorSaveTimeout = setTimeout(saveState, 500);
        }
        
        // ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî
        function clearEditor() {
            if (editorState.editor) {
                editorState.editor.innerHTML = '<p>Ïó¨Í∏∞Ïóê ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî...</p>';
                editorState.history = [];
                editorState.historyIndex = -1;
                saveState();
                
                // Ìèº ÌïÑÎìú Ï¥àÍ∏∞Ìôî
                document.getElementById('editorTitle').value = '';
                document.getElementById('editorService').value = '';
                
                logTest('ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
            }
        }
        
        // Í≤åÏãúÍ∏Ä Ï†úÏ∂ú Ï≤òÎ¶¨
        function handleEditorPostSubmit(event) {
            event.preventDefault();
            
            const title = document.getElementById('editorTitle').value;
            const service = document.getElementById('editorService').value;
            const content = editorState.editor?.innerHTML;
            
            if (!title || !service || !content) {
                showNotification('Î™®Îì† ÌïÑÎìúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
                return;
            }
            
            // Í∏∞Ï°¥ Í≤åÏãúÍ∏Ä ÏÉùÏÑ± Î°úÏßÅ ÏÇ¨Ïö©
            const postData = {
                title: title,
                content: content,
                service: service,
                metadata: {
                    type: 'Î¶¨Ïπò ÌÖçÏä§Ìä∏',
                    tags: [],
                    visibility: 'public'
                }
            };
            
            // API Ìò∏Ï∂ú (Í∏∞Ï°¥ Ìï®Ïàò Ïû¨ÏÇ¨Ïö©)
            createPost(postData).then(newPost => {
                if (newPost && (newPost.slug || newPost.id)) {
                    showNotification('Í≤åÏãúÍ∏ÄÏù¥ ÏûëÏÑ±ÎêòÏóàÏäµÎãàÎã§!', 'success');
                    clearEditor();
                    showPostDetail(newPost.slug || newPost.id);
                }
            }).catch(error => {
                showNotification('Í≤åÏãúÍ∏Ä ÏûëÏÑ±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            });
        }
        
        // ===================== TDD ÌÖåÏä§Ìä∏ ÏãúÏä§ÌÖú =====================
        
        // ÌÖåÏä§Ìä∏ Î°úÍπÖ
        function logTest(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const testResult = {
                timestamp,
                message,
                type
            };
            
            testResults.push(testResult);
            
            // ÏΩòÏÜîÏóêÎèÑ Ï∂úÎ†•
            console.log(`[${timestamp}] ${message}`);
            
            // ÌÖåÏä§Ìä∏ Ìå®ÎÑêÏù¥ ÌëúÏãúÎêòÏñ¥ ÏûàÏúºÎ©¥ ÏóÖÎç∞Ïù¥Ìä∏
            updateTestDisplay();
        }
        
        // ÌÖåÏä§Ìä∏ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateTestDisplay() {
            const testResultsElement = document.getElementById('test-results');
            if (testResultsElement) {
                const html = testResults.map(result => {
                    const color = result.type === 'error' ? '#dc2626' : 
                                 result.type === 'success' ? '#059669' : '#374151';
                    return `<div style="color: ${color}; margin: 2px 0;">[${result.timestamp}] ${result.message}</div>`;
                }).join('');
                testResultsElement.innerHTML = html;
                testResultsElement.scrollTop = testResultsElement.scrollHeight;
            }
        }
        
        // ÏóêÎîîÌÑ∞ ÌÖåÏä§Ìä∏ Ïã§Ìñâ
        function runEditorTests() {
            // ÌÖåÏä§Ìä∏ Ìå®ÎÑê ÌëúÏãú
            const testPanel = document.getElementById('test-panel');
            if (testPanel) {
                testPanel.style.display = 'block';
            }
            
            testResults = []; // ÌÖåÏä§Ìä∏ Í≤∞Í≥º Ï¥àÍ∏∞Ìôî
            logTest('=== ÏóêÎîîÌÑ∞ ÌÖåÏä§Ìä∏ ÏãúÏûë ===');
            
            // Í∏∞Î≥∏ Í∏∞Îä• ÌÖåÏä§Ìä∏
            testBasicFormatting();
            testListFormatting();
            testAlignment();
            testQuote();
            testUndoRedo();
            
            logTest('=== ÏóêÎîîÌÑ∞ ÌÖåÏä§Ìä∏ ÏôÑÎ£å ===');
        }
        
        // Í∏∞Î≥∏ ÏÑúÏãù ÌÖåÏä§Ìä∏
        function testBasicFormatting() {
            logTest('Í∏∞Î≥∏ ÏÑúÏãù ÌÖåÏä§Ìä∏ ÏãúÏûë...');
            
            // Bold ÌÖåÏä§Ìä∏
            if (testBold()) {
                logTest('‚úÖ Bold ÌÖåÏä§Ìä∏ ÌÜµÍ≥º', 'success');
            } else {
                logTest('‚ùå Bold ÌÖåÏä§Ìä∏ Ïã§Ìå®', 'error');
            }
            
            // Italic ÌÖåÏä§Ìä∏
            if (testItalic()) {
                logTest('‚úÖ Italic ÌÖåÏä§Ìä∏ ÌÜµÍ≥º', 'success');
            } else {
                logTest('‚ùå Italic ÌÖåÏä§Ìä∏ Ïã§Ìå®', 'error');
            }
            
            // Underline ÌÖåÏä§Ìä∏
            if (testUnderline()) {
                logTest('‚úÖ Underline ÌÖåÏä§Ìä∏ ÌÜµÍ≥º', 'success');
            } else {
                logTest('‚ùå Underline ÌÖåÏä§Ìä∏ Ïã§Ìå®', 'error');
            }
            
            // Strikethrough ÌÖåÏä§Ìä∏
            if (testStrikethrough()) {
                logTest('‚úÖ Strikethrough ÌÖåÏä§Ìä∏ ÌÜµÍ≥º', 'success');
            } else {
                logTest('‚ùå Strikethrough ÌÖåÏä§Ìä∏ Ïã§Ìå®', 'error');
            }
        }
        
        // Bold ÌÖåÏä§Ìä∏ Íµ¨ÌòÑ
        function testBold() {
            try {
                const editor = editorState.editor;
                editor.innerHTML = '<p>ÌÖåÏä§Ìä∏ ÌÖçÏä§Ìä∏</p>';
                
                // ÌÖçÏä§Ìä∏ ÏÑ†ÌÉù
                const range = document.createRange();
                range.selectNodeContents(editor.firstChild);
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
                
                // Bold Î™ÖÎ†π Ïã§Ìñâ
                const result = executeCommand('bold');
                
                // Í≤∞Í≥º ÌôïÏù∏
                const hasStrong = editor.innerHTML.includes('<strong>') || editor.innerHTML.includes('<b>');
                return result && hasStrong;
            } catch (error) {
                logTest(`Bold ÌÖåÏä§Ìä∏ Ïò§Î•ò: ${error.message}`, 'error');
                return false;
            }
        }
        
        // Italic ÌÖåÏä§Ìä∏ Íµ¨ÌòÑ
        function testItalic() {
            try {
                const editor = editorState.editor;
                editor.innerHTML = '<p>ÌÖåÏä§Ìä∏ ÌÖçÏä§Ìä∏</p>';
                
                const range = document.createRange();
                range.selectNodeContents(editor.firstChild);
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
                
                const result = executeCommand('italic');
                const hasItalic = editor.innerHTML.includes('<em>') || editor.innerHTML.includes('<i>');
                return result && hasItalic;
            } catch (error) {
                logTest(`Italic ÌÖåÏä§Ìä∏ Ïò§Î•ò: ${error.message}`, 'error');
                return false;
            }
        }
        
        // Underline ÌÖåÏä§Ìä∏ Íµ¨ÌòÑ
        function testUnderline() {
            try {
                const editor = editorState.editor;
                editor.innerHTML = '<p>ÌÖåÏä§Ìä∏ ÌÖçÏä§Ìä∏</p>';
                
                const range = document.createRange();
                range.selectNodeContents(editor.firstChild);
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
                
                const result = executeCommand('underline');
                const hasUnderline = editor.innerHTML.includes('<u>') || 
                                   editor.innerHTML.includes('text-decoration: underline');
                return result && hasUnderline;
            } catch (error) {
                logTest(`Underline ÌÖåÏä§Ìä∏ Ïò§Î•ò: ${error.message}`, 'error');
                return false;
            }
        }
        
        // Strikethrough ÌÖåÏä§Ìä∏ Íµ¨ÌòÑ
        function testStrikethrough() {
            try {
                const editor = editorState.editor;
                editor.innerHTML = '<p>ÌÖåÏä§Ìä∏ ÌÖçÏä§Ìä∏</p>';
                
                const range = document.createRange();
                range.selectNodeContents(editor.firstChild);
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
                
                const result = executeCommand('strikethrough');
                const hasStrike = editor.innerHTML.includes('<strike>') || 
                                 editor.innerHTML.includes('<s>') ||
                                 editor.innerHTML.includes('text-decoration: line-through');
                return result && hasStrike;
            } catch (error) {
                logTest(`Strikethrough ÌÖåÏä§Ìä∏ Ïò§Î•ò: ${error.message}`, 'error');
                return false;
            }
        }
        
        // Î¶¨Ïä§Ìä∏ ÏÑúÏãù ÌÖåÏä§Ìä∏
        function testListFormatting() {
            logTest('Î¶¨Ïä§Ìä∏ ÏÑúÏãù ÌÖåÏä§Ìä∏ ÏãúÏûë...');
            
            // Bullet list ÌÖåÏä§Ìä∏
            if (testBulletList()) {
                logTest('‚úÖ Bullet List ÌÖåÏä§Ìä∏ ÌÜµÍ≥º', 'success');
            } else {
                logTest('‚ùå Bullet List ÌÖåÏä§Ìä∏ Ïã§Ìå®', 'error');
            }
            
            // Ordered list ÌÖåÏä§Ìä∏
            if (testOrderedList()) {
                logTest('‚úÖ Ordered List ÌÖåÏä§Ìä∏ ÌÜµÍ≥º', 'success');
            } else {
                logTest('‚ùå Ordered List ÌÖåÏä§Ìä∏ Ïã§Ìå®', 'error');
            }
        }
        
        function testBulletList() {
            try {
                const editor = editorState.editor;
                editor.innerHTML = '<p>ÌÖåÏä§Ìä∏ ÌÖçÏä§Ìä∏</p>';
                
                const result = executeCommand('insertUnorderedList');
                const hasUL = editor.innerHTML.includes('<ul>');
                return result && hasUL;
            } catch (error) {
                logTest(`Bullet List ÌÖåÏä§Ìä∏ Ïò§Î•ò: ${error.message}`, 'error');
                return false;
            }
        }
        
        function testOrderedList() {
            try {
                const editor = editorState.editor;
                editor.innerHTML = '<p>ÌÖåÏä§Ìä∏ ÌÖçÏä§Ìä∏</p>';
                
                const result = executeCommand('insertOrderedList');
                const hasOL = editor.innerHTML.includes('<ol>');
                return result && hasOL;
            } catch (error) {
                logTest(`Ordered List ÌÖåÏä§Ìä∏ Ïò§Î•ò: ${error.message}`, 'error');
                return false;
            }
        }
        
        // Ï†ïÎ†¨ ÌÖåÏä§Ìä∏
        function testAlignment() {
            logTest('Ï†ïÎ†¨ ÌÖåÏä§Ìä∏ ÏãúÏûë...');
            
            if (testLeftAlign() && testCenterAlign() && testRightAlign()) {
                logTest('‚úÖ Ï†ïÎ†¨ ÌÖåÏä§Ìä∏ ÌÜµÍ≥º', 'success');
            } else {
                logTest('‚ùå Ï†ïÎ†¨ ÌÖåÏä§Ìä∏ Ïã§Ìå®', 'error');
            }
        }
        
        function testLeftAlign() {
            try {
                const editor = editorState.editor;
                editor.innerHTML = '<p>ÌÖåÏä§Ìä∏ ÌÖçÏä§Ìä∏</p>';
                return executeCommand('justifyLeft');
            } catch (error) {
                return false;
            }
        }
        
        function testCenterAlign() {
            try {
                const editor = editorState.editor;
                editor.innerHTML = '<p>ÌÖåÏä§Ìä∏ ÌÖçÏä§Ìä∏</p>';
                return executeCommand('justifyCenter');
            } catch (error) {
                return false;
            }
        }
        
        function testRightAlign() {
            try {
                const editor = editorState.editor;
                editor.innerHTML = '<p>ÌÖåÏä§Ìä∏ ÌÖçÏä§Ìä∏</p>';
                return executeCommand('justifyRight');
            } catch (error) {
                return false;
            }
        }
        
        // Ïù∏Ïö©Íµ¨ ÌÖåÏä§Ìä∏
        function testQuote() {
            logTest('Ïù∏Ïö©Íµ¨ ÌÖåÏä§Ìä∏ ÏãúÏûë...');
            
            try {
                const editor = editorState.editor;
                editor.innerHTML = '<p>ÌÖåÏä§Ìä∏ ÌÖçÏä§Ìä∏</p>';
                
                const result = executeCommand('formatBlock', 'blockquote');
                const hasBlockquote = editor.innerHTML.includes('<blockquote>');
                
                if (result && hasBlockquote) {
                    logTest('‚úÖ Ïù∏Ïö©Íµ¨ ÌÖåÏä§Ìä∏ ÌÜµÍ≥º', 'success');
                } else {
                    logTest('‚ùå Ïù∏Ïö©Íµ¨ ÌÖåÏä§Ìä∏ Ïã§Ìå®', 'error');
                }
            } catch (error) {
                logTest(`Ïù∏Ïö©Íµ¨ ÌÖåÏä§Ìä∏ Ïò§Î•ò: ${error.message}`, 'error');
            }
        }
        
        // Ïã§Ìñâ Ï∑®ÏÜå/Ïû¨Ïã§Ìñâ ÌÖåÏä§Ìä∏
        function testUndoRedo() {
            logTest('Ïã§Ìñâ Ï∑®ÏÜå/Ïû¨Ïã§Ìñâ ÌÖåÏä§Ìä∏ ÏãúÏûë...');
            
            try {
                const editor = editorState.editor;
                const originalContent = '<p>ÏõêÎ≥∏ ÌÖçÏä§Ìä∏</p>';
                editor.innerHTML = originalContent;
                saveState();
                
                // Î≥ÄÍ≤Ω ÏÇ¨Ìï≠ Ï∂îÍ∞Ä
                editor.innerHTML = '<p><strong>Î≥ÄÍ≤ΩÎêú ÌÖçÏä§Ìä∏</strong></p>';
                saveState();
                
                // Ïã§Ìñâ Ï∑®ÏÜå
                const undoResult = executeCommand('undo');
                
                // Ïû¨Ïã§Ìñâ
                const redoResult = executeCommand('redo');
                
                if (undoResult && redoResult) {
                    logTest('‚úÖ Ïã§Ìñâ Ï∑®ÏÜå/Ïû¨Ïã§Ìñâ ÌÖåÏä§Ìä∏ ÌÜµÍ≥º', 'success');
                } else {
                    logTest('‚ùå Ïã§Ìñâ Ï∑®ÏÜå/Ïû¨Ïã§Ìñâ ÌÖåÏä§Ìä∏ Ïã§Ìå®', 'error');
                }
            } catch (error) {
                logTest(`Ïã§Ìñâ Ï∑®ÏÜå/Ïû¨Ïã§Ìñâ ÌÖåÏä§Ìä∏ Ïò§Î•ò: ${error.message}`, 'error');
            }
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÏóêÎîîÌÑ∞ Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            // ÏóêÎîîÌÑ∞ ÌéòÏù¥ÏßÄÍ∞Ä ÌëúÏãúÎê† Îïå Ï¥àÍ∏∞Ìôî
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        const target = mutation.target;
                        if (target.id === 'post-editor' && target.classList.contains('active')) {
                            setTimeout(() => {
                                if (!editorState.editor) {
                                    initializeEditor();
                                }
                            }, 100);
                        }
                    }
                });
            });
            
            const editorPage = document.getElementById('post-editor');
            if (editorPage) {
                observer.observe(editorPage, { attributes: true });
            }
        });
    </script>
</body>
</html>