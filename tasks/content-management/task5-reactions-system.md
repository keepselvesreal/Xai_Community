# Task 5: ë°˜ì‘ ì‹œìŠ¤í…œ ì™„ì „ êµ¬í˜„

**Feature Group**: Content Management  
**Task List ì œëª©**: ë°˜ì‘ ì‹œìŠ¤í…œ ì™„ì „ êµ¬í˜„  
**ìµœì´ˆ ì‘ì„± ì‹œê°**: 2024-12-19 15:30:00

## ğŸ“‹ Task ê°œìš”

### ë¦¬ìŠ¤í¬ ë ˆë²¨: ë†’ìŒ
- **ì´ìœ **: ë³µì¡í•œ ìƒíƒœ ì „í™˜ ë¡œì§, ë™ì‹œì„± ì´ìŠˆ ê°€ëŠ¥ì„±, ì‹¤ì‹œê°„ í†µê³„ ì—…ë°ì´íŠ¸
- **ëŒ€ì‘**: ìƒíƒœ ë‹¤ì´ì–´ê·¸ë¨ ê¸°ë°˜ í…ŒìŠ¤íŠ¸, íŠ¸ëœì­ì…˜ ì²˜ë¦¬, ì›ìì„± ë³´ì¥

### ëŒ€ìƒ íŒŒì¼
- `backend/src/models/reaction.py`
- `backend/src/repositories/reaction_repository.py`
- `backend/src/services/reactions_service.py`
- `backend/src/routers/reactions_router.py` (posts_router.py ë‚´ í†µí•©)

## ğŸ¯ Subtasks

### 1. ì¢‹ì•„ìš”/ì‹«ì–´ìš” í† ê¸€ ë¡œì§
- **í…ŒìŠ¤íŠ¸ í•¨ìˆ˜**: `test_like_toggle_with_auth`, `test_dislike_toggle_with_auth`
- **êµ¬í˜„ ë‚´ìš©**: ë³µì¡í•œ ìƒíƒœ ì „í™˜ì„ ì²˜ë¦¬í•˜ëŠ” í† ê¸€ ì‹œìŠ¤í…œ
- **ê²€ì¦ í•­ëª©**:
  - ì¢‹ì•„ìš” ìƒíƒœ ì „í™˜: ì—†ìŒ â†’ ì¢‹ì•„ìš” â†’ ì—†ìŒ
  - ì‹«ì–´ìš” ìƒíƒœ ì „í™˜: ì—†ìŒ â†’ ì‹«ì–´ìš” â†’ ì—†ìŒ
  - ìƒí˜¸ ë°°íƒ€ì  ì²˜ë¦¬: ì¢‹ì•„ìš” â†” ì‹«ì–´ìš” ì „í™˜
  - ì‚¬ìš©ìë³„ ì¤‘ë³µ ë°˜ì‘ ë°©ì§€
  - ì‹¤ì‹œê°„ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
- **í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´**: `uv run pytest tests/unit/test_reactions_service.py::test_like_toggle_with_auth tests/unit/test_reactions_service.py::test_dislike_toggle_with_auth -v`
- **ì„±ê³µ ê¸°ì¤€**: í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´ ì‹¤í–‰ ì‹œ exit code 0 (ì–´ë–¤ ì´ìœ ë“  ì‹¤íŒ¨ ì‹œ subtask ì‹¤íŒ¨ë¡œ ê°„ì£¼)
- **ì§„í–‰ ì¡°ê±´**: ì´ subtask í…ŒìŠ¤íŠ¸ í†µê³¼ í›„ì—ë§Œ ë‹¤ìŒ subtask ì§„í–‰ ê°€ëŠ¥

### 2. ë¶ë§ˆí¬ ì‹œìŠ¤í…œ
- **í…ŒìŠ¤íŠ¸ í•¨ìˆ˜**: `test_bookmark_toggle_with_auth`
- **êµ¬í˜„ ë‚´ìš©**: ë…ë¦½ì ì¸ ë¶ë§ˆí¬ í† ê¸€ ì‹œìŠ¤í…œ
- **ê²€ì¦ í•­ëª©**:
  - ë¶ë§ˆí¬ ìƒíƒœ ì „í™˜: ì—†ìŒ â†’ ë¶ë§ˆí¬ â†’ ì—†ìŒ
  - ë‹¤ë¥¸ ë°˜ì‘ê³¼ ë…ë¦½ì  ë™ì‘ (ì¢‹ì•„ìš”/ì‹«ì–´ìš”ì™€ ë³„ê°œ)
  - ì‚¬ìš©ìë³„ ë¶ë§ˆí¬ ëª©ë¡ ê´€ë¦¬
  - ë¶ë§ˆí¬ ì¹´ìš´íŠ¸ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
- **í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´**: `uv run pytest tests/unit/test_reactions_service.py::test_bookmark_toggle_with_auth -v`
- **ì„±ê³µ ê¸°ì¤€**: í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´ ì‹¤í–‰ ì‹œ exit code 0 (ì–´ë–¤ ì´ìœ ë“  ì‹¤íŒ¨ ì‹œ subtask ì‹¤íŒ¨ë¡œ ê°„ì£¼)
- **ì§„í–‰ ì¡°ê±´**: ì´ subtask í…ŒìŠ¤íŠ¸ í†µê³¼ í›„ì—ë§Œ ë‹¤ìŒ subtask ì§„í–‰ ê°€ëŠ¥

### 3. í†µê³„ ì§‘ê³„ ë° ì—…ë°ì´íŠ¸
- **í…ŒìŠ¤íŠ¸ í•¨ìˆ˜**: `test_stats_aggregation`
- **êµ¬í˜„ ë‚´ìš©**: ì›ìì  í†µê³„ ì—…ë°ì´íŠ¸ ì‹œìŠ¤í…œ
- **ê²€ì¦ í•­ëª©**:
  - PostStats ì»¬ë ‰ì…˜ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
  - ë™ì‹œ ì ‘ê·¼ ì‹œ ë°ì´í„° ì¼ê´€ì„± ë³´ì¥
  - ì¹´ìš´íŠ¸ ì •í™•ì„± (ìŒìˆ˜ ë°©ì§€, ìµœëŒ€ê°’ ì œí•œ)
  - ë°°ì¹˜ í†µê³„ ì¬ê³„ì‚° ê¸°ëŠ¥
  - ì„±ëŠ¥ ìµœì í™” (ë¶ˆí•„ìš”í•œ DB í˜¸ì¶œ ë°©ì§€)
- **í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´**: `uv run pytest tests/unit/test_reactions_service.py::test_stats_aggregation -v`
- **ì„±ê³µ ê¸°ì¤€**: í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´ ì‹¤í–‰ ì‹œ exit code 0 (ì–´ë–¤ ì´ìœ ë“  ì‹¤íŒ¨ ì‹œ subtask ì‹¤íŒ¨ë¡œ ê°„ì£¼)
- **ì§„í–‰ ì¡°ê±´**: ì´ subtask í…ŒìŠ¤íŠ¸ í†µê³¼ í›„ì—ë§Œ ë‹¤ìŒ subtask ì§„í–‰ ê°€ëŠ¥

### 4. ë°˜ì‘ API ë¼ìš°í„°
- **í…ŒìŠ¤íŠ¸ í•¨ìˆ˜**: `test_reactions_router_with_auth`
- **êµ¬í˜„ ë‚´ìš©**: ì§ê´€ì ì¸ í† ê¸€ API ì—”ë“œí¬ì¸íŠ¸
- **ê²€ì¦ í•­ëª©**:
  - POST /posts/{slug}/like (ì¢‹ì•„ìš” í† ê¸€)
  - POST /posts/{slug}/dislike (ì‹«ì–´ìš” í† ê¸€)
  - POST /posts/{slug}/bookmark (ë¶ë§ˆí¬ í† ê¸€)
  - GET /posts/{slug}/stats (í†µê³„ ì¡°íšŒ)
  - ì¼ê´€ëœ ì‘ë‹µ í˜•ì‹ (action, counts, userReaction)
- **í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´**: `uv run pytest tests/integration/test_reactions_router.py::test_reactions_router_with_auth -v`
- **ì„±ê³µ ê¸°ì¤€**: í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´ ì‹¤í–‰ ì‹œ exit code 0 (ì–´ë–¤ ì´ìœ ë“  ì‹¤íŒ¨ ì‹œ subtask ì‹¤íŒ¨ë¡œ ê°„ì£¼)
- **ì§„í–‰ ì¡°ê±´**: ì´ subtask í…ŒìŠ¤íŠ¸ í†µê³¼ í›„ì—ë§Œ task ì™„ë£Œ ê°€ëŠ¥

## ğŸ”— ì˜ì¡´ì„±
- **ì„ í–‰ ì¡°ê±´**: 
  - Task 1 (ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë°˜)
  - Task 2 (ì¸ì¦/ê¶Œí•œ ì‹œìŠ¤í…œ)
  - Task 3 (ê²Œì‹œê¸€ ì‹œìŠ¤í…œ)
- **í›„í–‰ ì˜ì¡´ì„±**: ì—†ìŒ (ë…ë¦½ì  ê¸°ëŠ¥)

## ğŸ“Š Social Units ë° í†µí•© í¬ì¸íŠ¸

### ê²Œì‹œê¸€ ì‹œìŠ¤í…œ í†µí•©
- ê²Œì‹œê¸€ ì¡°íšŒ ì‹œ í†µê³„ ì •ë³´ í¬í•¨
- ê²Œì‹œê¸€ ìƒì„¸ í˜ì´ì§€ì—ì„œ ì‚¬ìš©ìë³„ ë°˜ì‘ ìƒíƒœ í‘œì‹œ
- ê²Œì‹œê¸€ ì‚­ì œ ì‹œ ëª¨ë“  ë°˜ì‘ ë°ì´í„° ì •ë¦¬

### ì¸ì¦ ì‹œìŠ¤í…œ í†µí•©
- ëª¨ë“  ë°˜ì‘ ê¸°ëŠ¥ì€ ë¡œê·¸ì¸ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
- ì‚¬ìš©ìë³„ ë°˜ì‘ ìƒíƒœ ê´€ë¦¬
- ì‚¬ìš©ì ì‚­ì œ ì‹œ ë°˜ì‘ ê¸°ë¡ ì •ë¦¬

## ğŸ¯ ìƒíƒœ ì „í™˜ ë‹¤ì´ì–´ê·¸ë¨

### ì¢‹ì•„ìš”/ì‹«ì–´ìš” ìƒíƒœ ì „í™˜
```
ì—†ìŒ â†â†’ ì¢‹ì•„ìš”
 â†•      â†•
ì‹«ì–´ìš” â†â†’ (ìƒí˜¸ ë°°íƒ€ì )
```

### ë¶ë§ˆí¬ ìƒíƒœ ì „í™˜
```
ì—†ìŒ â†â†’ ë¶ë§ˆí¬ (ë…ë¦½ì )
```

## ğŸ”„ API ì‘ë‹µ í˜•ì‹
```json
{
  "action": "liked", // liked, unliked, disliked, undisliked, bookmarked, unbookmarked
  "likeCount": 15,
  "dislikeCount": 2,
  "bookmarkCount": 8,
  "userReaction": {
    "liked": true,
    "disliked": false,
    "bookmarked": false
  }
}
```

## âš¡ ì„±ëŠ¥ ìµœì í™” ì „ëµ
- **ì›ìì  ì—…ë°ì´íŠ¸**: MongoDBì˜ $inc ì—°ì‚°ì í™œìš©
- **ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€**: ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ í™œìš©
- **ë°°ì¹˜ ì²˜ë¦¬**: ëŒ€ëŸ‰ í†µê³„ ì—…ë°ì´íŠ¸ ì‹œ ë°°ì¹˜ ì—°ì‚°
- **ìºì‹± ì „ëµ**: ì¸ê¸° ê²Œì‹œê¸€ í†µê³„ ìºì‹± (í–¥í›„ í™•ì¥)

## ğŸ›¡ï¸ ë™ì‹œì„± ë° ì¼ê´€ì„± ë³´ì¥
- UserReactions ì»¬ë ‰ì…˜ì˜ userId + postId ìœ ë‹ˆí¬ ì œì•½
- ë‚™ê´€ì  ì ê¸ˆì„ í†µí•œ ë™ì‹œ ìˆ˜ì • ì²˜ë¦¬
- íŠ¸ëœì­ì…˜ì„ í†µí•œ ë°˜ì‘ ìƒíƒœì™€ í†µê³„ì˜ ì›ìì  ì—…ë°ì´íŠ¸

## âœ… ì™„ë£Œ ì¡°ê±´

### ê°œë³„ Subtask ê²€ì¦ (ìˆœì°¨ ì§„í–‰ í•„ìˆ˜)
```bash
# Subtask 1: ì¢‹ì•„ìš”/ì‹«ì–´ìš” í† ê¸€ ë¡œì§
uv run pytest tests/unit/test_reactions_service.py::test_like_toggle_with_auth tests/unit/test_reactions_service.py::test_dislike_toggle_with_auth -v
# â†‘ exit code 0 í™•ì¸ í›„ ë‹¤ìŒ ì§„í–‰

# Subtask 2: ë¶ë§ˆí¬ ì‹œìŠ¤í…œ
uv run pytest tests/unit/test_reactions_service.py::test_bookmark_toggle_with_auth -v
# â†‘ exit code 0 í™•ì¸ í›„ ë‹¤ìŒ ì§„í–‰

# Subtask 3: í†µê³„ ì§‘ê³„ ë° ì—…ë°ì´íŠ¸
uv run pytest tests/unit/test_reactions_service.py::test_stats_aggregation -v
# â†‘ exit code 0 í™•ì¸ í›„ ë‹¤ìŒ ì§„í–‰

# Subtask 4: ë°˜ì‘ API ë¼ìš°í„°
uv run pytest tests/integration/test_reactions_router.py::test_reactions_router_with_auth -v
# â†‘ exit code 0 í™•ì¸ í›„ task ì™„ë£Œ
```

### Task ì „ì²´ ì„±ê³µ íŒë‹¨
```bash
# ëª¨ë“  subtask í…ŒìŠ¤íŠ¸ í•œë²ˆì— ì‹¤í–‰ (ëª¨ë“  subtask ê°œë³„ í†µê³¼ í›„)
uv run pytest tests/unit/test_reactions_service.py tests/integration/test_reactions_router.py -v

# ë˜ëŠ” reactions ê´€ë ¨ í…ŒìŠ¤íŠ¸ ì „ì²´ ì‹¤í–‰
uv run pytest tests/ -k "reactions" -v
```

**ì„±ê³µ ê¸°ì¤€**:
- [ ] ëª¨ë“  subtask í…ŒìŠ¤íŠ¸ê°€ ìˆœì°¨ì ìœ¼ë¡œ exit code 0ìœ¼ë¡œ í†µê³¼
- [ ] ì–´ë–¤ ì´ìœ ë“  í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ í•´ë‹¹ subtask ì‹¤íŒ¨ë¡œ ê°„ì£¼
- [ ] ì´ì „ subtask í†µê³¼ ì—†ì´ ë‹¤ìŒ subtask ì§„í–‰ ê¸ˆì§€
- [ ] ëª¨ë“  subtask ì™„ë£Œ í›„ì—ë§Œ ë‹¤ìŒ task ì§„í–‰ ê°€ëŠ¥
- [ ] Task 1, 2, 3 ì„ í–‰ ì™„ë£Œ í•„ìˆ˜

**ì‹¤íŒ¨ ì²˜ë¦¬**:
- ë„¤íŠ¸ì›Œí¬, í™˜ê²½ ì„¤ì •, ì™¸ë¶€ ì˜ì¡´ì„± ë“± ì–´ë–¤ ì´ìœ ë“  í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ subtask ì‹¤íŒ¨
- ì‹¤íŒ¨í•œ subtaskëŠ” ë¬¸ì œ í•´ê²° í›„ ì¬í…ŒìŠ¤íŠ¸ í•„ìš”
- ìˆœì°¨ ì§„í–‰ ì›ì¹™ ì¤€ìˆ˜ (ì´ì „ subtask ì„±ê³µ í›„ ë‹¤ìŒ ì§„í–‰)
- ìƒíƒœ ì „í™˜ ë³µì¡ì„±ê³¼ ë™ì‹œì„± ì´ìŠˆ ì£¼ì˜